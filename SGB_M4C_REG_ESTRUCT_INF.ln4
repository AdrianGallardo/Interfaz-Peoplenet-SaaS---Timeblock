''NUEVO CODIGO
'
''SGB_M4C_REG_COLA(sIDFileColabs, sIDEnvio)
''Realiza el registro del contenido del archivo de Colaboradores.
'
'sIDArchivo = SGB_ARG_ID_ARCHIVO
'sIDArchivoInf = SGB_ARG_ID_ARCHIVO_INF
'iIDEnvio = ToInt(SGB_ARG_ID_ENVIO)
'sIDEnvio = ToString(SGB_ARG_ID_ENVIO, 0)
'sIDOrganizacion = "0005"
'sIDTipoColaboradores = 1
'sIDTipoColabsInf = 4
'iGenerado = 1
'
'iEstadoEnProceso = 2
'iEdoExitoso = 3
'iEdoError = 4
'
'dFechaHoraIni = ToDayNow()
'
'SGB_M4C_ARCHIVO.AddRegister()
'SGB_M4C_ARCHIVO.ID_ARCHIVO = sIDArchivo
'SGB_M4C_ARCHIVO.ID_TIPO = sIDTipoColaboradores
'
'SetLog(M4_DEBUGINFOLOG, 60, 4, 400,"Se ha creado el registro del archivo de Colaboradores " + ToString(TodayNow(), 0))
'
''Creando el registro del Archivo Infoblock
'SGB_M4C_ARCHIVO.AddRegister()
'SGB_M4C_ARCHIVO.ID_ARCHIVO = sIDArchivoInf
'SGB_M4C_ARCHIVO.ID_TIPO = sIDTipoColabsInf
'
'SetLog(M4_DEBUGINFOLOG, 60, 4, 400,"Se ha creado el registro del archivo de Colaboradores Infoblock " + ToString(TodayNow(), 0))
'
'If SGB_M4C_ARCHIVO.Persist_tree() <> M4_ERROR Then
  ''Registrando el Archivo en el Env¿o
  'SGB_M4C_ENVIO_AR.AddRegister()
  'SGB_M4C_ENVIO_AR.ID_ENVIO = SGB_ARG_ID_ENVIO
  'SGB_M4C_ENVIO_AR.ID_ARCHIVO = sIDArchivo
'
  ''Registrando el Archivo Infoblock en el Env¿o
  'SGB_M4C_ENVIO_AR.AddRegister()
  'SGB_M4C_ENVIO_AR.ID_ENVIO = SGB_ARG_ID_ENVIO
  'SGB_M4C_ENVIO_AR.ID_ARCHIVO = sIDArchivoInf
'
  'If SGB_M4C_ENVIO_AR.Persist_tree() <> M4_ERROR Then
    ''Se deben registrar Bajas, Altas y Cambios
    'sFlagAlta = "1"
    'sFlagBaja = "2"
    'sFlagCambio = "3"
'
    ''Filtrando Nomina Gen con los movimientos no procesados por la interfaz.
    'SetLog(M4_DEBUGINFOLOG, 60, 4, 400, "Filtrando Nomina Gen con los movimientos no procesados por la interfaz " + sIDEnvio + ToString(TodayNow()))
    'SGB_M4C_MOVS_NOM_GEN.DESTROYBLOCK()
    'SGB_M4C_MOVS_NOM_GEN.SGB_PR_ID_ORG = sIDOrganizacion
    'sSql = "FROM &CMX_NOMINA_GENERAL A "
    'sSql = sSql + "WHERE (A.ID_ORGANIZATION = @SGB_PR_ID_ORG "
    'sSql = sSql + "And A.SGB_PROCESADO_SAAS = 0 "
    'sSql = sSql + "And (A.STD_ID_HR_TYPE = '01' Or A.STD_ID_HR_TYPE = '08') ) "
    'sSql = sSql + "ORDER BY A.STD_ID_HR ASC, A.CMX_ORDINAL ASC "
    'SGB_M4C_MOVS_NOM_GEN.FILTRO_SELECT = sSql
    'SGB_M4C_MOVS_NOM_GEN.Load_Blk()
'
    'iRegSGB_M4C_MOVS_NOM_GEN = SGB_M4C_MOVS_NOM_GEN.Count()
    'If iRegSGB_M4C_MOVS_NOM_GEN > 0 Then
      'For i = 0 To iRegSGB_M4C_MOVS_NOM_GEN - 1
        'SGB_M4C_MOVS_NOM_GEN.MoveTo(i)
        'sSTD_ID_HR = SGB_M4C_MOVS_NOM_GEN.STD_ID_HR
        'sTipoMov = SGB_M4C_MOVS_NOM_GEN.CMX_TP_MOVIMIENTO
'
        'If sTipoMov = "B" Then
            ''Se registran directamente todas las Bajas ya que se eliminan colaboradores
            'SGB_M4C_REG_COLA.AddRegister()
            'SGB_M4C_REG_COLA.ID_ARCHIVO = sIDArchivo
            'SGB_M4C_REG_COLA.CMX_TP_MOVIMIENTO = sFlagBaja
            'SGB_M4C_REG_COLA.CMX_DATE = SGB_M4C_MOVS_NOM_GEN.CMX_DATE
            'SGB_M4C_REG_COLA.FECHA_BAJA = SGB_M4C_MOVS_NOM_GEN.CMX_DATE
            'SGB_M4C_REG_COLA.STD_ID_HRP_END_REASON = SGB_M4C_MOVS_NOM_GEN.STD_ID_HRP_END_REASON
            'SGB_M4C_REG_COLA.SSP_ID_CAUSA_DESEM = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CAUSA_DESEM
            'SGB_M4C_REG_COLA.SSP_FEC_FIN_VACAC = SGB_M4C_MOVS_NOM_GEN.SSP_FEC_FIN_VACAC
            'SGB_M4C_REG_COLA.STD_ID_HR = sSTD_ID_HR
            'SGB_M4C_REG_COLA.SSP_PRIMER_APELLIDO = NullValue()
            'SGB_M4C_REG_COLA.STD_N_MAIDEN_NAME = NullValue()
            'SGB_M4C_REG_COLA.STD_N_FIRST_NAME = NullValue()
            'SGB_M4C_REG_COLA.CMX_ID_TP_DOC = NullValue()
            'SGB_M4C_REG_COLA.SSP_NUM_DOC = NullValue()
            'SGB_M4C_REG_COLA.SSP_ID_PAIS_EMISOR = NullValue()
            'SGB_M4C_REG_COLA.CMX_DT_BIRTH = NullValue()
            'SGB_M4C_REG_COLA.CMX_ID_NACIONALITY = NullValue()
            'SGB_M4C_REG_COLA.CMX_ID_COUNTRY = NullValue()
            'SGB_M4C_REG_COLA.CMX_ID_SUB_GEO_DIV_ADD = NullValue()
            'SGB_M4C_REG_COLA.CMX_ID_GEO_DIV_ADD = NullValue()
            'SGB_M4C_REG_COLA.STD_ID_GENDER = NullValue()
            'SGB_M4C_REG_COLA.CMX_ID_MAR_STAT = NullValue()
            'SGB_M4C_REG_COLA.CMX_PHONE = NullValue()
            'SGB_M4C_REG_COLA.TEL_MOV = NullValue()
            'SGB_M4C_REG_COLA.CMX_EMAIL = NullValue()
            'SGB_M4C_REG_COLA.STD_ID_LOCATION_TYPE = NullValue()
            'SGB_M4C_REG_COLA.CMX_ID_SIGLA_DOMIC = NullValue()
            'SGB_M4C_REG_COLA.CMX_ADDRESS_LINE_1 = NullValue()
            'SGB_M4C_REG_COLA.CMX_NUM_VIA = NullValue()
            'SGB_M4C_REG_COLA.SSP_BLOQUE = NullValue()
            'SGB_M4C_REG_COLA.SSP_ESCALERA = NullValue()
            'SGB_M4C_REG_COLA.SSP_PISO = NullValue()
            'SGB_M4C_REG_COLA.SSP_PUERTA = NullValue()
            'SGB_M4C_REG_COLA.CMX_ID_GEO_PLACE = NullValue()
            'SGB_M4C_REG_COLA.CMX_ID_SUB_GEO_DIV = NullValue()
            'SGB_M4C_REG_COLA.CMX_ID_GEO_DIV = NullValue()
            'SGB_M4C_REG_COLA.CMX_ID_COUNTRY_ADD = NullValue()
            'SGB_M4C_REG_COLA.CMX_DISTRIT_POSTAL = NullValue()
            'SGB_M4C_REG_COLA.SCO_ID_LEG_ENT = NullValue()
            'SGB_M4C_REG_COLA.SCO_ID_JOB_CODE = NullValue()
            'SGB_M4C_REG_COLA.CMX_ID_WORK_UNIT = NullValue()
            'SGB_M4C_REG_COLA.CMX_ID_WORK_LOC = NullValue()
            'SGB_M4C_REG_COLA.SSP_ID_CENT_COSTO = NullValue()
            'SGB_M4C_REG_COLA.STD_ID_HRP_START_REASON = NullValue()
            'SGB_M4C_REG_COLA.STD_ID_HR_TYPE = NullValue()
            'SGB_M4C_REG_COLA.SSP_ID_TP_GESTION = NullValue()
            'SGB_M4C_REG_COLA.SSP_FEC_FIN_PR_PRU = NullValue()
            'SGB_M4C_REG_COLA.SSP_FEC_FIN_PV_CON = NullValue()
            'SGB_M4C_REG_COLA.SCO_ID_DURATION = NullValue()
            'SGB_M4C_REG_COLA.SSP_CON_NUM_SS = NullValue()
            'SGB_M4C_REG_COLA.SSP_PROV_NUM_SS = NullValue()
            'SGB_M4C_REG_COLA.SSP_NUM_SS = NullValue()
            'SGB_M4C_REG_COLA.SSP_DIG_NUM_SS = NullValue()
            'SGB_M4C_REG_COLA.SSP_ID_CABEC_TC1 = NullValue()
            'SGB_M4C_REG_COLA.SSP_ID_GRUP_TARIFA = NullValue()
            'SGB_M4C_REG_COLA.SSP_ID_OCUPACION = NullValue()
            'SGB_M4C_REG_COLA.SSP_ID_CONV_SS = NullValue()
            'SGB_M4C_REG_COLA.SSP_NUM_PLURIEMPL = NullValue()
            'SGB_M4C_REG_COLA.SSP_ID_CONT_LEGAL = NullValue()
            'SGB_M4C_REG_COLA.CMX_ID_CONTRATO_INT = NullValue()
            'SGB_M4C_REG_COLA.SSP_FEC_FIN_CONTRA = NullValue()
            'SGB_M4C_REG_COLA.SSP_ID_REL_LAB = NullValue()
            'SGB_M4C_REG_COLA.SSP_VALOR_COEF_T_P = NullValue()
            'SGB_M4C_REG_COLA.SSP_TIPO_HORAS = NullValue()
            'SGB_M4C_REG_COLA.SSP_NUM_HORAS = NullValue()
            'SGB_M4C_REG_COLA.SSP_JP_REG_IRREG = NullValue()
            'SGB_M4C_REG_COLA.SSP_NUM_DIAS_JP = NullValue()
            'SGB_M4C_REG_COLA.SSP_PORC_GLEGAL = NullValue()
            'SGB_M4C_REG_COLA.SSP_ID_MOTIV_REDUC = NullValue()
            'SGB_M4C_REG_COLA.SSP_ID_CAUSA_SUST = NullValue()
            'SGB_M4C_REG_COLA.SSP_NSS_SUST_PROV = NullValue()
            'SGB_M4C_REG_COLA.SSP_NUSS_SUST = NullValue()
            'SGB_M4C_REG_COLA.SSP_NSS_SUST_DC = NullValue()
            'SGB_M4C_REG_COLA.SSP_PORC_MINUSVAL = NullValue()
            'SGB_M4C_REG_COLA.SSP_FEC_INI_A_CONT = NullValue()
            'SGB_M4C_REG_COLA.SSP_MUJER_24 = NullValue()
            'SGB_M4C_REG_COLA.SSP_MUJER_SUBREPR = NullValue()
            'SGB_M4C_REG_COLA.SSP_DIAS_PRUEBA = NullValue()
            'SGB_M4C_REG_COLA.SSP_CLAUSULA_ADIC = NullValue()
            'SGB_M4C_REG_COLA.SCO_ID_TYPE_ADJUST = NullValue()
            'SGB_M4C_REG_COLA.CMX_ID_CONVENIO = NullValue()
            'SGB_M4C_REG_COLA.CMX_ID_CATEGORIA = NullValue()
            'SGB_M4C_REG_COLA.SSP_BRUTO_ANUAL = NullValue()
            'SGB_M4C_REG_COLA.CMX_ID_TP_SALARIO = NullValue()
            'SGB_M4C_REG_COLA.SSP_FEC_ANTIGUEDAD = NullValue()
            'SGB_M4C_REG_COLA.SSP_FEC_EXTRAS = NullValue()
            'SGB_M4C_REG_COLA.SGB_ID_SINDICATO = NullValue()
            'SGB_M4C_REG_COLA.SSP_ID_TP_IRPF = NullValue()
            'SGB_M4C_REG_COLA.SSP_ID_EST_IRPF = NullValue()
            'SGB_M4C_REG_COLA.SSP_ID_MINUSVALIA = NullValue()
            'SGB_M4C_REG_COLA.SSP_ID_CENTRO_FIS = NullValue() 'Se habilita en TRADES
            'SGB_M4C_REG_COLA.CMX_FORMA_DE_PAGO = NullValue()
            'SGB_M4C_REG_COLA.SCO_ID_COMP_BANK = NullValue()
            'SGB_M4C_REG_COLA.COMP_BANC_SUC = NullValue()
            'SGB_M4C_REG_COLA.SCO_ACCOUNT_NUMBER = NullValue()
            'SGB_M4C_REG_COLA.SSP_DC = NullValue()
            'SGB_M4C_REG_COLA.SSP_ID_TP_PRODUCTOR = NullValue()
            'SGB_M4C_REG_COLA.SSP_ID_TP_ACTIVIDAD = NullValue()
'
            ''Registrando las Bajas para Infoblock
            'SGB_M4C_REG_COLA_INF.AddRegister()
            'SGB_M4C_REG_COLA_INF.ID_ARCHIVO = sIDArchivoInf
            'SGB_M4C_REG_COLA_INF.USUARIO = "TB"
            'SGB_M4C_REG_COLA_INF.ID = sSTD_ID_HR
            'SGB_M4C_REG_COLA_INF.ORGANIZATIONID = SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT
            'SGB_M4C_REG_COLA_INF.PARENTID = SGB_M4C_CALC_DEPTO(SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC, dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT)
            'SGB_M4C_REG_COLA_INF.NAME = SGB_M4C_MOVS_NOM_GEN.STD_N_FIRST_NAME
            'SGB_M4C_REG_COLA_INF.PATERNALSURNAME = SGB_M4C_MOVS_NOM_GEN.SSP_PRIMER_APELLIDO
            'SGB_M4C_REG_COLA_INF.MATERNALSURNAME = SGB_M4C_MOVS_NOM_GEN.STD_N_MAIDEN_NAME
            'SGB_M4C_REG_COLA_INF.BIRTHDATE = FORMAT_YYYY_MM_DD(SGB_M4C_MOVS_NOM_GEN.CMX_DT_BIRTH)
            'SGB_M4C_REG_COLA_INF.SEX = ToString((ToInt(SGB_M4C_MOVS_NOM_GEN.STD_ID_GENDER) - 1),0 ) '0 = Masculino, 1 = Femenino
            'SGB_M4C_REG_COLA_INF.NIN = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_SS
            'SGB_M4C_REG_COLA_INF.EMAIL = SGB_M4C_MOVS_NOM_GEN.CMX_EMAIL
            'SGB_M4C_REG_COLA_INF.ORGANIZATION = SGB_M4C_CALC_EMPRESA(SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT, dFechaHoraIni)
            'SGB_M4C_REG_COLA_INF.DEPARTMENT = SGB_M4C_CALC_WLOCAT(SGB_M4C_CALC_DEPTO(SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC, dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT),  dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT) 'Obtiene el nombre del WLOC pasado por par¿metro
            'SGB_M4C_REG_COLA_INF.CATEGORY = SGB_M4C_CALC_CATEG(SGB_M4C_MOVS_NOM_GEN.SSP_ID_CATEGORIA)
            'SGB_M4C_REG_COLA_INF.POSICION = SGB_M4C_CALC_POSICION(SGB_M4C_MOVS_NOM_GEN.STD_ID_HR, dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT)
            'SGB_M4C_REG_COLA_INF.COSTCENTER = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CENT_COSTO
            'SGB_M4C_REG_COLA_INF.PAYROLL = "3"
            'SGB_M4C_REG_COLA_INF.OTHER1 = SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC
            'SGB_M4C_REG_COLA_INF.OTHER2 = SGB_M4C_CALC_WLOCAT(SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC,  dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT) 'Obtiene el nombre del WLOC pasado por par¿metro
            'SGB_M4C_REG_COLA_INF.OTHER3 = SGB_M4C_CALC_TIPO_EMP("0005", SGB_M4C_MOVS_NOM_GEN.STD_ID_HR_TYPE)
            'SGB_M4C_REG_COLA_INF.ACTIVE = "0"
            'SGB_M4C_REG_COLA_INF.INTERNAL = "1"
            'SGB_M4C_REG_COLA_INF.CRC = "0"
            'SGB_M4C_REG_COLA_INF.STARTDATE = FORMAT_YYYY_MM_DD(SGB_M4C_MOVS_NOM_GEN.STD_DT_START)
            'SGB_M4C_REG_COLA_INF.DATE1 = FORMAT_YYYY_MM_DD(SGB_M4C_MOVS_NOM_GEN.SSP_FEC_ANTIGUEDAD)
            'SGB_M4C_REG_COLA_INF.DATE2 = FORMAT_YYYY_MM_DD(SGB_M4C_MOVS_NOM_GEN.CMX_DATE)
            ''SGB_M4C_REG_COLA_INF.NIF = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_DOC
'
            'If SGB_M4C_REG_COLA.Persist_tree() <> M4_ERROR Then
              ''Bajas registradas
              'SetLog(M4_DEBUGINFOLOG, 60, 4, 400, "Bajas registradas " + ToString(TodayNow()))
'
              ''Se realiza el borrado del colaborador que curso baja en la tabla de datos enviados
              'SRGB_M4C_DATOS_ENVIADOS.DESTROYBLOCK()
              'sSql = "FROM &SGB_M4C_DATOS_ENVIADOS A "
              'sSql = sSql + "WHERE A.STD_ID_HR = '" + sSTD_ID_HR + "' "
              'SRGB_M4C_DATOS_ENVIADOS.FILTRO_SELECT = sSql
              'SRGB_M4C_DATOS_ENVIADOS.Load_Blk()
'
              'iRegSRGB_M4C_DATOS_ENVIADOS = SRGB_M4C_DATOS_ENVIADOS.Count()
              'If iRegSRGB_M4C_DATOS_ENVIADOS > 0 Then
                'SRGB_M4C_DATOS_ENVIADOS.Begin()
                'SRGB_M4C_DATOS_ENVIADOS.DeleteRegister()
                'SRGB_M4C_DATOS_ENVIADOS.Persist_tree()
                ''Se realizó el borrado de los empleados que curso baja en la tabla de Datos Enviados
                'SetLog(M4_DEBUGINFOLOG,60,4,400,"Se realizó el borrado del colaborador que curso baja (" + sSTD_ID_HR + ")  en la tabla de Datos Enviados " + ToString(TodayNow(),0))
              'EndIf
'
            'EndIf
'
            'SGB_M4C_REG_COLA_INF.Persist_tree()
            ''Bajas Infoblock registradas
            'SetLog(M4_DEBUGINFOLOG, 60, 4, 400, "Bajas Infoblock registradas " + ToString(TodayNow()))
'
        'ElseIf sTipoMov = "A" Or sTipoMov = "R" Then
            ''Se registran directamente todas las Altas ya que son nuevos colaboradores
            'SGB_M4C_REG_COLA.AddRegister()
            'SGB_M4C_REG_COLA.ID_ARCHIVO = sIDArchivo
            'SGB_M4C_REG_COLA.CMX_TP_MOVIMIENTO = sFlagAlta
            'SGB_M4C_REG_COLA.CMX_DATE = SGB_M4C_MOVS_NOM_GEN.CMX_DATE
            'SGB_M4C_REG_COLA.FECHA_BAJA = NullValue()
            'SGB_M4C_REG_COLA.STD_ID_HRP_END_REASON = NullValue()
            'SGB_M4C_REG_COLA.SSP_ID_CAUSA_DESEM = NullValue()
            'SGB_M4C_REG_COLA.SSP_FEC_FIN_VACAC = NullValue()
            'SGB_M4C_REG_COLA.STD_ID_HR = sSTD_ID_HR
            'SGB_M4C_REG_COLA.SSP_PRIMER_APELLIDO = SGB_M4C_MOVS_NOM_GEN.SSP_PRIMER_APELLIDO
            'SGB_M4C_REG_COLA.STD_N_MAIDEN_NAME = SGB_M4C_MOVS_NOM_GEN.STD_N_MAIDEN_NAME
            'SGB_M4C_REG_COLA.STD_N_FIRST_NAME = SGB_M4C_MOVS_NOM_GEN.STD_N_FIRST_NAME
            'SGB_M4C_REG_COLA.CMX_ID_TP_DOC = SGB_M4C_MOVS_NOM_GEN.CMX_ID_TP_DOC
            'SGB_M4C_REG_COLA.SSP_NUM_DOC = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_DOC
            'SGB_M4C_REG_COLA.SSP_ID_PAIS_EMISOR = SGB_M4C_MOVS_NOM_GEN.SSP_ID_PAIS_EMISOR
            'SGB_M4C_REG_COLA.CMX_DT_BIRTH = SGB_M4C_MOVS_NOM_GEN.CMX_DT_BIRTH
            'SGB_M4C_REG_COLA.CMX_ID_NACIONALITY = SGB_M4C_MOVS_NOM_GEN.CMX_ID_NACIONALITY
            'SGB_M4C_REG_COLA.CMX_ID_COUNTRY = SGB_M4C_MOVS_NOM_GEN.CMX_ID_COUNTRY
            'SGB_M4C_REG_COLA.CMX_ID_SUB_GEO_DIV_ADD = SGB_M4C_MOVS_NOM_GEN.SSP_ID_SUB_GEO_DIV
            'SGB_M4C_REG_COLA.CMX_ID_GEO_DIV_ADD = NullValue()
            'SGB_M4C_REG_COLA.STD_ID_GENDER = SGB_M4C_MOVS_NOM_GEN.STD_ID_GENDER
            'SGB_M4C_REG_COLA.CMX_ID_MAR_STAT = SGB_M4C_MOVS_NOM_GEN.CMX_ID_MAR_STAT
            'SGB_M4C_REG_COLA.CMX_PHONE = SGB_M4C_MOVS_NOM_GEN.CMX_PHONE
            'SGB_M4C_REG_COLA.TEL_MOV = SGB_M4C_MOVS_NOM_GEN.CMX_PHONE
            'SGB_M4C_REG_COLA.CMX_EMAIL = SGB_M4C_MOVS_NOM_GEN.CMX_EMAIL
            'SGB_M4C_REG_COLA.STD_ID_LOCATION_TYPE = "1"
            'SGB_M4C_REG_COLA.CMX_ID_SIGLA_DOMIC = SGB_M4C_MOVS_NOM_GEN.CMX_ID_SIGLA_DOMIC
            'SGB_M4C_REG_COLA.CMX_ADDRESS_LINE_1 = SGB_M4C_MOVS_NOM_GEN.CMX_ADDRESS_LINE_1
            'SGB_M4C_REG_COLA.CMX_NUM_VIA = SGB_M4C_MOVS_NOM_GEN.CMX_NUM_VIA
            'SGB_M4C_REG_COLA.SSP_BLOQUE = SGB_M4C_MOVS_NOM_GEN.SSP_BLOQUE
            'SGB_M4C_REG_COLA.SSP_ESCALERA = SGB_M4C_MOVS_NOM_GEN.SSP_ESCALERA
            'SGB_M4C_REG_COLA.SSP_PISO = SGB_M4C_MOVS_NOM_GEN.SSP_PISO
            'SGB_M4C_REG_COLA.SSP_PUERTA = SGB_M4C_MOVS_NOM_GEN.SSP_PUERTA
            'SGB_M4C_REG_COLA.CMX_ID_GEO_PLACE = SGB_M4C_MOVS_NOM_GEN.CMX_ID_GEO_PLACE
            'SGB_M4C_REG_COLA.CMX_ID_SUB_GEO_DIV = SGB_M4C_MOVS_NOM_GEN.CMX_ID_SUB_GEO_DIV
            'SGB_M4C_REG_COLA.CMX_ID_GEO_DIV = NullValue()
            'SGB_M4C_REG_COLA.CMX_ID_COUNTRY_ADD = SGB_M4C_MOVS_NOM_GEN.CMX_ID_COUNTRY_ADD
            'SGB_M4C_REG_COLA.CMX_DISTRIT_POSTAL = SGB_M4C_MOVS_NOM_GEN.CMX_DISTRIT_POSTAL
            'SGB_M4C_REG_COLA.SCO_ID_LEG_ENT = SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT
            'SGB_M4C_REG_COLA.SCO_ID_JOB_CODE = SGB_M4C_MOVS_NOM_GEN.SCO_ID_JOB_CODE
            'SGB_M4C_REG_COLA.CMX_ID_WORK_UNIT = SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_UNIT
            ''SGB_M4C_REG_COLA.CMX_ID_WORK_LOC = SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC
            'SGB_M4C_REG_COLA.CMX_ID_WORK_LOC = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CENTRO_FISICO
            'SGB_M4C_REG_COLA.SSP_ID_CENT_COSTO = SGB_M4C_MOVS_NOM_GEN.CALC_CENT_COST()
            'SGB_M4C_REG_COLA.STD_ID_HRP_START_REASON = SGB_M4C_MOVS_NOM_GEN.STD_ID_HRP_START_REASON
            'SGB_M4C_REG_COLA.STD_ID_HR_TYPE = SGB_M4C_MOVS_NOM_GEN.STD_ID_HR_TYPE
            'SGB_M4C_REG_COLA.SSP_ID_TP_GESTION = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_GESTION
            'SGB_M4C_REG_COLA.SSP_FEC_FIN_PR_PRU = NullValue()
            ''SGB_M4C_REG_COLA.SSP_FEC_FIN_PV_CON = NullValue()
            'SGB_M4C_REG_COLA.SSP_FEC_FIN_PV_CON = SGB_M4C_MOVS_NOM_GEN.SSP_FEC_FIN_PV_CON
            'SGB_M4C_REG_COLA.SCO_ID_DURATION = NullValue()
'
            ''Comprobando si cuenta con NSS
            'SGB_M4C_REG_COLA.SSP_CON_NUM_SS = SGB_M4C_MOVS_NOM_GEN.SSP_CON_NUM_SS
            'If SGB_M4C_MOVS_NOM_GEN.SSP_CON_NUM_SS = "1" Then 'S¿ cuenta con NSS
              'SGB_M4C_REG_COLA.SSP_PROV_NUM_SS = SGB_M4C_MOVS_NOM_GEN.CALC_PROV_NUM_SS()
              'SGB_M4C_REG_COLA.SSP_NUM_SS = SGB_M4C_MOVS_NOM_GEN.CALC_NUM_SS()
              'SGB_M4C_REG_COLA.SSP_DIG_NUM_SS = SGB_M4C_MOVS_NOM_GEN.CALC_DIG_NUM_SS()
            'Else 'No tiene NSS
              'SGB_M4C_REG_COLA.SSP_CON_NUM_SS = "0"
              'SGB_M4C_REG_COLA.SSP_PROV_NUM_SS = NullValue()
              'SGB_M4C_REG_COLA.SSP_NUM_SS = NullValue()
              'SGB_M4C_REG_COLA.SSP_DIG_NUM_SS = NullValue()
            'EndIf
'
            'SGB_M4C_REG_COLA.SSP_ID_CABEC_TC1 = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CABEC_TC1
            'SGB_M4C_REG_COLA.SSP_ID_GRUP_TARIFA = SGB_M4C_MOVS_NOM_GEN.SSP_ID_GRUP_TARIFA
            'SGB_M4C_REG_COLA.SSP_ID_OCUPACION = SGB_M4C_MOVS_NOM_GEN.SSP_ID_OCUPACION
            'SGB_M4C_REG_COLA.SSP_ID_CONV_SS = NullValue()
            'SGB_M4C_REG_COLA.SSP_NUM_PLURIEMPL = NullValue()
            'SGB_M4C_REG_COLA.SSP_ID_CONT_LEGAL = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CONT_LEGAL
            'SGB_M4C_REG_COLA.CMX_ID_CONTRATO_INT = SGB_M4C_MOVS_NOM_GEN.CMX_ID_CONTRATO_INT
            ''SGB_M4C_REG_COLA.SSP_FEC_FIN_CONTRA = NullValue()
            'SGB_M4C_REG_COLA.SSP_FEC_FIN_CONTRA = SGB_M4C_MOVS_NOM_GEN.SSP_FEC_FIN_CONTRA
            'SGB_M4C_REG_COLA.SSP_ID_REL_LAB = NullValue()
            ''Modificado por solicitud de Jordi Horta el 22 Enero 2019.
            ''SGB_M4C_REG_COLA.SSP_VALOR_COEF_T_P = NullValue()
            ''SGB_M4C_REG_COLA.SSP_TIPO_HORAS = NullValue()
            ''SGB_M4C_REG_COLA.SSP_NUM_HORAS = NullValue()
            ''SGB_M4C_REG_COLA.SSP_JP_REG_IRREG = NullValue()
            ''SGB_M4C_REG_COLA.SSP_NUM_DIAS_JP = NullValue()
            'SGB_M4C_REG_COLA.SSP_VALOR_COEF_T_P = SGB_M4C_MOVS_NOM_GEN.SSP_VALOR_COEF_T_P
            'SGB_M4C_REG_COLA.SSP_TIPO_HORAS = SGB_M4C_MOVS_NOM_GEN.SSP_TIPO_HORAS
            'SGB_M4C_REG_COLA.SSP_NUM_HORAS = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_HORAS
            'SGB_M4C_REG_COLA.SSP_JP_REG_IRREG = SGB_M4C_MOVS_NOM_GEN.SSP_JP_REG_IRREG
            'SGB_M4C_REG_COLA.SSP_NUM_DIAS_JP = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_DIAS_JP
            ''Fin 22 Enero 2019.
            'SGB_M4C_REG_COLA.SSP_PORC_GLEGAL = NullValue()
            'SGB_M4C_REG_COLA.SSP_ID_MOTIV_REDUC = NullValue()
            ''Se colaca un valor a solicitud de Jordi Horta el 21 Ene 2019.
            ''SGB_M4C_REG_COLA.SSP_ID_CAUSA_SUST = NullValue()
            ''SGB_M4C_REG_COLA.SSP_NSS_SUST_PROV = NullValue()
            ''SGB_M4C_REG_COLA.SSP_NUSS_SUST = NullValue()
            ''SGB_M4C_REG_COLA.SSP_NSS_SUST_DC = NullValue()
            'SGB_M4C_REG_COLA.SSP_ID_CAUSA_SUST = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CAUSA_SUST
            'SGB_M4C_REG_COLA.SSP_NSS_SUST_PROV = (Mid(SGB_M4C_MOVS_NOM_GEN.SSP_NUSS_SUST, 0, 2))'2
            'SGB_M4C_REG_COLA.SSP_NUSS_SUST = (Mid(SGB_M4C_MOVS_NOM_GEN.SSP_NUSS_SUST, 2, 8)) '8
            'SGB_M4C_REG_COLA.SSP_NSS_SUST_DC = (Mid(SGB_M4C_MOVS_NOM_GEN.SSP_NUSS_SUST, 10, 2)) '2
            ''Fin 21 Jan 2019.
            'SGB_M4C_REG_COLA.SSP_PORC_MINUSVAL = NullValue()
            'SGB_M4C_REG_COLA.SSP_FEC_INI_A_CONT = NullValue()
            'SGB_M4C_REG_COLA.SSP_MUJER_24 = NullValue()
            'SGB_M4C_REG_COLA.SSP_MUJER_SUBREPR = NullValue()
            'SGB_M4C_REG_COLA.SSP_DIAS_PRUEBA = NullValue()
            ''SGB_M4C_REG_COLA.SSP_CLAUSULA_ADIC = SGB_M4C_MOVS_NOM_GEN.SSP_CLAUSULA_ADIC
            'SGB_M4C_REG_COLA.SSP_CLAUSULA_ADIC = "SC" 'Se utiliza SC de forma directa de acuerdo a los comentarios de Alvaro Meta4
            'SGB_M4C_REG_COLA.SCO_ID_TYPE_ADJUST = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TYPE_ADJUST
            'SGB_M4C_REG_COLA.CMX_ID_CONVENIO = SGB_M4C_MOVS_NOM_GEN.CMX_ID_CONVENIO
           ''' SGB_M4C_REG_COLA.CMX_ID_CATEGORIA = SGB_M4C_MOVS_NOM_GEN.CMX_ID_CATEGORIA
            'SGB_M4C_REG_COLA.CMX_ID_CATEGORIA = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CATEGORIA
            'If ToString(SGB_M4C_MOVS_NOM_GEN.SSP_BRUTO_ANUAL,0) = "1" Then
                'SGB_M4C_REG_COLA.SSP_BRUTO_ANUAL = 0
            'Else
                'SGB_M4C_REG_COLA.SSP_BRUTO_ANUAL = SGB_M4C_MOVS_NOM_GEN.SSP_BRUTO_ANUAL
            'EndIf
            'SGB_M4C_REG_COLA.CMX_ID_TP_SALARIO = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_SALARIO
            'SGB_M4C_REG_COLA.SSP_FEC_ANTIGUEDAD = SGB_M4C_MOVS_NOM_GEN.SSP_FEC_ANTIGUEDAD
            'SGB_M4C_REG_COLA.SSP_FEC_EXTRAS = NullValue()
            'SGB_M4C_REG_COLA.SGB_ID_SINDICATO = SGB_M4C_MOVS_NOM_GEN.SGB_ID_SINDICATO
            'SGB_M4C_REG_COLA.SSP_ID_TP_IRPF = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_IRPF
            'SGB_M4C_REG_COLA.SSP_ID_EST_IRPF = SGB_M4C_MOVS_NOM_GEN.SSP_ID_EST_IRPF
            'SGB_M4C_REG_COLA.SSP_ID_MINUSVALIA = SGB_M4C_MOVS_NOM_GEN.SSP_ID_MINUSVALIA
            'SGB_M4C_REG_COLA.SSP_ID_CENTRO_FIS = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CENTRO_FISICO
            'SGB_M4C_REG_COLA.CMX_FORMA_DE_PAGO = SGB_M4C_MOVS_NOM_GEN.SSP_ID_PAYM_TYPE 'REVISAR SSP_ID_PAYM_DATA'
            'SGB_M4C_REG_COLA.SCO_ID_COMP_BANK = SGB_M4C_MOVS_NOM_GEN.SCO_ID_COMP_BANK
            'SGB_M4C_REG_COLA.COMP_BANC_SUC = SGB_M4C_MOVS_NOM_GEN.CALC_COMP_BANC_SUC()
            'SGB_M4C_REG_COLA.SCO_ACCOUNT_NUMBER = SGB_M4C_MOVS_NOM_GEN.SCO_ACCOUNT_NUMBER
            'SGB_M4C_REG_COLA.SSP_DC = SGB_M4C_MOVS_NOM_GEN.SSP_DC
            'SGB_M4C_REG_COLA.SSP_ID_TP_PRODUCTOR = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_PRODUCTOR
            'SGB_M4C_REG_COLA.SSP_ID_TP_ACTIVIDAD = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_ACTIVIDAD
'
            ''Registrando las Altas para Infoblock
            'SGB_M4C_REG_COLA_INF.AddRegister()
            'SGB_M4C_REG_COLA_INF.ID_ARCHIVO = sIDArchivoInf
            'SGB_M4C_REG_COLA_INF.USUARIO = "TB"
            'SGB_M4C_REG_COLA_INF.ID = SGB_M4C_MOVS_NOM_GEN.STD_ID_HR
            'SGB_M4C_REG_COLA_INF.ORGANIZATIONID = SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT
            'SGB_M4C_REG_COLA_INF.PARENTID = SGB_M4C_CALC_DEPTO(SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC, dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT)
            'SGB_M4C_REG_COLA_INF.NAME = SGB_M4C_MOVS_NOM_GEN.STD_N_FIRST_NAME
            'SGB_M4C_REG_COLA_INF.PATERNALSURNAME = SGB_M4C_MOVS_NOM_GEN.SSP_PRIMER_APELLIDO
            'SGB_M4C_REG_COLA_INF.MATERNALSURNAME = SGB_M4C_MOVS_NOM_GEN.STD_N_MAIDEN_NAME
            'SGB_M4C_REG_COLA_INF.BIRTHDATE = FORMAT_YYYY_MM_DD(SGB_M4C_MOVS_NOM_GEN.CMX_DT_BIRTH)
            'SGB_M4C_REG_COLA_INF.SEX = ToString((ToInt(SGB_M4C_MOVS_NOM_GEN.STD_ID_GENDER) - 1),0 ) '0 = Masculino, 1 = Femenino
            'SGB_M4C_REG_COLA_INF.NIN = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_SS
            'SGB_M4C_REG_COLA_INF.EMAIL = SGB_M4C_MOVS_NOM_GEN.CMX_EMAIL
            'SGB_M4C_REG_COLA_INF.ORGANIZATION = SGB_M4C_CALC_EMPRESA(SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT, dFechaHoraIni)
            'SGB_M4C_REG_COLA_INF.DEPARTMENT = SGB_M4C_CALC_WLOCAT(SGB_M4C_CALC_DEPTO(SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC, dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT),  dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT) 'Obtiene el nombre del WLOC pasado por par¿metro
            'SGB_M4C_REG_COLA_INF.CATEGORY = SGB_M4C_CALC_CATEG(SGB_M4C_MOVS_NOM_GEN.SSP_ID_CATEGORIA)
            'SGB_M4C_REG_COLA_INF.POSICION = SGB_M4C_CALC_POSICION(SGB_M4C_MOVS_NOM_GEN.STD_ID_HR, dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT)
            'SGB_M4C_REG_COLA_INF.COSTCENTER = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CENT_COSTO
            'SGB_M4C_REG_COLA_INF.PAYROLL = "3"
            'SGB_M4C_REG_COLA_INF.OTHER1 = SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC
            'SGB_M4C_REG_COLA_INF.OTHER2 = SGB_M4C_CALC_WLOCAT(SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC,  dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT) 'Obtiene el nombre del WLOC pasado por par¿metro
            'SGB_M4C_REG_COLA_INF.OTHER3 = SGB_M4C_CALC_TIPO_EMP("0005", SGB_M4C_MOVS_NOM_GEN.STD_ID_HR_TYPE)
            'SGB_M4C_REG_COLA_INF.ACTIVE = "1"
            'SGB_M4C_REG_COLA_INF.INTERNAL = "1"
            'SGB_M4C_REG_COLA_INF.CRC = "0"
            'SGB_M4C_REG_COLA_INF.STARTDATE = FORMAT_YYYY_MM_DD(SGB_M4C_MOVS_NOM_GEN.CMX_DATE)
            'SGB_M4C_REG_COLA_INF.DATE1 = FORMAT_YYYY_MM_DD(SGB_M4C_MOVS_NOM_GEN.SSP_FEC_ANTIGUEDAD)
            'SGB_M4C_REG_COLA_INF.DATE2 = NullValue()
            ''SGB_M4C_REG_COLA_INF.NIF = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_DOC
'
'
            'If SGB_M4C_REG_COLA.Persist_tree() <> M4_ERROR Then
              ''Altas registradas
              'SetLog(M4_DEBUGINFOLOG, 60, 4, 400, "Altas registradas " + ToString(TodayNow()))
'
              ''Registrando las Altas que se enviaron en el Archivo
              'sIDArchivo = SGB_M4C_REG_COLA.ID_ARCHIVO
              'sCMX_TP_MOVIMIENTO = "A" 'Se escribe una A en el tipo de movimiento para que permita realizar el registro.
              'sCMX_DATE = SGB_M4C_REG_COLA.CMX_DATE
              'sFECHA_BAJA = SGB_M4C_REG_COLA.FECHA_BAJA
              'sSTD_ID_HRP_END_REASON = SGB_M4C_REG_COLA.STD_ID_HRP_END_REASON
              'sSSP_ID_CAUSA_DESEM = SGB_M4C_REG_COLA.SSP_ID_CAUSA_DESEM
              'sSSP_FEC_FIN_VACAC = SGB_M4C_REG_COLA.SSP_FEC_FIN_VACAC
              'sSTD_ID_HR = SGB_M4C_REG_COLA.STD_ID_HR
              'sSSP_PRIMER_APELLIDO = SGB_M4C_REG_COLA.SSP_PRIMER_APELLIDO
              'sSTD_N_MAIDEN_NAME = SGB_M4C_REG_COLA.STD_N_MAIDEN_NAME
              'sSTD_N_FIRST_NAME = SGB_M4C_REG_COLA.STD_N_FIRST_NAME
              'sCMX_ID_TP_DOC = SGB_M4C_REG_COLA.CMX_ID_TP_DOC
              'sSSP_NUM_DOC = SGB_M4C_REG_COLA.SSP_NUM_DOC
              'sSSP_ID_PAIS_EMISOR = SGB_M4C_REG_COLA.SSP_ID_PAIS_EMISOR
              'sCMX_DT_BIRTH = SGB_M4C_REG_COLA.CMX_DT_BIRTH
              'sCMX_ID_NACIONALITY = SGB_M4C_REG_COLA.CMX_ID_NACIONALITY
              'sCMX_ID_COUNTRY = SGB_M4C_REG_COLA.CMX_ID_COUNTRY
              'sCMX_ID_SUB_GEO_DIV_ADD = SGB_M4C_REG_COLA.CMX_ID_SUB_GEO_DIV_ADD
              'sCMX_ID_GEO_DIV_ADD = SGB_M4C_REG_COLA.CMX_ID_GEO_DIV_ADD
              'sSTD_ID_GENDER = SGB_M4C_REG_COLA.STD_ID_GENDER
              'sCMX_ID_MAR_STAT = SGB_M4C_REG_COLA.CMX_ID_MAR_STAT
              'sCMX_PHONE = SGB_M4C_REG_COLA.CMX_PHONE
              'sTEL_MOV = SGB_M4C_REG_COLA.TEL_MOV
              'sCMX_EMAIL = SGB_M4C_REG_COLA.CMX_EMAIL
              'sSTD_ID_LOCATION_TYPE = SGB_M4C_REG_COLA.STD_ID_LOCATION_TYPE
              'sCMX_ID_SIGLA_DOMIC = SGB_M4C_REG_COLA.CMX_ID_SIGLA_DOMIC
              'sCMX_ADDRESS_LINE_1 = SGB_M4C_REG_COLA.CMX_ADDRESS_LINE_1
              'sCMX_NUM_VIA = SGB_M4C_REG_COLA.CMX_NUM_VIA
              'sSSP_BLOQUE = SGB_M4C_REG_COLA.SSP_BLOQUE
              'sSSP_ESCALERA = SGB_M4C_REG_COLA.SSP_ESCALERA
              'sSSP_PISO = SGB_M4C_REG_COLA.SSP_PISO
              'sSSP_PUERTA = SGB_M4C_REG_COLA.SSP_PUERTA
              'sCMX_ID_GEO_PLACE = SGB_M4C_REG_COLA.CMX_ID_GEO_PLACE
              'sCMX_ID_SUB_GEO_DIV = SGB_M4C_REG_COLA.CMX_ID_SUB_GEO_DIV
              'sCMX_ID_GEO_DIV = SGB_M4C_REG_COLA.CMX_ID_GEO_DIV
              'sCMX_ID_COUNTRY_ADD = SGB_M4C_REG_COLA.CMX_ID_COUNTRY_ADD
              'sCMX_DISTRIT_POSTAL = SGB_M4C_REG_COLA.CMX_DISTRIT_POSTAL
              'sSCO_ID_LEG_ENT = SGB_M4C_REG_COLA.SCO_ID_LEG_ENT
              'sSCO_ID_JOB_CODE = SGB_M4C_REG_COLA.SCO_ID_JOB_CODE
              'sCMX_ID_WORK_UNIT = SGB_M4C_REG_COLA.CMX_ID_WORK_UNIT
              'sCMX_ID_WORK_LOC = SGB_M4C_REG_COLA.CMX_ID_WORK_LOC
              'sSSP_ID_CENT_COSTO = SGB_M4C_REG_COLA.SSP_ID_CENT_COSTO
              'sSTD_ID_HRP_START_REASON = SGB_M4C_REG_COLA.STD_ID_HRP_START_REASON
              'sSTD_ID_HR_TYPE = SGB_M4C_REG_COLA.STD_ID_HR_TYPE
              'sSSP_ID_TP_GESTION = SGB_M4C_REG_COLA.SSP_ID_TP_GESTION
              'sSSP_FEC_FIN_PR_PRU = SGB_M4C_REG_COLA.SSP_FEC_FIN_PR_PRU
              'sSSP_FEC_FIN_PV_CON = SGB_M4C_REG_COLA.SSP_FEC_FIN_PV_CON
              'sSCO_ID_DURATION = SGB_M4C_REG_COLA.SCO_ID_DURATION
              'sSSP_CON_NUM_SS = SGB_M4C_REG_COLA.SSP_CON_NUM_SS
              'sSSP_PROV_NUM_SS = SGB_M4C_REG_COLA.SSP_PROV_NUM_SS
              'sSSP_NUM_SS = SGB_M4C_REG_COLA.SSP_NUM_SS
              'sSSP_DIG_NUM_SS = SGB_M4C_REG_COLA.SSP_DIG_NUM_SS
              'sSSP_ID_CABEC_TC1 = SGB_M4C_REG_COLA.SSP_ID_CABEC_TC1
              'sSSP_ID_GRUP_TARIFA = SGB_M4C_REG_COLA.SSP_ID_GRUP_TARIFA
              'sSSP_ID_OCUPACION = SGB_M4C_REG_COLA.SSP_ID_OCUPACION
              'sSSP_ID_CONV_SS = SGB_M4C_REG_COLA.SSP_ID_CONV_SS
              'sSSP_NUM_PLURIEMPL = SGB_M4C_REG_COLA.SSP_NUM_PLURIEMPL
              'sSSP_ID_CONT_LEGAL = SGB_M4C_REG_COLA.SSP_ID_CONT_LEGAL
              'sCMX_ID_CONTRATO_INT = SGB_M4C_REG_COLA.CMX_ID_CONTRATO_INT
              'sSSP_FEC_FIN_CONTRA = SGB_M4C_REG_COLA.SSP_FEC_FIN_CONTRA
              'sSSP_ID_REL_LAB = SGB_M4C_REG_COLA.SSP_ID_REL_LAB
              'sSSP_VALOR_COEF_T_P = SGB_M4C_REG_COLA.SSP_VALOR_COEF_T_P
              'sSSP_TIPO_HORAS = SGB_M4C_REG_COLA.SSP_TIPO_HORAS
              'sSSP_NUM_HORAS = SGB_M4C_REG_COLA.SSP_NUM_HORAS
              'sSSP_JP_REG_IRREG = SGB_M4C_REG_COLA.SSP_JP_REG_IRREG
              'sSSP_NUM_DIAS_JP = SGB_M4C_REG_COLA.SSP_NUM_DIAS_JP
              'sSSP_PORC_GLEGAL = SGB_M4C_REG_COLA.SSP_PORC_GLEGAL
              'sSSP_ID_MOTIV_REDUC = SGB_M4C_REG_COLA.SSP_ID_MOTIV_REDUC
              'sSSP_ID_CAUSA_SUST = SGB_M4C_REG_COLA.SSP_ID_CAUSA_SUST
              'sSSP_NSS_SUST_PROV = SGB_M4C_REG_COLA.SSP_NSS_SUST_PROV
              'sSSP_NUSS_SUST = SGB_M4C_REG_COLA.SSP_NUSS_SUST
              'sSSP_NSS_SUST_DC = SGB_M4C_REG_COLA.SSP_NSS_SUST_DC
              'sSSP_PORC_MINUSVAL = SGB_M4C_REG_COLA.SSP_PORC_MINUSVAL
              'sSSP_FEC_INI_A_CONT = SGB_M4C_REG_COLA.SSP_FEC_INI_A_CONT
              'sSSP_MUJER_24 = SGB_M4C_REG_COLA.SSP_MUJER_24
              'sSSP_MUJER_SUBREPR = SGB_M4C_REG_COLA.SSP_MUJER_SUBREPR
              'sSSP_DIAS_PRUEBA = SGB_M4C_REG_COLA.SSP_DIAS_PRUEBA
              'sSSP_CLAUSULA_ADIC = SGB_M4C_REG_COLA.SSP_CLAUSULA_ADIC
              'sSCO_ID_TYPE_ADJUST = SGB_M4C_REG_COLA.SCO_ID_TYPE_ADJUST
              'sCMX_ID_CONVENIO = SGB_M4C_REG_COLA.CMX_ID_CONVENIO
              'sCMX_ID_CATEGORIA = SGB_M4C_REG_COLA.CMX_ID_CATEGORIA
              'sSSP_BRUTO_ANUAL = SGB_M4C_REG_COLA.SSP_BRUTO_ANUAL
              'sCMX_ID_TP_SALARIO = SGB_M4C_REG_COLA.CMX_ID_TP_SALARIO
              'sSSP_FEC_ANTIGUEDAD = SGB_M4C_REG_COLA.SSP_FEC_ANTIGUEDAD
              'sSSP_FEC_EXTRAS = SGB_M4C_REG_COLA.SSP_FEC_EXTRAS
              'sSGB_ID_SINDICATO = SGB_M4C_REG_COLA.SGB_ID_SINDICATO
              'sSSP_ID_TP_IRPF = SGB_M4C_REG_COLA.SSP_ID_TP_IRPF
              'sSSP_ID_EST_IRPF = SGB_M4C_REG_COLA.SSP_ID_EST_IRPF
              'sSSP_ID_MINUSVALIA = SGB_M4C_REG_COLA.SSP_ID_MINUSVALIA
              'sSSP_ID_CENTRO_FIS = SGB_M4C_REG_COLA.SSP_ID_CENTRO_FIS
              'sCMX_FORMA_DE_PAGO = SGB_M4C_REG_COLA.CMX_FORMA_DE_PAGO
              'sSCO_ID_COMP_BANK = SGB_M4C_REG_COLA.SCO_ID_COMP_BANK
              'sCOMP_BANC_SUC = SGB_M4C_REG_COLA.COMP_BANC_SUC
              'sSCO_ACCOUNT_NUMBER = SGB_M4C_REG_COLA.SCO_ACCOUNT_NUMBER
              'sSSP_DC = SGB_M4C_REG_COLA.SSP_DC
              'sSSP_ID_TP_PRODUCTOR = SGB_M4C_REG_COLA.SSP_ID_TP_PRODUCTOR
              'sSSP_ID_TP_ACTIVIDAD = SGB_M4C_REG_COLA.SSP_ID_TP_ACTIVIDAD
'
              'SRGB_M4C_DATOS_ENVIADOS.AddRegister()
              'SRGB_M4C_DATOS_ENVIADOS.ID_ORGANIZATION = "0005"
              'SRGB_M4C_DATOS_ENVIADOS.CMX_TP_MOVIMIENTO = sCMX_TP_MOVIMIENTO
              'SRGB_M4C_DATOS_ENVIADOS.CMX_DATE = sCMX_DATE
              ''FECHA_BAJA = sFECHA_BAJA
              'SRGB_M4C_DATOS_ENVIADOS.STD_ID_HRP_END_REASON = sSTD_ID_HRP_END_REASON
              'SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CAUSA_DESEM = sSSP_ID_CAUSA_DESEM
              'SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_VACAC = sSSP_FEC_FIN_VACAC
              'SRGB_M4C_DATOS_ENVIADOS.STD_ID_HR = sSTD_ID_HR 'Llave primaria
              'SRGB_M4C_DATOS_ENVIADOS.SSP_PRIMER_APELLIDO = sSSP_PRIMER_APELLIDO
              'SRGB_M4C_DATOS_ENVIADOS.STD_N_MAIDEN_NAME = sSTD_N_MAIDEN_NAME
              'SRGB_M4C_DATOS_ENVIADOS.STD_N_FIRST_NAME = sSTD_N_FIRST_NAME
              'SRGB_M4C_DATOS_ENVIADOS.CMX_ID_TP_DOC = sCMX_ID_TP_DOC
              'SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_DOC = sSSP_NUM_DOC
              'SRGB_M4C_DATOS_ENVIADOS.SSP_ID_PAIS_EMISOR = sSSP_ID_PAIS_EMISOR
              'SRGB_M4C_DATOS_ENVIADOS.CMX_DT_BIRTH = sCMX_DT_BIRTH
              'SRGB_M4C_DATOS_ENVIADOS.CMX_ID_NACIONALITY = sCMX_ID_NACIONALITY
              'SRGB_M4C_DATOS_ENVIADOS.CMX_ID_COUNTRY = sCMX_ID_COUNTRY
              'SRGB_M4C_DATOS_ENVIADOS.CMX_ID_SUB_GEO_DIV_ADD = sCMX_ID_SUB_GEO_DIV_ADD
              'SRGB_M4C_DATOS_ENVIADOS.CMX_ID_GEO_DIV_ADD = sCMX_ID_GEO_DIV_ADD
              'SRGB_M4C_DATOS_ENVIADOS.STD_ID_GENDER = sSTD_ID_GENDER
              'SRGB_M4C_DATOS_ENVIADOS.CMX_ID_MAR_STAT = sCMX_ID_MAR_STAT
              'SRGB_M4C_DATOS_ENVIADOS.CMX_PHONE = sCMX_PHONE
              ''TEL_MOV = sTEL_MOV
              'SRGB_M4C_DATOS_ENVIADOS.CMX_EMAIL = sCMX_EMAIL
              'SRGB_M4C_DATOS_ENVIADOS.STD_ID_LOCATION_TYPE = sSTD_ID_LOCATION_TYPE
              'SRGB_M4C_DATOS_ENVIADOS.CMX_ID_SIGLA_DOMIC = sCMX_ID_SIGLA_DOMIC
              'SRGB_M4C_DATOS_ENVIADOS.CMX_ADDRESS_LINE_1 = sCMX_ADDRESS_LINE_1
              'SRGB_M4C_DATOS_ENVIADOS.CMX_NUM_VIA = sCMX_NUM_VIA
              'SRGB_M4C_DATOS_ENVIADOS.SSP_BLOQUE = sSSP_BLOQUE
              'SRGB_M4C_DATOS_ENVIADOS.SSP_ESCALERA = sSSP_ESCALERA
              'SRGB_M4C_DATOS_ENVIADOS.SSP_PISO = sSSP_PISO
              'SRGB_M4C_DATOS_ENVIADOS.SSP_PUERTA = sSSP_PUERTA
              'SRGB_M4C_DATOS_ENVIADOS.CMX_ID_GEO_PLACE = sCMX_ID_GEO_PLACE
              'SRGB_M4C_DATOS_ENVIADOS.CMX_ID_SUB_GEO_DIV = sCMX_ID_SUB_GEO_DIV
              'SRGB_M4C_DATOS_ENVIADOS.CMX_ID_GEO_DIV = sCMX_ID_GEO_DIV
              'SRGB_M4C_DATOS_ENVIADOS.CMX_ID_COUNTRY_ADD = sCMX_ID_COUNTRY_ADD
              'SRGB_M4C_DATOS_ENVIADOS.CMX_DISTRIT_POSTAL = sCMX_DISTRIT_POSTAL
              'SRGB_M4C_DATOS_ENVIADOS.SCO_ID_LEG_ENT = sSCO_ID_LEG_ENT
              'SRGB_M4C_DATOS_ENVIADOS.SCO_ID_JOB_CODE = sSCO_ID_JOB_CODE
              'SRGB_M4C_DATOS_ENVIADOS.CMX_ID_WORK_UNIT = sCMX_ID_WORK_UNIT
              'SRGB_M4C_DATOS_ENVIADOS.CMX_ID_WORK_LOC = sCMX_ID_WORK_LOC
              'SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CENT_COSTO = sSSP_ID_CENT_COSTO
              'SRGB_M4C_DATOS_ENVIADOS.STD_ID_HRP_START_REASON = sSTD_ID_HRP_START_REASON
              'SRGB_M4C_DATOS_ENVIADOS.STD_ID_HR_TYPE = sSTD_ID_HR_TYPE
              'SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_GESTION = sSSP_ID_TP_GESTION
              'SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_PR_PRU = sSSP_FEC_FIN_PR_PRU
              'SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_PV_CON = sSSP_FEC_FIN_PV_CON
              'SRGB_M4C_DATOS_ENVIADOS.SCO_ID_DURATION = sSCO_ID_DURATION
              'SRGB_M4C_DATOS_ENVIADOS.SSP_CON_NUM_SS = sSSP_CON_NUM_SS
              'SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_SS = sSSP_PROV_NUM_SS + "-" + sSSP_NUM_SS + "-" + sSSP_DIG_NUM_SS
              'SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CABEC_TC1 = sSSP_ID_CABEC_TC1
              'SRGB_M4C_DATOS_ENVIADOS.SSP_ID_GRUP_TARIFA = sSSP_ID_GRUP_TARIFA
              'SRGB_M4C_DATOS_ENVIADOS.SSP_ID_OCUPACION = sSSP_ID_OCUPACION
              'SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CONV_SS = sSSP_ID_CONV_SS
              'SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_PLURIEMPL = sSSP_NUM_PLURIEMPL
              'SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CONT_LEGAL = sSSP_ID_CONT_LEGAL
              'SRGB_M4C_DATOS_ENVIADOS.CMX_ID_CONTRATO_INT = sCMX_ID_CONTRATO_INT
              'SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_CONTRA = sSSP_FEC_FIN_CONTRA
              'SRGB_M4C_DATOS_ENVIADOS.SSP_ID_REL_LAB = sSSP_ID_REL_LAB
              'SRGB_M4C_DATOS_ENVIADOS.SSP_VALOR_COEF_T_P = sSSP_VALOR_COEF_T_P
              'SRGB_M4C_DATOS_ENVIADOS.SSP_TIPO_HORAS = sSSP_TIPO_HORAS
              'SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_HORAS = sSSP_NUM_HORAS
              'SRGB_M4C_DATOS_ENVIADOS.SSP_JP_REG_IRREG = sSSP_JP_REG_IRREG
              'SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_DIAS_JP = sSSP_NUM_DIAS_JP
              'SRGB_M4C_DATOS_ENVIADOS.SSP_PORC_GLEGAL = sSSP_PORC_GLEGAL
              'SRGB_M4C_DATOS_ENVIADOS.SSP_ID_MOTIV_REDUC = sSSP_ID_MOTIV_REDUC
              'SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CAUSA_SUST = sSSP_ID_CAUSA_SUST
              'SRGB_M4C_DATOS_ENVIADOS.SSP_NUSS_SUST = sSSP_NSS_SUST_PROV + sSSP_NUSS_SUST + sSSP_NSS_SUST_DC
              'SRGB_M4C_DATOS_ENVIADOS.SSP_PORC_MINUSVAL = sSSP_PORC_MINUSVAL
              'SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_INI_A_CONT = sSSP_FEC_INI_A_CONT
              'SRGB_M4C_DATOS_ENVIADOS.SSP_MUJER_24 = sSSP_MUJER_24
              'SRGB_M4C_DATOS_ENVIADOS.SSP_MUJER_SUBREPR = sSSP_MUJER_SUBREPR
              'SRGB_M4C_DATOS_ENVIADOS.SSP_DIAS_PRUEBA = sSSP_DIAS_PRUEBA
              'SRGB_M4C_DATOS_ENVIADOS.SSP_CLAUSULA_ADIC = sSSP_CLAUSULA_ADIC
              'SRGB_M4C_DATOS_ENVIADOS.SCO_ID_TYPE_ADJUST = sSCO_ID_TYPE_ADJUST
              'SRGB_M4C_DATOS_ENVIADOS.CMX_ID_CONVENIO = sCMX_ID_CONVENIO
              'SRGB_M4C_DATOS_ENVIADOS.CMX_ID_CATEGORIA = sCMX_ID_CATEGORIA
              'SRGB_M4C_DATOS_ENVIADOS.SSP_BRUTO_ANUAL = sSSP_BRUTO_ANUAL
              'SRGB_M4C_DATOS_ENVIADOS.CMX_ID_TP_SALARIO = sCMX_ID_TP_SALARIO
              'SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_ANTIGUEDAD = sSSP_FEC_ANTIGUEDAD
              'SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_EXTRAS = sSSP_FEC_EXTRAS
              'SRGB_M4C_DATOS_ENVIADOS.SGB_ID_SINDICATO = sSGB_ID_SINDICATO
              'SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_IRPF = sSSP_ID_TP_IRPF
              'SRGB_M4C_DATOS_ENVIADOS.SSP_ID_EST_IRPF = sSSP_ID_EST_IRPF
              'SRGB_M4C_DATOS_ENVIADOS.SSP_ID_MINUSVALIA = sSSP_ID_MINUSVALIA
              'SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CENTRO_FISICO = sSSP_ID_CENTRO_FIS
              'SRGB_M4C_DATOS_ENVIADOS.CMX_FORMA_DE_PAGO = sCMX_FORMA_DE_PAGO
              'SRGB_M4C_DATOS_ENVIADOS.SCO_ID_COMP_BANK = sSCO_ID_COMP_BANK
              ''COMP_BANC_SUC = sCOMP_BANC_SUC
              'SRGB_M4C_DATOS_ENVIADOS.SCO_ID_BANK_CODE = Mid(sCOMP_BANC_SUC, 0, 4)
              'SRGB_M4C_DATOS_ENVIADOS.CMX_ID_BANK_BRANCH = Mid(sCOMP_BANC_SUC, 4, 8)
              'SRGB_M4C_DATOS_ENVIADOS.SCO_ACCOUNT_NUMBER = sSCO_ACCOUNT_NUMBER
              'SRGB_M4C_DATOS_ENVIADOS.SSP_DC = sSSP_DC
              'SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_PRODUCTOR = sSSP_ID_TP_PRODUCTOR
              'SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_ACTIVIDAD = sSSP_ID_TP_ACTIVIDAD
'
              'SRGB_M4C_DATOS_ENVIADOS.Persist_tree()
              ''Se realizó el registro de las Altas de los empleados en la tabla de Datos Enviados
              'SetLog(M4_DEBUGINFOLOG,60,4,400,"Se realizó el registro del alta del colaborador (" + sSTD_ID_HR + ") en la tabla de Datos Enviados " + ToString(TodayNow(),0))
            'EndIf
'
            'SGB_M4C_REG_COLA_INF.Persist_tree()
            ''Altas Infoblock registradas
            'SetLog(M4_DEBUGINFOLOG, 60, 4, 400, "Altas Infoblock registradas " + ToString(TodayNow()))
'
''        ElseIf sTipoMov = "C" Then 'Registrando Deltas
''            iDelta = 0
'
''            'Por cada cambio se valida qu¿ campo se encuentra distinto a lo enviado a M4Cloud
''            SRGB_M4C_DATOS_ENVIADOS.DESTROYBLOCK()
''            sSql = "FROM &SGB_M4C_DATOS_ENVIADOS A "
''            sSql = sSql + "WHERE A.STD_ID_HR = '" + sSTD_ID_HR + "' "
''            SRGB_M4C_DATOS_ENVIADOS.FILTRO_SELECT = sSql
''            SRGB_M4C_DATOS_ENVIADOS.Load_Blk()
''
''            iRegSRGB_M4C_DATOS_ENVIADOS = SRGB_M4C_DATOS_ENVIADOS.Count()
''            If iRegSRGB_M4C_DATOS_ENVIADOS > 0 Then
''              SRGB_M4C_DATOS_ENVIADOS.Begin()
'
''              'El registro se realiza por grupo funcional. Si se detecta un cambio en cualquier campo
''              'del grupo funcional, se env¿a el grupo funcional completo
''              sCMX_TP_MOVIMIENTO = sFlagCambio
''              sCMX_DATE = SGB_M4C_MOVS_NOM_GEN.CMX_DATE
''              sFECHA_BAJA = NullValue() 'En blanco
''              sSTD_ID_HRP_END_REASON = NullValue() 'En blanco
''              sSSP_ID_CAUSA_DESEM = NullValue() 'En blanco
''              sSSP_FEC_FIN_VACAC = NullValue() 'En blanco
'
''              'SRGB_M4C_DATOS_ENVIADOS.ID_ORGANIZATION = "0005" 'Llave primaria
''              SRGB_M4C_DATOS_ENVIADOS.CMX_TP_MOVIMIENTO = "C" 'Se registra directamente la C para que permita el registro como un Cambio
''              SRGB_M4C_DATOS_ENVIADOS.CMX_DATE = sCMX_DATE
''              'FECHA_BAJA = sFECHA_BAJA
''              'SRGB_M4C_DATOS_ENVIADOS.STD_ID_HRP_END_REASON = sSTD_ID_HRP_END_REASON 'No se actualiza
''              'SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CAUSA_DESEM = sSSP_ID_CAUSA_DESEM 'No se actualiza
''              'SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_VACAC = sSSP_FEC_FIN_VACAC 'No se actualiza
''              'SRGB_M4C_DATOS_ENVIADOS.STD_ID_HR = sSTD_ID_HR 'Llave primaria
'
''              'Grupo funcional Nombre
''              sSSP_PRIMER_APELLIDO = NullValue()
''              sSTD_N_MAIDEN_NAME = NullValue()
''              sSTD_N_FIRST_NAME = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.SSP_PRIMER_APELLIDO <> SRGB_M4C_DATOS_ENVIADOS.SSP_PRIMER_APELLIDO Or  SGB_M4C_MOVS_NOM_GEN.STD_N_MAIDEN_NAME <> SRGB_M4C_DATOS_ENVIADOS.STD_N_MAIDEN_NAME Or SGB_M4C_MOVS_NOM_GEN.STD_N_FIRST_NAME <> SRGB_M4C_DATOS_ENVIADOS.STD_N_FIRST_NAME Then
''                iDelta = 1
''                sSSP_PRIMER_APELLIDO = SGB_M4C_MOVS_NOM_GEN.SSP_PRIMER_APELLIDO
''                sSTD_N_MAIDEN_NAME = SGB_M4C_MOVS_NOM_GEN.STD_N_MAIDEN_NAME
''                sSTD_N_FIRST_NAME = SGB_M4C_MOVS_NOM_GEN.STD_N_FIRST_NAME
'
''                SRGB_M4C_DATOS_ENVIADOS.SSP_PRIMER_APELLIDO = sSSP_PRIMER_APELLIDO
''                SRGB_M4C_DATOS_ENVIADOS.STD_N_MAIDEN_NAME = sSTD_N_MAIDEN_NAME
''                SRGB_M4C_DATOS_ENVIADOS.STD_N_FIRST_NAME = sSTD_N_FIRST_NAME
''              EndIf
''
''              'Grupo funcional N¿mero Documento
''              sCMX_ID_TP_DOC = NullValue()
''              sSSP_NUM_DOC = NullValue()
''              sSSP_ID_PAIS_EMISOR = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.CMX_ID_TP_DOC <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_TP_DOC Or  SGB_M4C_MOVS_NOM_GEN.SSP_NUM_DOC <> SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_DOC Or SGB_M4C_MOVS_NOM_GEN.SSP_ID_PAIS_EMISOR <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_PAIS_EMISOR Then
''                iDelta = 1
''                sCMX_ID_TP_DOC = SGB_M4C_MOVS_NOM_GEN.CMX_ID_TP_DOC
''                sSSP_NUM_DOC = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_DOC
''                sSSP_ID_PAIS_EMISOR = SGB_M4C_MOVS_NOM_GEN.SSP_ID_PAIS_EMISOR
'
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_TP_DOC = sCMX_ID_TP_DOC
''                SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_DOC = sSSP_NUM_DOC
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_PAIS_EMISOR = sSSP_ID_PAIS_EMISOR
''              EndIf
'
''              'Grupo funcional Fecha Nacimiento
''              sCMX_DT_BIRTH = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.CMX_DT_BIRTH <> SRGB_M4C_DATOS_ENVIADOS.CMX_DT_BIRTH Then
''                iDelta = 1
''                sCMX_DT_BIRTH = SGB_M4C_MOVS_NOM_GEN.CMX_DT_BIRTH
'
''                SRGB_M4C_DATOS_ENVIADOS.CMX_DT_BIRTH = sCMX_DT_BIRTH
''              EndIf
'
''              'Grupo funcional Nacionalidad
''              sCMX_ID_NACIONALITY = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.CMX_ID_NACIONALITY <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_NACIONALITY Then
''                iDelta = 1
''                sCMX_ID_NACIONALITY = SGB_M4C_MOVS_NOM_GEN.CMX_ID_NACIONALITY
'
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_NACIONALITY = sCMX_ID_NACIONALITY
''              EndIf
'
''              'Grupo funcional Lugar Nacimiento
''              sCMX_ID_COUNTRY = NullValue()
''              sCMX_ID_SUB_GEO_DIV_ADD = NullValue()
''              sCMX_ID_GEO_DIV_ADD = NullValue() 'En blanco
''              If SGB_M4C_MOVS_NOM_GEN.CMX_ID_COUNTRY <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_COUNTRY Or SGB_M4C_MOVS_NOM_GEN.SSP_ID_SUB_GEO_DIV <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_SUB_GEO_DIV_ADD Then
''                iDelta = 1
''                sCMX_ID_COUNTRY = SGB_M4C_MOVS_NOM_GEN.CMX_ID_COUNTRY
''                sCMX_ID_SUB_GEO_DIV_ADD = SGB_M4C_MOVS_NOM_GEN.SSP_ID_SUB_GEO_DIV
'
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_COUNTRY = sCMX_ID_COUNTRY
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_SUB_GEO_DIV_ADD = sCMX_ID_SUB_GEO_DIV_ADD
''                'SRGB_M4C_DATOS_ENVIADOS.CMX_ID_GEO_DIV_ADD = sCMX_ID_GEO_DIV_ADD 'No se actualiza
''              EndIf
'
''              'Grupo funcional Sexo
''              sSTD_ID_GENDER = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.STD_ID_GENDER <> SRGB_M4C_DATOS_ENVIADOS.STD_ID_GENDER Then
''                iDelta = 1
''                sSTD_ID_GENDER = SGB_M4C_MOVS_NOM_GEN.STD_ID_GENDER
'
''                SRGB_M4C_DATOS_ENVIADOS.STD_ID_GENDER = sSTD_ID_GENDER
''              EndIf
'
''              'Grupo funcional Estado Civil
''              sCMX_ID_MAR_STAT = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.CMX_ID_MAR_STAT <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_MAR_STAT Then
''                iDelta = 1
''                sCMX_ID_MAR_STAT = SGB_M4C_MOVS_NOM_GEN.CMX_ID_MAR_STAT
'
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_MAR_STAT = sCMX_ID_MAR_STAT
''              EndIf
'
''              sCMX_PHONE = NullValue()
''              sTEL_MOV = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.CMX_PHONE <> SRGB_M4C_DATOS_ENVIADOS.CMX_PHONE Then
''                iDelta = 1
''                sCMX_PHONE = SGB_M4C_MOVS_NOM_GEN.CMX_PHONE
''                sTEL_MOV = SGB_M4C_MOVS_NOM_GEN.CMX_PHONE
'
''                SRGB_M4C_DATOS_ENVIADOS.CMX_PHONE = sCMX_PHONE
''              EndIf
'
''              'El tel¿fono m¿vil est¿ marcado como CMX_PHONE en el layout*
''              'sTEL_MOV = NullValue()
''              'If SGB_M4C_MOVS_NOM_GEN.TEL_MOV <> SRGB_M4C_DATOS_ENVIADOS.CMX_PHONE Then
''              '  iDelta = 1
''              '  sTEL_MOV = SGB_M4C_MOVS_NOM_GEN.CMX_PHONE
''              'EndIf
'
''              'Grupo funcional Correo Electr¿nico
''              sCMX_EMAIL = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.CMX_EMAIL <> SRGB_M4C_DATOS_ENVIADOS.CMX_EMAIL Then
''                iDelta = 1
''                sCMX_EMAIL = SGB_M4C_MOVS_NOM_GEN.CMX_EMAIL
'
''                SRGB_M4C_DATOS_ENVIADOS.CMX_EMAIL = sCMX_EMAIL
''              EndIf
''
''              'Grupo funcional Direcci¿n
''              sSTD_ID_LOCATION_TYPE = "1" 'Hardcoded
''              sCMX_ID_SIGLA_DOMIC = NullValue()
''              sCMX_ADDRESS_LINE_1 = NullValue()
''              sCMX_NUM_VIA = NullValue()
''              sSSP_BLOQUE = NullValue()
''              sSSP_ESCALERA = NullValue()
''              sSSP_PISO = NullValue()
''              sSSP_PUERTA = NullValue()
''              sCMX_ID_GEO_PLACE = NullValue()
''              sCMX_ID_SUB_GEO_DIV = NullValue()
''              sCMX_ID_GEO_DIV = NullValue() 'En blanco
''              sCMX_ID_COUNTRY_ADD = NullValue()
''              sCMX_DISTRIT_POSTAL = NullValue()
'
''              If SGB_M4C_MOVS_NOM_GEN.CMX_ID_SIGLA_DOMIC <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_SIGLA_DOMIC Or SGB_M4C_MOVS_NOM_GEN.CMX_ADDRESS_LINE_1 <> SRGB_M4C_DATOS_ENVIADOS.CMX_ADDRESS_LINE_1 Or SGB_M4C_MOVS_NOM_GEN.CMX_NUM_VIA <> SRGB_M4C_DATOS_ENVIADOS.CMX_NUM_VIA Or SGB_M4C_MOVS_NOM_GEN.SSP_BLOQUE <> SRGB_M4C_DATOS_ENVIADOS.SSP_BLOQUE Or SGB_M4C_MOVS_NOM_GEN.SSP_ESCALERA <> SRGB_M4C_DATOS_ENVIADOS.SSP_ESCALERA Or SGB_M4C_MOVS_NOM_GEN.SSP_PISO <> SRGB_M4C_DATOS_ENVIADOS.SSP_PISO Or SGB_M4C_MOVS_NOM_GEN.SSP_PUERTA <> SRGB_M4C_DATOS_ENVIADOS.SSP_PUERTA Or SGB_M4C_MOVS_NOM_GEN.CMX_ID_GEO_PLACE <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_GEO_PLACE Or SGB_M4C_MOVS_NOM_GEN.CMX_ID_SUB_GEO_DIV <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_SUB_GEO_DIV Or SGB_M4C_MOVS_NOM_GEN.CMX_ID_COUNTRY_ADD <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_COUNTRY_ADD Or SGB_M4C_MOVS_NOM_GEN.CMX_DISTRIT_POSTAL <> SRGB_M4C_DATOS_ENVIADOS.CMX_DISTRIT_POSTAL Then
''                iDelta = 1
''                sCMX_ID_SIGLA_DOMIC = SGB_M4C_MOVS_NOM_GEN.CMX_ID_SIGLA_DOMIC
''                sCMX_ADDRESS_LINE_1 = SGB_M4C_MOVS_NOM_GEN.CMX_ADDRESS_LINE_1
''                sCMX_NUM_VIA = SGB_M4C_MOVS_NOM_GEN.CMX_NUM_VIA
''                sSSP_BLOQUE = SGB_M4C_MOVS_NOM_GEN.SSP_BLOQUE
''                sSSP_ESCALERA = SGB_M4C_MOVS_NOM_GEN.SSP_ESCALERA
''                sSSP_PISO = SGB_M4C_MOVS_NOM_GEN.SSP_PISO
''                sSSP_PUERTA = SGB_M4C_MOVS_NOM_GEN.SSP_PUERTA
''                sCMX_ID_GEO_PLACE = SGB_M4C_MOVS_NOM_GEN.CMX_ID_GEO_PLACE
''                sCMX_ID_SUB_GEO_DIV = SGB_M4C_MOVS_NOM_GEN.CMX_ID_SUB_GEO_DIV
''                sCMX_ID_COUNTRY_ADD = SGB_M4C_MOVS_NOM_GEN.CMX_ID_COUNTRY_ADD
''                sCMX_DISTRIT_POSTAL = SGB_M4C_MOVS_NOM_GEN.CMX_DISTRIT_POSTAL
'
''                SRGB_M4C_DATOS_ENVIADOS.STD_ID_LOCATION_TYPE = sSTD_ID_LOCATION_TYPE
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_SIGLA_DOMIC = sCMX_ID_SIGLA_DOMIC
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ADDRESS_LINE_1 = sCMX_ADDRESS_LINE_1
''                SRGB_M4C_DATOS_ENVIADOS.CMX_NUM_VIA = sCMX_NUM_VIA
''                SRGB_M4C_DATOS_ENVIADOS.SSP_BLOQUE = sSSP_BLOQUE
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ESCALERA = sSSP_ESCALERA
''                SRGB_M4C_DATOS_ENVIADOS.SSP_PISO = sSSP_PISO
''                SRGB_M4C_DATOS_ENVIADOS.SSP_PUERTA = sSSP_PUERTA
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_GEO_PLACE = sCMX_ID_GEO_PLACE
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_SUB_GEO_DIV = sCMX_ID_SUB_GEO_DIV
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_GEO_DIV = sCMX_ID_GEO_DIV
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_COUNTRY_ADD = sCMX_ID_COUNTRY_ADD
''                SRGB_M4C_DATOS_ENVIADOS.CMX_DISTRIT_POSTAL = sCMX_DISTRIT_POSTAL
''              EndIf
'
''              'Grupo funcional Empresa
''              sSCO_ID_LEG_ENT = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT <> SRGB_M4C_DATOS_ENVIADOS.SCO_ID_LEG_ENT Then
''                iDelta = 1
''                sSCO_ID_LEG_ENT = SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT
'
''                SRGB_M4C_DATOS_ENVIADOS.SCO_ID_LEG_ENT = sSCO_ID_LEG_ENT
''              EndIf
'
''              'Grupo funcional Puesto
''              sSCO_ID_JOB_CODE = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.SCO_ID_JOB_CODE <> SRGB_M4C_DATOS_ENVIADOS.SCO_ID_JOB_CODE Then
''                iDelta = 1
''                sSCO_ID_JOB_CODE = SGB_M4C_MOVS_NOM_GEN.SCO_ID_JOB_CODE
'
''                SRGB_M4C_DATOS_ENVIADOS.SCO_ID_JOB_CODE = sSCO_ID_JOB_CODE
''              EndIf
'
''              'Grupo funcional Unidad Organizativa
''              sCMX_ID_WORK_UNIT = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_UNIT <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_WORK_UNIT Then
''                iDelta = 1
''                sCMX_ID_WORK_UNIT = SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_UNIT
'
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_WORK_UNIT = sCMX_ID_WORK_UNIT
''              EndIf
'
''              'Grupo funcional Lugar de Trabajo
''              sCMX_ID_WORK_LOC = NullValue()
''              'If SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_WORK_LOC Then
''              If SGB_M4C_MOVS_NOM_GEN.SSP_ID_CENTRO_FISICO <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_WORK_LOC Then
''                iDelta = 1
''                sCMX_ID_WORK_LOC = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CENTRO_FISICO
'
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_WORK_LOC = sCMX_ID_WORK_LOC
''              EndIf
'
''              'Grupo funcional Centro de Costo
''              sSSP_ID_CENT_COSTO = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.CALC_CENT_COST() <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CENT_COSTO Then
''                iDelta = 1
''                sSSP_ID_CENT_COSTO = SGB_M4C_MOVS_NOM_GEN.CALC_CENT_COST()
'
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CENT_COSTO = sSSP_ID_CENT_COSTO
''              EndIf
'
''              sSTD_ID_HRP_START_REASON = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.STD_ID_HRP_START_REASON <> SRGB_M4C_DATOS_ENVIADOS.STD_ID_HRP_START_REASON Then
''                iDelta = 1
''                sSTD_ID_HRP_START_REASON = SGB_M4C_MOVS_NOM_GEN.STD_ID_HRP_START_REASON
'
''                SRGB_M4C_DATOS_ENVIADOS.STD_ID_HRP_START_REASON = sSTD_ID_HRP_START_REASON
''              EndIf
''
''              'Grupo funcional Tipo Empleado
''              sSTD_ID_HR_TYPE = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.STD_ID_HR_TYPE <> SRGB_M4C_DATOS_ENVIADOS.STD_ID_HR_TYPE Then
''                iDelta = 1
''                sSTD_ID_HR_TYPE = SGB_M4C_MOVS_NOM_GEN.STD_ID_HR_TYPE
'
''                SRGB_M4C_DATOS_ENVIADOS.STD_ID_HR_TYPE = sSTD_ID_HR_TYPE
''              EndIf
'
''              'Grupo funcional Agrupaci¿n de Gesti¿n
''              sSSP_ID_TP_GESTION = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_GESTION <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_GESTION Then
''                iDelta = 1
''                sSSP_ID_TP_GESTION = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_GESTION
'
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_GESTION = sSSP_ID_TP_GESTION
''              EndIf
'
''              'Grupo funcional Contrato
''              sSSP_FEC_FIN_PR_PRU = NullValue() 'En blanco
''              sSSP_FEC_FIN_PV_CON = NullValue()
''              sSCO_ID_DURATION = NullValue() 'En blanco
''              sSSP_ID_CONT_LEGAL = NullValue()
''              sCMX_ID_CONTRATO_INT = NullValue()
''              sSSP_FEC_FIN_CONTRA = NullValue()
''              sSSP_ID_REL_LAB = NullValue() 'En blanco
''              sSSP_VALOR_COEF_T_P = NullValue()
''              sSSP_TIPO_HORAS = NullValue()
''              sSSP_NUM_HORAS = NullValue()
''              sSSP_JP_REG_IRREG = NullValue()
''              sSSP_NUM_DIAS_JP = NullValue()
''              sSSP_ID_CAUSA_SUST = NullValue()
''              sSSP_NSS_SUST_PROV = NullValue()
''              sSSP_NUSS_SUST = NullValue()
''              sSSP_NSS_SUST_DC = NullValue()
''              sSSP_PORC_MINUSVAL = NullValue() 'En blanco
''              sSSP_FEC_INI_A_CONT = NullValue() 'En blanco
''              sSSP_MUJER_24 = NullValue() 'En blanco
''              sSSP_MUJER_SUBREPR = NullValue() 'En blanco
''              sSSP_DIAS_PRUEBA = NullValue() 'En blanco
''              sSSP_CLAUSULA_ADIC = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.SSP_FEC_FIN_PV_CON <> SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_PV_CON Or SGB_M4C_MOVS_NOM_GEN.SSP_ID_CONT_LEGAL <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CONT_LEGAL Or SGB_M4C_MOVS_NOM_GEN.CMX_ID_CONTRATO_INT <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_CONTRATO_INT Or SGB_M4C_MOVS_NOM_GEN.SSP_FEC_FIN_CONTRA <> SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_CONTRA Or SGB_M4C_MOVS_NOM_GEN.SSP_VALOR_COEF_T_P <> SRGB_M4C_DATOS_ENVIADOS.SSP_VALOR_COEF_T_P Or SGB_M4C_MOVS_NOM_GEN.SSP_TIPO_HORAS <> SRGB_M4C_DATOS_ENVIADOS.SSP_TIPO_HORAS Or SGB_M4C_MOVS_NOM_GEN.SSP_NUM_HORAS <> SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_HORAS Or SGB_M4C_MOVS_NOM_GEN.SSP_JP_REG_IRREG <> SRGB_M4C_DATOS_ENVIADOS.SSP_JP_REG_IRREG Or SGB_M4C_MOVS_NOM_GEN.SSP_NUM_DIAS_JP <> SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_DIAS_JP Or SGB_M4C_MOVS_NOM_GEN.SSP_ID_CAUSA_SUST <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CAUSA_SUST Or (SGB_M4C_MOVS_NOM_GEN.SSP_NSS_SUST_PROV + SGB_M4C_MOVS_NOM_GEN.SSP_NUSS_SUST + SGB_M4C_MOVS_NOM_GEN.SSP_NSS_SUST_DC) <> SRGB_M4C_DATOS_ENVIADOS.SSP_NUSS_SUST Or SGB_M4C_MOVS_NOM_GEN.SSP_CLAUSULA_ADIC <> SRGB_M4C_DATOS_ENVIADOS.SSP_CLAUSULA_ADIC Then
''                iDelta = 1
''                sSSP_FEC_FIN_PV_CON = SGB_M4C_MOVS_NOM_GEN.SSP_FEC_FIN_PV_CON
''                sSSP_ID_CONT_LEGAL = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CONT_LEGAL
''                sCMX_ID_CONTRATO_INT = SGB_M4C_MOVS_NOM_GEN.CMX_ID_CONTRATO_INT
''                sSSP_FEC_FIN_CONTRA = SGB_M4C_MOVS_NOM_GEN.SSP_FEC_FIN_CONTRA
''                sSSP_VALOR_COEF_T_P = SGB_M4C_MOVS_NOM_GEN.SSP_VALOR_COEF_T_P
''                sSSP_TIPO_HORAS = SGB_M4C_MOVS_NOM_GEN.SSP_TIPO_HORAS
''                sSSP_NUM_HORAS = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_HORAS
''                sSSP_JP_REG_IRREG = SGB_M4C_MOVS_NOM_GEN.SSP_JP_REG_IRREG
''                sSSP_NUM_DIAS_JP = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_DIAS_JP
''                sSSP_ID_CAUSA_SUST = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CAUSA_SUST
''                sSSP_NSS_SUST_PROV = (Mid(SGB_M4C_MOVS_NOM_GEN.SSP_NUSS_SUST, 0, 2))'2
''                sSSP_NUSS_SUST = (Mid(SGB_M4C_MOVS_NOM_GEN.SSP_NUSS_SUST, 2, 8)) '8
''                sSSP_NSS_SUST_DC = (Mid(SGB_M4C_MOVS_NOM_GEN.SSP_NUSS_SUST, 10, 2)) '2
''                sSSP_CLAUSULA_ADIC = SGB_M4C_MOVS_NOM_GEN.SSP_CLAUSULA_ADIC
'
''                SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_PV_CON = sSSP_FEC_FIN_PV_CON
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CONT_LEGAL = sSSP_ID_CONT_LEGAL
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_CONTRATO_INT = sCMX_ID_CONTRATO_INT
''                SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_CONTRA = sSSP_FEC_FIN_CONTRA
''                SRGB_M4C_DATOS_ENVIADOS.SSP_VALOR_COEF_T_P = sSSP_VALOR_COEF_T_P
''                SRGB_M4C_DATOS_ENVIADOS.SSP_TIPO_HORAS = sSSP_TIPO_HORAS
''                SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_HORAS = sSSP_NUM_HORAS
''                SRGB_M4C_DATOS_ENVIADOS.SSP_JP_REG_IRREG = sSSP_JP_REG_IRREG
''                SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_DIAS_JP = sSSP_NUM_DIAS_JP
''                SRG_M4C_DATOS_ENVIADOS.SSP_ID_CAUSA_SUST = sSSP_ID_CAUSA_SUST
''                SRG_M4C_DATOS_ENVIADOS.SSP_NUSS_SUST = sSSP_NSS_SUST_PROV + sSSP_NUSS_SUST + sSSP_NSS_SUST_DC
''                SRGB_M4C_DATOS_ENVIADOS.SSP_CLAUSULA_ADIC = sSSP_CLAUSULA_ADIC
''              EndIf
'
''              'Grupo funcional Num. Seguridad Social
''              sSSP_CON_NUM_SS = NullValue()
''              sSSP_PROV_NUM_SS = NullValue()
''              sSSP_NUM_SS = NullValue()
''              sSSP_DIG_NUM_SS = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.SSP_CON_NUM_SS <> SRGB_M4C_DATOS_ENVIADOS.SSP_CON_NUM_SS Or SGB_M4C_MOVS_NOM_GEN.CALC_PROV_NUM_SS() <> SRGB_M4C_DATOS_ENVIADOS.CALC_PROV_NUM_SS() Or SGB_M4C_MOVS_NOM_GEN.CALC_NUM_SS() <> SRGB_M4C_DATOS_ENVIADOS.CALC_NUM_SS() Or SGB_M4C_MOVS_NOM_GEN.CALC_DIG_NUM_SS() <> SRGB_M4C_DATOS_ENVIADOS.CALC_DIG_NUM_SS() Then
''                iDelta = 1
''                sSSP_CON_NUM_SS = SGB_M4C_MOVS_NOM_GEN.SSP_CON_NUM_SS
''                sSSP_PROV_NUM_SS = SGB_M4C_MOVS_NOM_GEN.CALC_PROV_NUM_SS()
''                sSSP_NUM_SS = SGB_M4C_MOVS_NOM_GEN.CALC_NUM_SS()
''                sSSP_DIG_NUM_SS = SGB_M4C_MOVS_NOM_GEN.CALC_DIG_NUM_SS()
'
''                SRGB_M4C_DATOS_ENVIADOS.SSP_CON_NUM_SS = sSSP_CON_NUM_SS
''                SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_SS = sSSP_PROV_NUM_SS + "-" + sSSP_NUM_SS + "-" + sSSP_DIG_NUM_SS
''              EndIf
'
''              'Grupo funcional Cabecera TC1
''              sSSP_ID_CABEC_TC1 = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.SSP_ID_CABEC_TC1 <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CABEC_TC1 Then
''                iDelta = 1
''                sSSP_ID_CABEC_TC1 = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CABEC_TC1
'
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CABEC_TC1 = sSSP_ID_CABEC_TC1
''              EndIf
'
''              'Grupo funcional Grupo Tarifa
''              sSSP_ID_GRUP_TARIFA = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.SSP_ID_GRUP_TARIFA <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_GRUP_TARIFA Then
''                iDelta = 1
''                sSSP_ID_GRUP_TARIFA = SGB_M4C_MOVS_NOM_GEN.SSP_ID_GRUP_TARIFA
'
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_GRUP_TARIFA = sSSP_ID_GRUP_TARIFA
''              EndIf
'
''              'Grupo funcional Ocupaci¿n
''              sSSP_ID_OCUPACION = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.SSP_ID_OCUPACION <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_OCUPACION Then
''                iDelta = 1
''                sSSP_ID_OCUPACION = SGB_M4C_MOVS_NOM_GEN.SSP_ID_OCUPACION
'
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_OCUPACION = sSSP_ID_OCUPACION
''              EndIf
'
''              sSSP_ID_CONV_SS = NullValue() 'En blanco
''              sSSP_NUM_PLURIEMPL = NullValue() 'En blanco
''
''              'Grupo funcional Reducci¿n Jornada
''              sSSP_PORC_GLEGAL = NullValue() 'En blanco
''              sSSP_ID_MOTIV_REDUC = NullValue() 'En blanco
'
''              'Grupo funcional Tipo ajuste/salario
''              sSCO_ID_TYPE_ADJUST = NullValue()
''              sSSP_BRUTO_ANUAL = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.SSP_ID_TYPE_ADJUST <> SRGB_M4C_DATOS_ENVIADOS.SCO_ID_TYPE_ADJUST Or SGB_M4C_MOVS_NOM_GEN.SSP_BRUTO_ANUAL <> SRGB_M4C_DATOS_ENVIADOS.SSP_BRUTO_ANUAL Then
''                iDelta = 1
''                sSCO_ID_TYPE_ADJUST = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TYPE_ADJUST
''                sSSP_BRUTO_ANUAL = SGB_M4C_MOVS_NOM_GEN.SSP_BRUTO_ANUAL
'
''                SRGB_M4C_DATOS_ENVIADOS.SCO_ID_TYPE_ADJUST = sSCO_ID_TYPE_ADJUST
''                SRGB_M4C_DATOS_ENVIADOS.SSP_BRUTO_ANUAL = sSSP_BRUTO_ANUAL
''              EndIf
'
''              'Grupo funcional Convenio
''              sCMX_ID_CONVENIO = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.CMX_ID_CONVENIO <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_CONVENIO Then
''                iDelta = 1
''                sCMX_ID_CONVENIO = SGB_M4C_MOVS_NOM_GEN.CMX_ID_CONVENIO
'
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_CONVENIO = sCMX_ID_CONVENIO
''              EndIf
'
''              'Grupo funcional Categor¿a
''              sCMX_ID_CATEGORIA = NullValue()
''              'If SGB_M4C_MOVS_NOM_GEN.CMX_ID_CATEGORIA <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_CATEGORIA Then
'''             If SGB_M4C_MOVS_NOM_GEN.SSP_ID_CATEGORIA <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_CATEGORIA Then
''                iDelta = 1
''                sCMX_ID_CATEGORIA = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CATEGORIA
'
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_CATEGORIA = sCMX_ID_CATEGORIA
''              EndIf
'
''              'Grupo funcional Tipo salario
''              sCMX_ID_TP_SALARIO = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_SALARIO <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_TP_SALARIO Then
''                iDelta = 1
''                sCMX_ID_TP_SALARIO = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_SALARIO
'
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_TP_SALARIO = sCMX_ID_TP_SALARIO
''              EndIf
'
''              'Grupo funcional Fecha antig¿edad
''              sSSP_FEC_ANTIGUEDAD = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.SSP_FEC_ANTIGUEDAD <> SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_ANTIGUEDAD Then
''                iDelta = 1
''                sSSP_FEC_ANTIGUEDAD = SGB_M4C_MOVS_NOM_GEN.SSP_FEC_ANTIGUEDAD
'
''                SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_ANTIGUEDAD = sSSP_FEC_ANTIGUEDAD
''              EndIf
'
''              sSSP_FEC_EXTRAS = NullValue() 'En blanco
''              If SGB_M4C_MOVS_NOM_GEN.SSP_FEC_EXTRAS <> SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_EXTRAS Then
''                iDelta = 1
''                sSSP_FEC_EXTRAS = SGB_M4C_MOVS_NOM_GEN.SSP_FEC_EXTRAS
'
''                SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_EXTRAS = sSSP_FEC_EXTRAS
''              EndIf
''
''              'Grupo funcional Sindicato
''              sSGB_ID_SINDICATO = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.SGB_ID_SINDICATO <> SRGB_M4C_DATOS_ENVIADOS.SGB_ID_SINDICATO Then
''                iDelta = 1
''                sSGB_ID_SINDICATO = SGB_M4C_MOVS_NOM_GEN.SGB_ID_SINDICATO
'
''                SRGB_M4C_DATOS_ENVIADOS.SGB_ID_SINDICATO = sSGB_ID_SINDICATO
''              EndIf
'
''              'Grupo funcional Tipo IRPF
''              sSSP_ID_TP_IRPF = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_IRPF <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_IRPF Then
''                iDelta = 1
''                sSSP_ID_TP_IRPF = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_IRPF
'
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_IRPF = sSSP_ID_TP_IRPF
''              EndIf
'
''              'Grupo funcional Situaci¿n IRPF
''              sSSP_ID_EST_IRPF = NullValue()
''              sSSP_ID_MINUSVALIA = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.SSP_ID_EST_IRPF <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_EST_IRPF Or SGB_M4C_MOVS_NOM_GEN.SSP_ID_MINUSVALIA <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_MINUSVALIA Then
''                iDelta = 1
''                sSSP_ID_EST_IRPF = SGB_M4C_MOVS_NOM_GEN.SSP_ID_EST_IRPF
''                sSSP_ID_MINUSVALIA = SGB_M4C_MOVS_NOM_GEN.SSP_ID_MINUSVALIA
'
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_EST_IRPF = sSSP_ID_EST_IRPF
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_MINUSVALIA = sSSP_ID_MINUSVALIA
''              EndIf
''
''              'Grupo funcional Centro f¿sico
''              sSSP_ID_CENTRO_FIS = NullValue()
''              'Se habilita en TRADES
''              If SGB_M4C_MOVS_NOM_GEN.SSP_ID_CENTRO_FISICO <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CENTRO_FISICO Then
''                iDelta = 1
''                sSSP_ID_CENTRO_FIS = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CENTRO_FISICO
'
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CENTRO_FISICO = sSSP_ID_CENTRO_FIS
''              EndIf
'
''              'Grupo funcional Datos pago
''              sCMX_FORMA_DE_PAGO = NullValue()
''              sSCO_ID_COMP_BANK = NullValue()
''              sCOMP_BANC_SUC = NullValue()
''              sSCO_ACCOUNT_NUMBER = NullValue()
''              sSSP_DC = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.SSP_ID_PAYM_TYPE <> SRGB_M4C_DATOS_ENVIADOS.CMX_FORMA_DE_PAGO Or SGB_M4C_MOVS_NOM_GEN.SCO_ID_COMP_BANK <> SRGB_M4C_DATOS_ENVIADOS.SCO_ID_COMP_BANK Or SGB_M4C_MOVS_NOM_GEN.CALC_COMP_BANC_SUC() <> SRGB_M4C_DATOS_ENVIADOS.CALC_COMP_BANC_SUC() Or SGB_M4C_MOVS_NOM_GEN.SCO_ACCOUNT_NUMBER <> SRGB_M4C_DATOS_ENVIADOS.SCO_ACCOUNT_NUMBER Or SGB_M4C_MOVS_NOM_GEN.SSP_DC <> SRGB_M4C_DATOS_ENVIADOS.SSP_DC Then
''                iDelta = 1
''                'sCMX_FORMA_DE_PAGO = SGB_M4C_MOVS_NOM_GEN.CMX_FORMA_DE_PAGO
''                sCMX_FORMA_DE_PAGO = SGB_M4C_MOVS_NOM_GEN.SSP_ID_PAYM_TYPE 'REVISAR SSP_ID_PAYM_DATA
''                sSCO_ID_COMP_BANK = SGB_M4C_MOVS_NOM_GEN.SCO_ID_COMP_BANK
''                sCOMP_BANC_SUC = SGB_M4C_MOVS_NOM_GEN.CALC_COMP_BANC_SUC()
''                sSCO_ACCOUNT_NUMBER = SGB_M4C_MOVS_NOM_GEN.SCO_ACCOUNT_NUMBER
''                sSSP_DC = SGB_M4C_MOVS_NOM_GEN.SSP_DC
'
''                SRGB_M4C_DATOS_ENVIADOS.CMX_FORMA_DE_PAGO = sCMX_FORMA_DE_PAGO
''                SRGB_M4C_DATOS_ENVIADOS.SCO_ID_COMP_BANK = sSCO_ID_COMP_BANK
''                SRGB_M4C_DATOS_ENVIADOS.SCO_ID_BANK_CODE = Mid(sCOMP_BANC_SUC, 0, 4)
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_BANK_BRANCH = Mid(sCOMP_BANC_SUC, 4, 8)
''                SRGB_M4C_DATOS_ENVIADOS.SCO_ACCOUNT_NUMBER = sSCO_ACCOUNT_NUMBER
''                SRGB_M4C_DATOS_ENVIADOS.SSP_DC = sSSP_DC
''              EndIf
'
''              'Grupo funcional Tipo productor
''              sSSP_ID_TP_PRODUCTOR = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_PRODUCTOR <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_PRODUCTOR Then
''                iDelta = 1
''                sSSP_ID_TP_PRODUCTOR = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_PRODUCTOR
'
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_PRODUCTOR = sSSP_ID_TP_PRODUCTOR
''              EndIf
'
''              'Grupo funcional Tipo actividad
''              sSSP_ID_TP_ACTIVIDAD = NullValue()
''              If SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_ACTIVIDAD <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_ACTIVIDAD Then
''                iDelta = 1
''                sSSP_ID_TP_ACTIVIDAD = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_ACTIVIDAD
'
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_ACTIVIDAD = sSSP_ID_TP_ACTIVIDAD
''              EndIf
'
''              If iDelta = 1 Then
''                SGB_M4C_REG_COLA.AddRegister()
''                SGB_M4C_REG_COLA.ID_ARCHIVO = sIDArchivo
''                SGB_M4C_REG_COLA.CMX_TP_MOVIMIENTO = sFlagCambio
''                SGB_M4C_REG_COLA.CMX_DATE = sCMX_DATE
''                SGB_M4C_REG_COLA.FECHA_BAJA = sFECHA_BAJA
''                SGB_M4C_REG_COLA.STD_ID_HRP_END_REASON = sSTD_ID_HRP_END_REASON
''                SGB_M4C_REG_COLA.SSP_ID_CAUSA_DESEM = sSSP_ID_CAUSA_DESEM
''                SGB_M4C_REG_COLA.SSP_FEC_FIN_VACAC = sSSP_FEC_FIN_VACAC
''                SGB_M4C_REG_COLA.STD_ID_HR = sSTD_ID_HR
''                SGB_M4C_REG_COLA.SSP_PRIMER_APELLIDO = sSSP_PRIMER_APELLIDO
''                SGB_M4C_REG_COLA.STD_N_MAIDEN_NAME = sSTD_N_MAIDEN_NAME
''                SGB_M4C_REG_COLA.STD_N_FIRST_NAME = sSTD_N_FIRST_NAME
''                SGB_M4C_REG_COLA.CMX_ID_TP_DOC = sCMX_ID_TP_DOC
''                SGB_M4C_REG_COLA.SSP_NUM_DOC = sSSP_NUM_DOC
''                SGB_M4C_REG_COLA.SSP_ID_PAIS_EMISOR = sSSP_ID_PAIS_EMISOR
''                SGB_M4C_REG_COLA.CMX_DT_BIRTH = sCMX_DT_BIRTH
''                SGB_M4C_REG_COLA.CMX_ID_NACIONALITY = sCMX_ID_NACIONALITY
''                SGB_M4C_REG_COLA.CMX_ID_COUNTRY = sCMX_ID_COUNTRY
''                SGB_M4C_REG_COLA.CMX_ID_SUB_GEO_DIV_ADD = sCMX_ID_SUB_GEO_DIV_ADD
''                SGB_M4C_REG_COLA.CMX_ID_GEO_DIV_ADD = sCMX_ID_GEO_DIV_ADD
''                SGB_M4C_REG_COLA.STD_ID_GENDER = sSTD_ID_GENDER
''                SGB_M4C_REG_COLA.CMX_ID_MAR_STAT = sCMX_ID_MAR_STAT
''                SGB_M4C_REG_COLA.CMX_PHONE = sCMX_PHONE
''                SGB_M4C_REG_COLA.TEL_MOV = sTEL_MOV
''                SGB_M4C_REG_COLA.CMX_EMAIL = sCMX_EMAIL
''                SGB_M4C_REG_COLA.STD_ID_LOCATION_TYPE = sSTD_ID_LOCATION_TYPE
''                SGB_M4C_REG_COLA.CMX_ID_SIGLA_DOMIC = sCMX_ID_SIGLA_DOMIC
''                SGB_M4C_REG_COLA.CMX_ADDRESS_LINE_1 = sCMX_ADDRESS_LINE_1
''                SGB_M4C_REG_COLA.CMX_NUM_VIA = sCMX_NUM_VIA
''                SGB_M4C_REG_COLA.SSP_BLOQUE = sSSP_BLOQUE
''                SGB_M4C_REG_COLA.SSP_ESCALERA = sSSP_ESCALERA
''                SGB_M4C_REG_COLA.SSP_PISO = sSSP_PISO
''                SGB_M4C_REG_COLA.SSP_PUERTA = sSSP_PUERTA
''                SGB_M4C_REG_COLA.CMX_ID_GEO_PLACE = sCMX_ID_GEO_PLACE
''                SGB_M4C_REG_COLA.CMX_ID_SUB_GEO_DIV = sCMX_ID_SUB_GEO_DIV
''                SGB_M4C_REG_COLA.CMX_ID_GEO_DIV = sCMX_ID_GEO_DIV
''                SGB_M4C_REG_COLA.CMX_ID_COUNTRY_ADD = sCMX_ID_COUNTRY_ADD
''                SGB_M4C_REG_COLA.CMX_DISTRIT_POSTAL = sCMX_DISTRIT_POSTAL
''                SGB_M4C_REG_COLA.SCO_ID_LEG_ENT = sSCO_ID_LEG_ENT
''                SGB_M4C_REG_COLA.SCO_ID_JOB_CODE = sSCO_ID_JOB_CODE
''                SGB_M4C_REG_COLA.CMX_ID_WORK_UNIT = sCMX_ID_WORK_UNIT
''                SGB_M4C_REG_COLA.CMX_ID_WORK_LOC = sCMX_ID_WORK_LOC
''                SGB_M4C_REG_COLA.SSP_ID_CENT_COSTO = sSSP_ID_CENT_COSTO
''                SGB_M4C_REG_COLA.STD_ID_HRP_START_REASON = sSTD_ID_HRP_START_REASON
''                SGB_M4C_REG_COLA.STD_ID_HR_TYPE = sSTD_ID_HR_TYPE
''                SGB_M4C_REG_COLA.SSP_ID_TP_GESTION = sSSP_ID_TP_GESTION
''                SGB_M4C_REG_COLA.SSP_FEC_FIN_PR_PRU = sSSP_FEC_FIN_PR_PRU
''                SGB_M4C_REG_COLA.SSP_FEC_FIN_PV_CON = sSSP_FEC_FIN_PV_CON
''                SGB_M4C_REG_COLA.SCO_ID_DURATION = sSCO_ID_DURATION
''                SGB_M4C_REG_COLA.SSP_CON_NUM_SS = sSSP_CON_NUM_SS
''                SGB_M4C_REG_COLA.SSP_PROV_NUM_SS = sSSP_PROV_NUM_SS
''                SGB_M4C_REG_COLA.SSP_NUM_SS = sSSP_NUM_SS
''                SGB_M4C_REG_COLA.SSP_DIG_NUM_SS = sSSP_DIG_NUM_SS
''                SGB_M4C_REG_COLA.SSP_ID_CABEC_TC1 = sSSP_ID_CABEC_TC1
''                SGB_M4C_REG_COLA.SSP_ID_GRUP_TARIFA = sSSP_ID_GRUP_TARIFA
''                SGB_M4C_REG_COLA.SSP_ID_OCUPACION = sSSP_ID_OCUPACION
''                SGB_M4C_REG_COLA.SSP_ID_CONV_SS = sSSP_ID_CONV_SS
''                SGB_M4C_REG_COLA.SSP_NUM_PLURIEMPL = sSSP_NUM_PLURIEMPL
''                SGB_M4C_REG_COLA.SSP_ID_CONT_LEGAL = sSSP_ID_CONT_LEGAL
''                SGB_M4C_REG_COLA.CMX_ID_CONTRATO_INT = sCMX_ID_CONTRATO_INT
''                SGB_M4C_REG_COLA.SSP_FEC_FIN_CONTRA = sSSP_FEC_FIN_CONTRA
''                SGB_M4C_REG_COLA.SSP_ID_REL_LAB = sSSP_ID_REL_LAB
''                SGB_M4C_REG_COLA.SSP_VALOR_COEF_T_P = sSSP_VALOR_COEF_T_P
''                SGB_M4C_REG_COLA.SSP_TIPO_HORAS = sSSP_TIPO_HORAS
''                SGB_M4C_REG_COLA.SSP_NUM_HORAS = sSSP_NUM_HORAS
''                SGB_M4C_REG_COLA.SSP_JP_REG_IRREG = sSSP_JP_REG_IRREG
''                SGB_M4C_REG_COLA.SSP_NUM_DIAS_JP = sSSP_NUM_DIAS_JP
''                SGB_M4C_REG_COLA.SSP_PORC_GLEGAL = sSSP_PORC_GLEGAL
''                SGB_M4C_REG_COLA.SSP_ID_MOTIV_REDUC = sSSP_ID_MOTIV_REDUC
''                SGB_M4C_REG_COLA.SSP_ID_CAUSA_SUST = sSSP_ID_CAUSA_SUST
''                SGB_M4C_REG_COLA.SSP_NSS_SUST_PROV = sSSP_NSS_SUST_PROV
''                SGB_M4C_REG_COLA.SSP_NUSS_SUST = sSSP_NUSS_SUST
''                SGB_M4C_REG_COLA.SSP_NSS_SUST_DC = sSSP_NSS_SUST_DC
''                SGB_M4C_REG_COLA.SSP_PORC_MINUSVAL = sSSP_PORC_MINUSVAL
''                SGB_M4C_REG_COLA.SSP_FEC_INI_A_CONT = sSSP_FEC_INI_A_CONT
''                SGB_M4C_REG_COLA.SSP_MUJER_24 = sSSP_MUJER_24
''                SGB_M4C_REG_COLA.SSP_MUJER_SUBREPR = sSSP_MUJER_SUBREPR
''                SGB_M4C_REG_COLA.SSP_DIAS_PRUEBA = sSSP_DIAS_PRUEBA
''                SGB_M4C_REG_COLA.SSP_CLAUSULA_ADIC = sSSP_CLAUSULA_ADIC
''                SGB_M4C_REG_COLA.SCO_ID_TYPE_ADJUST = sSCO_ID_TYPE_ADJUST
''                SGB_M4C_REG_COLA.CMX_ID_CONVENIO = sCMX_ID_CONVENIO
''                SGB_M4C_REG_COLA.CMX_ID_CATEGORIA = sCMX_ID_CATEGORIA
''                SGB_M4C_REG_COLA.SSP_BRUTO_ANUAL = sSSP_BRUTO_ANUAL
''                SGB_M4C_REG_COLA.CMX_ID_TP_SALARIO = sCMX_ID_TP_SALARIO
''                SGB_M4C_REG_COLA.SSP_FEC_ANTIGUEDAD = sSSP_FEC_ANTIGUEDAD
''                SGB_M4C_REG_COLA.SSP_FEC_EXTRAS = sSSP_FEC_EXTRAS
''                SGB_M4C_REG_COLA.SGB_ID_SINDICATO = sSGB_ID_SINDICATO
''                SGB_M4C_REG_COLA.SSP_ID_TP_IRPF = sSSP_ID_TP_IRPF
''                SGB_M4C_REG_COLA.SSP_ID_EST_IRPF = sSSP_ID_EST_IRPF
''                SGB_M4C_REG_COLA.SSP_ID_MINUSVALIA = sSSP_ID_MINUSVALIA
''                SGB_M4C_REG_COLA.SSP_ID_CENTRO_FIS = sSSP_ID_CENTRO_FIS
''                SGB_M4C_REG_COLA.CMX_FORMA_DE_PAGO = sCMX_FORMA_DE_PAGO
''                SGB_M4C_REG_COLA.SCO_ID_COMP_BANK = sSCO_ID_COMP_BANK
''                SGB_M4C_REG_COLA.COMP_BANC_SUC = sCOMP_BANC_SUC
''                SGB_M4C_REG_COLA.SCO_ACCOUNT_NUMBER = sSCO_ACCOUNT_NUMBER
''                SGB_M4C_REG_COLA.SSP_DC = sSSP_DC
''                SGB_M4C_REG_COLA.SSP_ID_TP_PRODUCTOR = sSSP_ID_TP_PRODUCTOR
''                SGB_M4C_REG_COLA.SSP_ID_TP_ACTIVIDAD = sSSP_ID_TP_ACTIVIDAD
'
''                SGB_M4C_REG_COLA_INF.AddRegister()
''                SGB_M4C_REG_COLA_INF.ID_ARCHIVO = sIDArchivoInf
''                SGB_M4C_REG_COLA_INF.USUARIO = "TB"
''                SGB_M4C_REG_COLA_INF.ID = SGB_M4C_MOVS_NOM_GEN.STD_ID_HR
''                SGB_M4C_REG_COLA_INF.ORGANIZATIONID = SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT
''                SGB_M4C_REG_COLA_INF.PARENTID = SGB_M4C_CALC_DEPTO(SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC, dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT)
''                SGB_M4C_REG_COLA_INF.NAME = SGB_M4C_MOVS_NOM_GEN.STD_N_FIRST_NAME
''                SGB_M4C_REG_COLA_INF.PATERNALSURNAME = SGB_M4C_MOVS_NOM_GEN.SSP_PRIMER_APELLIDO
''                SGB_M4C_REG_COLA_INF.MATERNALSURNAME = SGB_M4C_MOVS_NOM_GEN.STD_N_MAIDEN_NAME
''                SGB_M4C_REG_COLA_INF.BIRTHDATE = FORMAT_YYYY_MM_DD(SGB_M4C_MOVS_NOM_GEN.CMX_DT_BIRTH)
''                SGB_M4C_REG_COLA_INF.SEX = ToString((ToInt(SGB_M4C_MOVS_NOM_GEN.STD_ID_GENDER) - 1),0 ) '0 = Masculino, 1 = Femenino
''                SGB_M4C_REG_COLA_INF.NIN = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_SS
''                SGB_M4C_REG_COLA_INF.EMAIL = SGB_M4C_MOVS_NOM_GEN.CMX_EMAIL
''                SGB_M4C_REG_COLA_INF.ORGANIZATION = SGB_M4C_CALC_EMPRESA(SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT, dFechaHoraIni)
''                SGB_M4C_REG_COLA_INF.DEPARTMENT = SGB_M4C_CALC_WLOCAT(SGB_M4C_CALC_DEPTO(SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC, dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT),  dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT) 'Obtiene el nombre del WLOC pasado por par¿metro
''                SGB_M4C_REG_COLA_INF.CATEGORY = SGB_M4C_CALC_CATEG(SGB_M4C_MOVS_NOM_GEN.SSP_ID_CATEGORIA)
''                SGB_M4C_REG_COLA_INF.POSICION = SGB_M4C_CALC_POSICION(SGB_M4C_MOVS_NOM_GEN.STD_ID_HR, dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT)
''                SGB_M4C_REG_COLA_INF.COSTCENTER = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CENT_COSTO
''                SGB_M4C_REG_COLA_INF.PAYROLL = "3"
''                SGB_M4C_REG_COLA_INF.OTHER1 = SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC
''                SGB_M4C_REG_COLA_INF.OTHER2 = SGB_M4C_CALC_WLOCAT(SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC,  dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT) 'Obtiene el nombre del WLOC pasado por par¿metro
''                SGB_M4C_REG_COLA_INF.OTHER3 = SGB_M4C_CALC_TIPO_EMP("0005", SGB_M4C_MOVS_NOM_GEN.STD_ID_HR_TYPE)
''                SGB_M4C_REG_COLA_INF.ACTIVE = "1"
''                SGB_M4C_REG_COLA_INF.INTERNAL = "1"
''                SGB_M4C_REG_COLA_INF.CRC = "0"
''                SGB_M4C_REG_COLA_INF.STARTDATE = FORMAT_YYYY_MM_DD(SGB_M4C_MOVS_NOM_GEN.STD_DT_START)
''                SGB_M4C_REG_COLA_INF.DATE1 = FORMAT_YYYY_MM_DD(SGB_M4C_MOVS_NOM_GEN.SSP_FEC_ANTIGUEDAD)
''                SGB_M4C_REG_COLA_INF.DATE2 = NullValue()
''                SGB_M4C_REG_COLA_INF.NIF = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_DOC
'
''                If SGB_M4C_REG_COLA.Persist_tree() <> M4_ERROR Then
''                  'Deltas registrados
''                  SetLog(M4_DEBUGINFOLOG, 60, 4, 400, "Deltas registrados " + ToString(TodayNow()))
'
''                  SGB_M4C_REG_COLA_INF.Persist_tree()
''                  'Deltas Infoblock registrados
''                  SetLog(M4_DEBUGINFOLOG, 60, 4, 400, "Deltas Infoblock registrados " + ToString(TodayNow()))
'
''                  SRGB_M4C_DATOS_ENVIADOS.Persist_tree()
''                  'Se realizó la actualización de los Deltas de los empleados en la tabla de Datos Enviados
''                  SetLog(M4_DEBUGINFOLOG,60,4,400,"Se realizó la actualización de los Deltas de los empleados en la tabla de Datos Enviados " + ToString(TodayNow(),0))
''                EndIf
'
''              EndIf
'
''            Else
''              'Se intent¿ realizar un cambio al Empleado: , pero no existe su registro en la tabla de Datos Eviados
''              SetLog(M4_DEBUGINFOLOG, 60, 4, 400, "'Se intento realizar un cambio al Empleado: " + sSTD_ID_HR + ", pero no existe su registro en la tabla de Datos Eviados, se enviar¿ como un cambio " + ToString(TodayNow()))
''
''              'Existen casos en donde no hay registro en Nomina Gen de un colaborador, por lo que hay que enviar los registros encontrados como un cambio.
'
''              sCMX_DATE = SGB_M4C_MOVS_NOM_GEN.CMX_DATE
''              sSSP_PRIMER_APELLIDO = SGB_M4C_MOVS_NOM_GEN.SSP_PRIMER_APELLIDO
''              sSTD_N_MAIDEN_NAME = SGB_M4C_MOVS_NOM_GEN.STD_N_MAIDEN_NAME
''              sSTD_N_FIRST_NAME = SGB_M4C_MOVS_NOM_GEN.STD_N_FIRST_NAME
''              sCMX_ID_TP_DOC = SGB_M4C_MOVS_NOM_GEN.CMX_ID_TP_DOC
''              sSSP_NUM_DOC = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_DOC
''              sSSP_ID_PAIS_EMISOR = SGB_M4C_MOVS_NOM_GEN.SSP_ID_PAIS_EMISOR
''              sCMX_DT_BIRTH = SGB_M4C_MOVS_NOM_GEN.CMX_DT_BIRTH
''              sCMX_ID_NACIONALITY = SGB_M4C_MOVS_NOM_GEN.CMX_ID_NACIONALITY
''              sCMX_ID_COUNTRY = SGB_M4C_MOVS_NOM_GEN.CMX_ID_COUNTRY
''              sCMX_ID_SUB_GEO_DIV_ADD = SGB_M4C_MOVS_NOM_GEN.CMX_ID_SUB_GEO_DIV_ADD
''              sSTD_ID_GENDER = SGB_M4C_MOVS_NOM_GEN.STD_ID_GENDER
''              sCMX_ID_MAR_STAT = SGB_M4C_MOVS_NOM_GEN.CMX_ID_MAR_STAT
''              sCMX_PHONE = SGB_M4C_MOVS_NOM_GEN.CMX_PHONE
''              sTEL_MOV = SGB_M4C_MOVS_NOM_GEN.CMX_PHONE
''              '  sTEL_MOV = SGB_M4C_MOVS_NOM_GEN.CMX_PHONE
''              sCMX_EMAIL = SGB_M4C_MOVS_NOM_GEN.CMX_EMAIL
''              sCMX_ID_SIGLA_DOMIC = SGB_M4C_MOVS_NOM_GEN.CMX_ID_SIGLA_DOMIC
''              sCMX_ADDRESS_LINE_1 = SGB_M4C_MOVS_NOM_GEN.CMX_ADDRESS_LINE_1
''              sCMX_NUM_VIA = SGB_M4C_MOVS_NOM_GEN.CMX_NUM_VIA
''              sSSP_BLOQUE = SGB_M4C_MOVS_NOM_GEN.SSP_BLOQUE
''              sSSP_ESCALERA = SGB_M4C_MOVS_NOM_GEN.SSP_ESCALERA
''              sSSP_PISO = SGB_M4C_MOVS_NOM_GEN.SSP_PISO
''              sSSP_PUERTA = SGB_M4C_MOVS_NOM_GEN.SSP_PUERTA
''              sCMX_ID_GEO_PLACE = SGB_M4C_MOVS_NOM_GEN.CMX_ID_GEO_PLACE
''              sCMX_ID_SUB_GEO_DIV = SGB_M4C_MOVS_NOM_GEN.CMX_ID_SUB_GEO_DIV
''              sCMX_ID_COUNTRY_ADD = SGB_M4C_MOVS_NOM_GEN.CMX_ID_COUNTRY_ADD
''              sCMX_DISTRIT_POSTAL = SGB_M4C_MOVS_NOM_GEN.CMX_DISTRIT_POSTAL
''              sSCO_ID_LEG_ENT = SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT
''              sSCO_ID_JOB_CODE = SGB_M4C_MOVS_NOM_GEN.SCO_ID_JOB_CODE
''              sCMX_ID_WORK_UNIT = SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_UNIT
''              sCMX_ID_WORK_LOC = SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC
''              sSSP_ID_CENT_COSTO = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CENT_COSTO
''              sSTD_ID_HRP_START_REASON = SGB_M4C_MOVS_NOM_GEN.STD_ID_HRP_START_REASON
''              sSTD_ID_HR_TYPE = SGB_M4C_MOVS_NOM_GEN.STD_ID_HR_TYPE
''              sSSP_ID_TP_GESTION = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_GESTION
''              sSSP_FEC_FIN_PV_CON = SGB_M4C_MOVS_NOM_GEN.SSP_FEC_FIN_PV_CON
''              sSSP_ID_CONT_LEGAL = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CONT_LEGAL
''              sCMX_ID_CONTRATO_INT = SGB_M4C_MOVS_NOM_GEN.CMX_ID_CONTRATO_INT
''              sSSP_FEC_FIN_CONTRA = SGB_M4C_MOVS_NOM_GEN.SSP_FEC_FIN_CONTRA
''              sSSP_ID_CAUSA_SUST = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CAUSA_SUST
''              sSSP_NSS_SUST_PROV = (Mid(SGB_M4C_MOVS_NOM_GEN.SSP_NUSS_SUST, 0, 2)) '2
''              sSSP_NUSS_SUST = (Mid(SGB_M4C_MOVS_NOM_GEN.SSP_NUSS_SUST, 2, 8)) '8
''              sSSP_NSS_SUST_DC = (Mid(SGB_M4C_MOVS_NOM_GEN.SSP_NUSS_SUST, 10, 2)) '2
''              sSSP_CLAUSULA_ADIC = SGB_M4C_MOVS_NOM_GEN.SSP_CLAUSULA_ADIC
''              sSSP_CON_NUM_SS = SGB_M4C_MOVS_NOM_GEN.SSP_CON_NUM_SS
''              sSSP_PROV_NUM_SS = SGB_M4C_MOVS_NOM_GEN.CALC_PROV_NUM_SS()
''              sSSP_NUM_SS = SGB_M4C_MOVS_NOM_GEN.CALC_NUM_SS()
''              sSSP_DIG_NUM_SS = SGB_M4C_MOVS_NOM_GEN.CALC_DIG_NUM_SS()
''              sSSP_ID_CABEC_TC1 = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CABEC_TC1
''              sSSP_ID_GRUP_TARIFA = SGB_M4C_MOVS_NOM_GEN.SSP_ID_GRUP_TARIFA
''              sSSP_ID_OCUPACION = SGB_M4C_MOVS_NOM_GEN.SSP_ID_OCUPACION
''              sSCO_ID_TYPE_ADJUST = SGB_M4C_MOVS_NOM_GEN.SCO_ID_TYPE_ADJUST
''              sSSP_BRUTO_ANUAL = SGB_M4C_MOVS_NOM_GEN.SSP_BRUTO_ANUAL
''              sCMX_ID_CONVENIO = SGB_M4C_MOVS_NOM_GEN.CMX_ID_CONVENIO
''              'sCMX_ID_CATEGORIA = SGB_M4C_MOVS_NOM_GEN.CMX_ID_CATEGORIA
''              sCMX_ID_CATEGORIA = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CATEGORIA
''              sCMX_ID_TP_SALARIO = SGB_M4C_MOVS_NOM_GEN.CMX_ID_TP_SALARIO
''              sSSP_FEC_ANTIGUEDAD = SGB_M4C_MOVS_NOM_GEN.SSP_FEC_ANTIGUEDAD
''              sSSP_FEC_EXTRAS = SGB_M4C_MOVS_NOM_GEN.SSP_FEC_EXTRAS
''              sSGB_ID_SINDICATO = SGB_M4C_MOVS_NOM_GEN.SGB_ID_SINDICATO
''              sSSP_ID_TP_IRPF = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_IRPF
''              sSSP_ID_EST_IRPF = SGB_M4C_MOVS_NOM_GEN.SSP_ID_EST_IRPF
''              sSSP_ID_MINUSVALIA = SGB_M4C_MOVS_NOM_GEN.SSP_ID_MINUSVALIA
''              sSSP_ID_CENTRO_FIS = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CENTRO_FISICO
''              sCMX_FORMA_DE_PAGO = SGB_M4C_MOVS_NOM_GEN.CMX_FORMA_DE_PAGO
''              sSCO_ID_COMP_BANK = SGB_M4C_MOVS_NOM_GEN.SCO_ID_COMP_BANK
''              sCOMP_BANC_SUC = SGB_M4C_MOVS_NOM_GEN.CALC_COMP_BANC_SUC()
''              sSCO_ACCOUNT_NUMBER = SGB_M4C_MOVS_NOM_GEN.SCO_ACCOUNT_NUMBER
''              sSSP_DC = SGB_M4C_MOVS_NOM_GEN.SSP_DC
''              sSSP_ID_TP_PRODUCTOR = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_PRODUCTOR
''              sSSP_ID_TP_ACTIVIDAD = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_ACTIVIDAD
'
''              SGB_M4C_REG_COLA.AddRegister()
''              SGB_M4C_REG_COLA.ID_ARCHIVO = sIDArchivo
''              SGB_M4C_REG_COLA.CMX_TP_MOVIMIENTO = sFlagCambio
''              SGB_M4C_REG_COLA.CMX_DATE = sCMX_DATE
''              SGB_M4C_REG_COLA.FECHA_BAJA = sFECHA_BAJA
''              SGB_M4C_REG_COLA.STD_ID_HRP_END_REASON = sSTD_ID_HRP_END_REASON
''              SGB_M4C_REG_COLA.SSP_ID_CAUSA_DESEM = sSSP_ID_CAUSA_DESEM
''              SGB_M4C_REG_COLA.SSP_FEC_FIN_VACAC = sSSP_FEC_FIN_VACAC
''              SGB_M4C_REG_COLA.STD_ID_HR = sSTD_ID_HR
''              SGB_M4C_REG_COLA.SSP_PRIMER_APELLIDO = sSSP_PRIMER_APELLIDO
''              SGB_M4C_REG_COLA.STD_N_MAIDEN_NAME = sSTD_N_MAIDEN_NAME
''              SGB_M4C_REG_COLA.STD_N_FIRST_NAME = sSTD_N_FIRST_NAME
''              SGB_M4C_REG_COLA.CMX_ID_TP_DOC = sCMX_ID_TP_DOC
''              SGB_M4C_REG_COLA.SSP_NUM_DOC = sSSP_NUM_DOC
''              SGB_M4C_REG_COLA.SSP_ID_PAIS_EMISOR = sSSP_ID_PAIS_EMISOR
''              SGB_M4C_REG_COLA.CMX_DT_BIRTH = sCMX_DT_BIRTH
''              SGB_M4C_REG_COLA.CMX_ID_NACIONALITY = sCMX_ID_NACIONALITY
''              SGB_M4C_REG_COLA.CMX_ID_COUNTRY = sCMX_ID_COUNTRY
''              SGB_M4C_REG_COLA.CMX_ID_SUB_GEO_DIV_ADD = sCMX_ID_SUB_GEO_DIV_ADD
''              SGB_M4C_REG_COLA.CMX_ID_GEO_DIV_ADD = sCMX_ID_GEO_DIV_ADD
''              SGB_M4C_REG_COLA.STD_ID_GENDER = sSTD_ID_GENDER
''              SGB_M4C_REG_COLA.CMX_ID_MAR_STAT = sCMX_ID_MAR_STAT
''              SGB_M4C_REG_COLA.CMX_PHONE = sCMX_PHONE
''              SGB_M4C_REG_COLA.TEL_MOV = sTEL_MOV
''              SGB_M4C_REG_COLA.CMX_EMAIL = sCMX_EMAIL
''              SGB_M4C_REG_COLA.STD_ID_LOCATION_TYPE = sSTD_ID_LOCATION_TYPE
''              SGB_M4C_REG_COLA.CMX_ID_SIGLA_DOMIC = sCMX_ID_SIGLA_DOMIC
''              SGB_M4C_REG_COLA.CMX_ADDRESS_LINE_1 = sCMX_ADDRESS_LINE_1
''              SGB_M4C_REG_COLA.CMX_NUM_VIA = sCMX_NUM_VIA
''              SGB_M4C_REG_COLA.SSP_BLOQUE = sSSP_BLOQUE
''              SGB_M4C_REG_COLA.SSP_ESCALERA = sSSP_ESCALERA
''              SGB_M4C_REG_COLA.SSP_PISO = sSSP_PISO
''              SGB_M4C_REG_COLA.SSP_PUERTA = sSSP_PUERTA
''              SGB_M4C_REG_COLA.CMX_ID_GEO_PLACE = sCMX_ID_GEO_PLACE
''              SGB_M4C_REG_COLA.CMX_ID_SUB_GEO_DIV = sCMX_ID_SUB_GEO_DIV
''              SGB_M4C_REG_COLA.CMX_ID_GEO_DIV = sCMX_ID_GEO_DIV
''              SGB_M4C_REG_COLA.CMX_ID_COUNTRY_ADD = sCMX_ID_COUNTRY_ADD
''              SGB_M4C_REG_COLA.CMX_DISTRIT_POSTAL = sCMX_DISTRIT_POSTAL
''              SGB_M4C_REG_COLA.SCO_ID_LEG_ENT = sSCO_ID_LEG_ENT
''              SGB_M4C_REG_COLA.SCO_ID_JOB_CODE = sSCO_ID_JOB_CODE
''              SGB_M4C_REG_COLA.CMX_ID_WORK_UNIT = sCMX_ID_WORK_UNIT
''              SGB_M4C_REG_COLA.CMX_ID_WORK_LOC = sCMX_ID_WORK_LOC
''              SGB_M4C_REG_COLA.SSP_ID_CENT_COSTO = sSSP_ID_CENT_COSTO
''              SGB_M4C_REG_COLA.STD_ID_HRP_START_REASON = sSTD_ID_HRP_START_REASON
''              SGB_M4C_REG_COLA.STD_ID_HR_TYPE = sSTD_ID_HR_TYPE
''              SGB_M4C_REG_COLA.SSP_ID_TP_GESTION = sSSP_ID_TP_GESTION
''              SGB_M4C_REG_COLA.SSP_FEC_FIN_PR_PRU = sSSP_FEC_FIN_PR_PRU
''              SGB_M4C_REG_COLA.SSP_FEC_FIN_PV_CON = sSSP_FEC_FIN_PV_CON
''              SGB_M4C_REG_COLA.SCO_ID_DURATION = sSCO_ID_DURATION
''              SGB_M4C_REG_COLA.SSP_CON_NUM_SS = sSSP_CON_NUM_SS
''              SGB_M4C_REG_COLA.SSP_PROV_NUM_SS = sSSP_PROV_NUM_SS
''              SGB_M4C_REG_COLA.SSP_NUM_SS = sSSP_NUM_SS
''              SGB_M4C_REG_COLA.SSP_DIG_NUM_SS = sSSP_DIG_NUM_SS
''              SGB_M4C_REG_COLA.SSP_ID_CABEC_TC1 = sSSP_ID_CABEC_TC1
''              SGB_M4C_REG_COLA.SSP_ID_GRUP_TARIFA = sSSP_ID_GRUP_TARIFA
''              SGB_M4C_REG_COLA.SSP_ID_OCUPACION = sSSP_ID_OCUPACION
''              SGB_M4C_REG_COLA.SSP_ID_CONV_SS = sSSP_ID_CONV_SS
''              SGB_M4C_REG_COLA.SSP_NUM_PLURIEMPL = sSSP_NUM_PLURIEMPL
''              SGB_M4C_REG_COLA.SSP_ID_CONT_LEGAL = sSSP_ID_CONT_LEGAL
''              SGB_M4C_REG_COLA.CMX_ID_CONTRATO_INT = sCMX_ID_CONTRATO_INT
''              SGB_M4C_REG_COLA.SSP_FEC_FIN_CONTRA = sSSP_FEC_FIN_CONTRA
''              SGB_M4C_REG_COLA.SSP_ID_REL_LAB = sSSP_ID_REL_LAB
''              SGB_M4C_REG_COLA.SSP_VALOR_COEF_T_P = sSSP_VALOR_COEF_T_P
''              SGB_M4C_REG_COLA.SSP_TIPO_HORAS = sSSP_TIPO_HORAS
''              SGB_M4C_REG_COLA.SSP_NUM_HORAS = sSSP_NUM_HORAS
''              SGB_M4C_REG_COLA.SSP_JP_REG_IRREG = sSSP_JP_REG_IRREG
''              SGB_M4C_REG_COLA.SSP_NUM_DIAS_JP = sSSP_NUM_DIAS_JP
''              SGB_M4C_REG_COLA.SSP_PORC_GLEGAL = sSSP_PORC_GLEGAL
''              SGB_M4C_REG_COLA.SSP_ID_MOTIV_REDUC = sSSP_ID_MOTIV_REDUC
''              SGB_M4C_REG_COLA.SSP_ID_CAUSA_SUST = sSSP_ID_CAUSA_SUST
''              SGB_M4C_REG_COLA.SSP_NSS_SUST_PROV = sSSP_NSS_SUST_PROV
''              SGB_M4C_REG_COLA.SSP_NUSS_SUST = sSSP_NUSS_SUST
''              SGB_M4C_REG_COLA.SSP_NSS_SUST_DC = sSSP_NSS_SUST_DC
''              SGB_M4C_REG_COLA.SSP_PORC_MINUSVAL = sSSP_PORC_MINUSVAL
''              SGB_M4C_REG_COLA.SSP_FEC_INI_A_CONT = sSSP_FEC_INI_A_CONT
''              SGB_M4C_REG_COLA.SSP_MUJER_24 = sSSP_MUJER_24
''              SGB_M4C_REG_COLA.SSP_MUJER_SUBREPR = sSSP_MUJER_SUBREPR
''              SGB_M4C_REG_COLA.SSP_DIAS_PRUEBA = sSSP_DIAS_PRUEBA
''              SGB_M4C_REG_COLA.SSP_CLAUSULA_ADIC = sSSP_CLAUSULA_ADIC
''              SGB_M4C_REG_COLA.SCO_ID_TYPE_ADJUST = sSCO_ID_TYPE_ADJUST
''              SGB_M4C_REG_COLA.CMX_ID_CONVENIO = sCMX_ID_CONVENIO
''              SGB_M4C_REG_COLA.CMX_ID_CATEGORIA = sCMX_ID_CATEGORIA
''              SGB_M4C_REG_COLA.SSP_BRUTO_ANUAL = sSSP_BRUTO_ANUAL
''              SGB_M4C_REG_COLA.CMX_ID_TP_SALARIO = sCMX_ID_TP_SALARIO
''              SGB_M4C_REG_COLA.SSP_FEC_ANTIGUEDAD = sSSP_FEC_ANTIGUEDAD
''              SGB_M4C_REG_COLA.SSP_FEC_EXTRAS = sSSP_FEC_EXTRAS
''              SGB_M4C_REG_COLA.SGB_ID_SINDICATO = sSGB_ID_SINDICATO
''              SGB_M4C_REG_COLA.SSP_ID_TP_IRPF = sSSP_ID_TP_IRPF
''              SGB_M4C_REG_COLA.SSP_ID_EST_IRPF = sSSP_ID_EST_IRPF
''              SGB_M4C_REG_COLA.SSP_ID_MINUSVALIA = sSSP_ID_MINUSVALIA
''              SGB_M4C_REG_COLA.SSP_ID_CENTRO_FIS = sSSP_ID_CENTRO_FIS
''              SGB_M4C_REG_COLA.CMX_FORMA_DE_PAGO = sCMX_FORMA_DE_PAGO
''              SGB_M4C_REG_COLA.SCO_ID_COMP_BANK = sSCO_ID_COMP_BANK
''              SGB_M4C_REG_COLA.COMP_BANC_SUC = sCOMP_BANC_SUC
''              SGB_M4C_REG_COLA.SCO_ACCOUNT_NUMBER = sSCO_ACCOUNT_NUMBER
''              SGB_M4C_REG_COLA.SSP_DC = sSSP_DC
''              SGB_M4C_REG_COLA.SSP_ID_TP_PRODUCTOR = sSSP_ID_TP_PRODUCTOR
''              SGB_M4C_REG_COLA.SSP_ID_TP_ACTIVIDAD = sSSP_ID_TP_ACTIVIDAD
'
''              SGB_M4C_REG_COLA_INF.AddRegister()
''              SGB_M4C_REG_COLA_INF.ID_ARCHIVO = sIDArchivoInf
''              SGB_M4C_REG_COLA_INF.USUARIO = "TB"
''              SGB_M4C_REG_COLA_INF.ID = SGB_M4C_MOVS_NOM_GEN.STD_ID_HR
''              SGB_M4C_REG_COLA_INF.ORGANIZATIONID = SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT
''              SGB_M4C_REG_COLA_INF.PARENTID = SGB_M4C_CALC_DEPTO(SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC, dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT)
''              SGB_M4C_REG_COLA_INF.NAME = SGB_M4C_MOVS_NOM_GEN.STD_N_FIRST_NAME
''              SGB_M4C_REG_COLA_INF.PATERNALSURNAME = SGB_M4C_MOVS_NOM_GEN.SSP_PRIMER_APELLIDO
''              SGB_M4C_REG_COLA_INF.MATERNALSURNAME = SGB_M4C_MOVS_NOM_GEN.STD_N_MAIDEN_NAME
''              SGB_M4C_REG_COLA_INF.BIRTHDATE = FORMAT_YYYY_MM_DD(SGB_M4C_MOVS_NOM_GEN.CMX_DT_BIRTH)
''              SGB_M4C_REG_COLA_INF.SEX = ToString((ToInt(SGB_M4C_MOVS_NOM_GEN.STD_ID_GENDER) - 1),0 ) '0 = Masculino, 1 = Femenino
''              SGB_M4C_REG_COLA_INF.NIN = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_SS
''              SGB_M4C_REG_COLA_INF.EMAIL = SGB_M4C_MOVS_NOM_GEN.CMX_EMAIL
''              SGB_M4C_REG_COLA_INF.ORGANIZATION = SGB_M4C_CALC_EMPRESA(SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT, dFechaHoraIni)
''              SGB_M4C_REG_COLA_INF.DEPARTMENT = SGB_M4C_CALC_WLOCAT(SGB_M4C_CALC_DEPTO(SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC, dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT),  dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT) 'Obtiene el nombre del WLOC pasado por par¿metro
''              SGB_M4C_REG_COLA_INF.CATEGORY = SGB_M4C_CALC_CATEG(SGB_M4C_MOVS_NOM_GEN.SSP_ID_CATEGORIA)
''              SGB_M4C_REG_COLA_INF.POSICION = SGB_M4C_CALC_POSICION(SGB_M4C_MOVS_NOM_GEN.STD_ID_HR, dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT)
''              SGB_M4C_REG_COLA_INF.COSTCENTER = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CENT_COSTO
''              SGB_M4C_REG_COLA_INF.PAYROLL = "3"
''              SGB_M4C_REG_COLA_INF.OTHER1 = SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC
''              SGB_M4C_REG_COLA_INF.OTHER2 = SGB_M4C_CALC_WLOCAT(SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC,  dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT) 'Obtiene el nombre del WLOC pasado por par¿metro
''              SGB_M4C_REG_COLA_INF.OTHER3 = SGB_M4C_CALC_TIPO_EMP("0005", SGB_M4C_MOVS_NOM_GEN.STD_ID_HR_TYPE)
''              SGB_M4C_REG_COLA_INF.ACTIVE = "1"
''              SGB_M4C_REG_COLA_INF.INTERNAL = "1"
''              SGB_M4C_REG_COLA_INF.CRC = "0"
''              SGB_M4C_REG_COLA_INF.STARTDATE = FORMAT_YYYY_MM_DD(SGB_M4C_MOVS_NOM_GEN.CMX_DATE)
''              SGB_M4C_REG_COLA_INF.DATE1 = FORMAT_YYYY_MM_DD(SGB_M4C_MOVS_NOM_GEN.SSP_FEC_ANTIGUEDAD)
''              SGB_M4C_REG_COLA_INF.DATE2 = NullValue()
''              SGB_M4C_REG_COLA_INF.NIF = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_DOC
'
''              If SGB_M4C_REG_COLA.Persist_tree() <> M4_ERROR Then
''                'Deltas registrados
''                SetLog(M4_DEBUGINFOLOG, 60, 4, 400, "Deltas registrados " + ToString(TodayNow()))
'
''                SGB_M4C_REG_COLA_INF.Persist_tree()
''                'Deltas Infoblock registrados
''                SetLog(M4_DEBUGINFOLOG, 60, 4, 400, "Deltas Infoblock registrados " + ToString(TodayNow()))
'
''                SRGB_M4C_DATOS_ENVIADOS.AddRegister()
''                SRGB_M4C_DATOS_ENVIADOS.ID_ORGANIZATION = "0005"
''                SRGB_M4C_DATOS_ENVIADOS.CMX_TP_MOVIMIENTO = sCMX_TP_MOVIMIENTO
''                SRGB_M4C_DATOS_ENVIADOS.CMX_DATE = sCMX_DATE
''                'FECHA_BAJA = sFECHA_BAJA
''                SRGB_M4C_DATOS_ENVIADOS.STD_ID_HRP_END_REASON = sSTD_ID_HRP_END_REASON
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CAUSA_DESEM = sSSP_ID_CAUSA_DESEM
''                SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_VACAC = sSSP_FEC_FIN_VACAC
''                SRGB_M4C_DATOS_ENVIADOS.STD_ID_HR = sSTD_ID_HR 'Llave primaria
''                SRGB_M4C_DATOS_ENVIADOS.SSP_PRIMER_APELLIDO = sSSP_PRIMER_APELLIDO
''                SRGB_M4C_DATOS_ENVIADOS.STD_N_MAIDEN_NAME = sSTD_N_MAIDEN_NAME
''                SRGB_M4C_DATOS_ENVIADOS.STD_N_FIRST_NAME = sSTD_N_FIRST_NAME
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_TP_DOC = sCMX_ID_TP_DOC
''                SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_DOC = sSSP_NUM_DOC
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_PAIS_EMISOR = sSSP_ID_PAIS_EMISOR
''                SRGB_M4C_DATOS_ENVIADOS.CMX_DT_BIRTH = sCMX_DT_BIRTH
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_NACIONALITY = sCMX_ID_NACIONALITY
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_COUNTRY = sCMX_ID_COUNTRY
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_SUB_GEO_DIV_ADD = sCMX_ID_SUB_GEO_DIV_ADD
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_GEO_DIV_ADD = sCMX_ID_GEO_DIV_ADD
''                SRGB_M4C_DATOS_ENVIADOS.STD_ID_GENDER = sSTD_ID_GENDER
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_MAR_STAT = sCMX_ID_MAR_STAT
''                SRGB_M4C_DATOS_ENVIADOS.CMX_PHONE = sCMX_PHONE
''                'TEL_MOV = sTEL_MOV
''                SRGB_M4C_DATOS_ENVIADOS.CMX_EMAIL = sCMX_EMAIL
''                SRGB_M4C_DATOS_ENVIADOS.STD_ID_LOCATION_TYPE = sSTD_ID_LOCATION_TYPE
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_SIGLA_DOMIC = sCMX_ID_SIGLA_DOMIC
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ADDRESS_LINE_1 = sCMX_ADDRESS_LINE_1
''                SRGB_M4C_DATOS_ENVIADOS.CMX_NUM_VIA = sCMX_NUM_VIA
''                SRGB_M4C_DATOS_ENVIADOS.SSP_BLOQUE = sSSP_BLOQUE
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ESCALERA = sSSP_ESCALERA
''                SRGB_M4C_DATOS_ENVIADOS.SSP_PISO = sSSP_PISO
''                SRGB_M4C_DATOS_ENVIADOS.SSP_PUERTA = sSSP_PUERTA
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_GEO_PLACE = sCMX_ID_GEO_PLACE
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_SUB_GEO_DIV = sCMX_ID_SUB_GEO_DIV
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_GEO_DIV = sCMX_ID_GEO_DIV
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_COUNTRY_ADD = sCMX_ID_COUNTRY_ADD
''                SRGB_M4C_DATOS_ENVIADOS.CMX_DISTRIT_POSTAL = sCMX_DISTRIT_POSTAL
''                SRGB_M4C_DATOS_ENVIADOS.SCO_ID_LEG_ENT = sSCO_ID_LEG_ENT
''                SRGB_M4C_DATOS_ENVIADOS.SCO_ID_JOB_CODE = sSCO_ID_JOB_CODE
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_WORK_UNIT = sCMX_ID_WORK_UNIT
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_WORK_LOC = sCMX_ID_WORK_LOC
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CENT_COSTO = sSSP_ID_CENT_COSTO
''                SRGB_M4C_DATOS_ENVIADOS.STD_ID_HRP_START_REASON = sSTD_ID_HRP_START_REASON
''                SRGB_M4C_DATOS_ENVIADOS.STD_ID_HR_TYPE = sSTD_ID_HR_TYPE
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_GESTION = sSSP_ID_TP_GESTION
''                SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_PR_PRU = sSSP_FEC_FIN_PR_PRU
''                SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_PV_CON = sSSP_FEC_FIN_PV_CON
''                SRGB_M4C_DATOS_ENVIADOS.SCO_ID_DURATION = sSCO_ID_DURATION
''                SRGB_M4C_DATOS_ENVIADOS.SSP_CON_NUM_SS = sSSP_CON_NUM_SS
''                SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_SS = sSSP_PROV_NUM_SS + "-" + sSSP_NUM_SS + "-" + sSSP_DIG_NUM_SS
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CABEC_TC1 = sSSP_ID_CABEC_TC1
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_GRUP_TARIFA = sSSP_ID_GRUP_TARIFA
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_OCUPACION = sSSP_ID_OCUPACION
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CONV_SS = sSSP_ID_CONV_SS
''                SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_PLURIEMPL = sSSP_NUM_PLURIEMPL
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CONT_LEGAL = sSSP_ID_CONT_LEGAL
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_CONTRATO_INT = sCMX_ID_CONTRATO_INT
''                SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_CONTRA = sSSP_FEC_FIN_CONTRA
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_REL_LAB = sSSP_ID_REL_LAB
''                SRGB_M4C_DATOS_ENVIADOS.SSP_VALOR_COEF_T_P = sSSP_VALOR_COEF_T_P
''                SRGB_M4C_DATOS_ENVIADOS.SSP_TIPO_HORAS = sSSP_TIPO_HORAS
''                SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_HORAS = sSSP_NUM_HORAS
''                SRGB_M4C_DATOS_ENVIADOS.SSP_JP_REG_IRREG = sSSP_JP_REG_IRREG
''                SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_DIAS_JP = sSSP_NUM_DIAS_JP
''                SRGB_M4C_DATOS_ENVIADOS.SSP_PORC_GLEGAL = sSSP_PORC_GLEGAL
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_MOTIV_REDUC = sSSP_ID_MOTIV_REDUC
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CAUSA_SUST = sSSP_ID_CAUSA_SUST
''                SRGB_M4C_DATOS_ENVIADOS.SSP_NUSS_SUST = sSSP_NSS_SUST_PROV + sSSP_NUSS_SUST + sSSP_NSS_SUST_DC
''                SRGB_M4C_DATOS_ENVIADOS.SSP_PORC_MINUSVAL = sSSP_PORC_MINUSVAL
''                SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_INI_A_CONT = sSSP_FEC_INI_A_CONT
''                SRGB_M4C_DATOS_ENVIADOS.SSP_MUJER_24 = sSSP_MUJER_24
''                SRGB_M4C_DATOS_ENVIADOS.SSP_MUJER_SUBREPR = sSSP_MUJER_SUBREPR
''                SRGB_M4C_DATOS_ENVIADOS.SSP_DIAS_PRUEBA = sSSP_DIAS_PRUEBA
''                SRGB_M4C_DATOS_ENVIADOS.SSP_CLAUSULA_ADIC = sSSP_CLAUSULA_ADIC
''                SRGB_M4C_DATOS_ENVIADOS.SCO_ID_TYPE_ADJUST = sSCO_ID_TYPE_ADJUST
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_CONVENIO = sCMX_ID_CONVENIO
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_CATEGORIA = sCMX_ID_CATEGORIA
''                SRGB_M4C_DATOS_ENVIADOS.SSP_BRUTO_ANUAL = sSSP_BRUTO_ANUAL
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_TP_SALARIO = sCMX_ID_TP_SALARIO
''                SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_ANTIGUEDAD = sSSP_FEC_ANTIGUEDAD
''                SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_EXTRAS = sSSP_FEC_EXTRAS
''                SRGB_M4C_DATOS_ENVIADOS.SGB_ID_SINDICATO = sSGB_ID_SINDICATO
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_IRPF = sSSP_ID_TP_IRPF
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_EST_IRPF = sSSP_ID_EST_IRPF
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_MINUSVALIA = sSSP_ID_MINUSVALIA
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CENTRO_FISICO = sSSP_ID_CENTRO_FIS
''                SRGB_M4C_DATOS_ENVIADOS.CMX_FORMA_DE_PAGO = sCMX_FORMA_DE_PAGO
''                SRGB_M4C_DATOS_ENVIADOS.SCO_ID_COMP_BANK = sSCO_ID_COMP_BANK
''                'COMP_BANC_SUC = sCOMP_BANC_SUC
''                SRGB_M4C_DATOS_ENVIADOS.SCO_ID_BANK_CODE = Mid(sCOMP_BANC_SUC, 0, 4)
''                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_BANK_BRANCH = Mid(sCOMP_BANC_SUC, 4, 8)
''                SRGB_M4C_DATOS_ENVIADOS.SCO_ACCOUNT_NUMBER = sSCO_ACCOUNT_NUMBER
''                SRGB_M4C_DATOS_ENVIADOS.SSP_DC = sSSP_DC
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_PRODUCTOR = sSSP_ID_TP_PRODUCTOR
''                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_ACTIVIDAD = sSSP_ID_TP_ACTIVIDAD
'
''                SRGB_M4C_DATOS_ENVIADOS.Persist_tree()
'
''                'Se realizó la actualización de los Deltas de los empleados en la tabla de Datos Enviados
''                SetLog(M4_DEBUGINFOLOG,60,4,400,"Se realizó la actualización de los Deltas de los empleados en la tabla de Datos Enviados " + ToString(TodayNow(),0))
''              EndIf
'
''            EndIf
'
        'EndIf
'
        'If sTipoMov = "B" Or sTipoMov = "A" Or sTipoMov = "R" Then
            'SGB_M4C_MOVS_NOM_GEN.SGB_PROCESADO_SAAS = "1"
        'EndIf
      'Next
'
      ''Actualiza el estado de los registros a PROCESADO
      'SGB_M4C_MOVS_NOM_GEN.Persist_tree()
'
      ''Registrando archivo en la Bitacora
      'SGB_M4C_REG_BIT_ARC(sIDArchivo, iGenerado)
'
      ''Registrando archivo en la Bitacora
      'SGB_M4C_REG_BIT_ARC(sIDArchivoInf, iGenerado)
'
    'Else
      ''No existen movimientos a procesar en el Envio
      'SetLog(M4_DEBUGINFOLOG, 60, 4, 400, "No existen movimientos a procesar en el Envio " + sIDEnvio + " " + ToString(TodayNow(), 0))
    'EndIf
'
  'Else
    ''No fue posible registrar el archivo " + sIDArchivo + " en el Envio " + sIDEnvio
    'SetLog(M4_ERRORLOG, 60, 4, 400, "No fue posible registrar el archivo " + sIDArchivo + " en el Envio " + sIDEnvio + " " + ToString(TodayNow(), 0))
  'EndIf
'
'Else
  ''No fue posible generar el registro en la tabla archivo
  'SetLog(M4_ERRORLOG, 60, 4, 400, "No fue posible generar el registro en la tabla archivo " + ToString(TodayNow(), 0))
'EndIf


'NUEVO CODIGO

'SGB_M4C_REG_COLA(sIDFileColabs, sIDEnvio)
'Realiza el registro del contenido del archivo de Colaboradores.

sIDArchivo = SGB_ARG_ID_ARCHIVO
sIDArchivoInf = SGB_ARG_ID_ARCHIVO_INF
iIDEnvio = ToInt(SGB_ARG_ID_ENVIO)
sIDEnvio = ToString(SGB_ARG_ID_ENVIO, 0)
sIDOrganizacion = "0005"
sIDTipoColaboradores = 1
sIDTipoColabsInf = 4
iGenerado = 1

iEstadoEnProceso = 2
iEdoExitoso = 3
iEdoError = 4

dFechaHoraIni = ToDayNow()

SGB_M4C_ARCHIVO.AddRegister()
SGB_M4C_ARCHIVO.ID_ARCHIVO = sIDArchivo
SGB_M4C_ARCHIVO.ID_TIPO = sIDTipoColaboradores

SetLog(M4_DEBUGINFOLOG, 60, 4, 400,"Se ha creado el registro del archivo de Colaboradores " + ToString(TodayNow(), 0))

'Creando el registro del Archivo Infoblock
SGB_M4C_ARCHIVO.AddRegister()
SGB_M4C_ARCHIVO.ID_ARCHIVO = sIDArchivoInf
SGB_M4C_ARCHIVO.ID_TIPO = sIDTipoColabsInf

SetLog(M4_DEBUGINFOLOG, 60, 4, 400,"Se ha creado el registro del archivo de Colaboradores Infoblock " + ToString(TodayNow(), 0))

If SGB_M4C_ARCHIVO.Persist_tree() <> M4_ERROR Then
  'Registrando el Archivo en el Env¿o
  SGB_M4C_ENVIO_AR.AddRegister()
  SGB_M4C_ENVIO_AR.ID_ENVIO = SGB_ARG_ID_ENVIO
  SGB_M4C_ENVIO_AR.ID_ARCHIVO = sIDArchivo

  'Registrando el Archivo Infoblock en el Env¿o
  SGB_M4C_ENVIO_AR.AddRegister()
  SGB_M4C_ENVIO_AR.ID_ENVIO = SGB_ARG_ID_ENVIO
  SGB_M4C_ENVIO_AR.ID_ARCHIVO = sIDArchivoInf

  If SGB_M4C_ENVIO_AR.Persist_tree() <> M4_ERROR Then
    'Se deben registrar Bajas, Altas y Cambios
    sFlagAlta = "1"
    sFlagBaja = "2"
    sFlagCambio = "3"

    sFlagAltaInf = "A"
    sFlagBajaInf = "B"
    sFlagCambioInf = "C"

    'Filtrando Nomina Gen con los movimientos no procesados por la interfaz.
    SetLog(M4_DEBUGINFOLOG, 60, 4, 400, "Filtrando Nomina Gen con los movimientos no procesados por la interfaz " + sIDEnvio + ToString(TodayNow()))
    SGB_M4C_MOVS_NOM_GEN.DESTROYBLOCK()
    SGB_M4C_MOVS_NOM_GEN.SGB_PR_ID_ORG = sIDOrganizacion
    sSql = "FROM &CMX_NOMINA_GENERAL A "
    sSql = sSql + "WHERE (A.ID_ORGANIZATION = @SGB_PR_ID_ORG "
    sSql = sSql + "And A.SGB_PROCESADO_SAAS = 0 "
    sSql = sSql + "And (A.STD_ID_HR_TYPE = '01' Or A.STD_ID_HR_TYPE = '08') ) "
    sSql = sSql + "ORDER BY A.STD_ID_HR ASC, A.CMX_ORDINAL ASC "
    SGB_M4C_MOVS_NOM_GEN.FILTRO_SELECT = sSql
    SGB_M4C_MOVS_NOM_GEN.Load_Blk()

    iRegSGB_M4C_MOVS_NOM_GEN = SGB_M4C_MOVS_NOM_GEN.Count()
    If iRegSGB_M4C_MOVS_NOM_GEN > 0 Then
      For i = 0 To iRegSGB_M4C_MOVS_NOM_GEN - 1
        SGB_M4C_MOVS_NOM_GEN.MoveTo(i)
        sSTD_ID_HR = SGB_M4C_MOVS_NOM_GEN.STD_ID_HR
        sTipoMov = SGB_M4C_MOVS_NOM_GEN.CMX_TP_MOVIMIENTO

        If sTipoMov = "B" Then
            'Se registran directamente todas las Bajas ya que se eliminan colaboradores
            SGB_M4C_REG_COLA.AddRegister()
            SGB_M4C_REG_COLA.ID_ARCHIVO = sIDArchivo
            SGB_M4C_REG_COLA.CMX_TP_MOVIMIENTO = sFlagBaja
            SGB_M4C_REG_COLA.CMX_DATE = SGB_M4C_MOVS_NOM_GEN.CMX_DATE
            SGB_M4C_REG_COLA.FECHA_BAJA = SGB_M4C_MOVS_NOM_GEN.CMX_DATE
            SGB_M4C_REG_COLA.STD_ID_HRP_END_REASON = SGB_M4C_MOVS_NOM_GEN.STD_ID_HRP_END_REASON
            SGB_M4C_REG_COLA.SSP_ID_CAUSA_DESEM = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CAUSA_DESEM
            SGB_M4C_REG_COLA.SSP_FEC_FIN_VACAC = SGB_M4C_MOVS_NOM_GEN.SSP_FEC_FIN_VACAC
            SGB_M4C_REG_COLA.STD_ID_HR = sSTD_ID_HR
            SGB_M4C_REG_COLA.SSP_PRIMER_APELLIDO = NullValue()
            SGB_M4C_REG_COLA.STD_N_MAIDEN_NAME = NullValue()
            SGB_M4C_REG_COLA.STD_N_FIRST_NAME = NullValue()
            SGB_M4C_REG_COLA.CMX_ID_TP_DOC = NullValue()
            SGB_M4C_REG_COLA.SSP_NUM_DOC = NullValue()
            SGB_M4C_REG_COLA.SSP_ID_PAIS_EMISOR = NullValue()
            SGB_M4C_REG_COLA.CMX_DT_BIRTH = NullValue()
            SGB_M4C_REG_COLA.CMX_ID_NACIONALITY = NullValue()
            SGB_M4C_REG_COLA.CMX_ID_COUNTRY = NullValue()
            SGB_M4C_REG_COLA.CMX_ID_SUB_GEO_DIV_ADD = NullValue()
            SGB_M4C_REG_COLA.CMX_ID_GEO_DIV_ADD = NullValue()
            SGB_M4C_REG_COLA.STD_ID_GENDER = NullValue()
            SGB_M4C_REG_COLA.CMX_ID_MAR_STAT = NullValue()
            SGB_M4C_REG_COLA.CMX_PHONE = NullValue()
            SGB_M4C_REG_COLA.TEL_MOV = NullValue()
            SGB_M4C_REG_COLA.CMX_EMAIL = NullValue()
            SGB_M4C_REG_COLA.STD_ID_LOCATION_TYPE = NullValue()
            SGB_M4C_REG_COLA.CMX_ID_SIGLA_DOMIC = NullValue()
            SGB_M4C_REG_COLA.CMX_ADDRESS_LINE_1 = NullValue()
            SGB_M4C_REG_COLA.CMX_NUM_VIA = NullValue()
            SGB_M4C_REG_COLA.SSP_BLOQUE = NullValue()
            SGB_M4C_REG_COLA.SSP_ESCALERA = NullValue()
            SGB_M4C_REG_COLA.SSP_PISO = NullValue()
            SGB_M4C_REG_COLA.SSP_PUERTA = NullValue()
            SGB_M4C_REG_COLA.CMX_ID_GEO_PLACE = NullValue()
            SGB_M4C_REG_COLA.CMX_ID_SUB_GEO_DIV = NullValue()
            SGB_M4C_REG_COLA.CMX_ID_GEO_DIV = NullValue()
            SGB_M4C_REG_COLA.CMX_ID_COUNTRY_ADD = NullValue()
            SGB_M4C_REG_COLA.CMX_DISTRIT_POSTAL = NullValue()
            SGB_M4C_REG_COLA.SCO_ID_LEG_ENT = NullValue()
            SGB_M4C_REG_COLA.SCO_ID_JOB_CODE = NullValue()
            SGB_M4C_REG_COLA.CMX_ID_WORK_UNIT = NullValue()
            SGB_M4C_REG_COLA.CMX_ID_WORK_LOC = NullValue()
            SGB_M4C_REG_COLA.SSP_ID_CENT_COSTO = NullValue()
            SGB_M4C_REG_COLA.STD_ID_HRP_START_REASON = NullValue()
            SGB_M4C_REG_COLA.STD_ID_HR_TYPE = NullValue()
            SGB_M4C_REG_COLA.SSP_ID_TP_GESTION = NullValue()
            SGB_M4C_REG_COLA.SSP_FEC_FIN_PR_PRU = NullValue()
            SGB_M4C_REG_COLA.SSP_FEC_FIN_PV_CON = NullValue()
            SGB_M4C_REG_COLA.SCO_ID_DURATION = NullValue()
            SGB_M4C_REG_COLA.SSP_CON_NUM_SS = NullValue()
            SGB_M4C_REG_COLA.SSP_PROV_NUM_SS = NullValue()
            SGB_M4C_REG_COLA.SSP_NUM_SS = NullValue()
            SGB_M4C_REG_COLA.SSP_DIG_NUM_SS = NullValue()
            SGB_M4C_REG_COLA.SSP_ID_CABEC_TC1 = NullValue()
            SGB_M4C_REG_COLA.SSP_ID_GRUP_TARIFA = NullValue()
            SGB_M4C_REG_COLA.SSP_ID_OCUPACION = NullValue()
            SGB_M4C_REG_COLA.SSP_ID_CONV_SS = NullValue()
            SGB_M4C_REG_COLA.SSP_NUM_PLURIEMPL = NullValue()
            SGB_M4C_REG_COLA.SSP_ID_CONT_LEGAL = NullValue()
            SGB_M4C_REG_COLA.CMX_ID_CONTRATO_INT = NullValue()
            SGB_M4C_REG_COLA.SSP_FEC_FIN_CONTRA = NullValue()
            SGB_M4C_REG_COLA.SSP_ID_REL_LAB = NullValue()
            SGB_M4C_REG_COLA.SSP_VALOR_COEF_T_P = NullValue()
            SGB_M4C_REG_COLA.SSP_TIPO_HORAS = NullValue()
            SGB_M4C_REG_COLA.SSP_NUM_HORAS = NullValue()
            SGB_M4C_REG_COLA.SSP_JP_REG_IRREG = NullValue()
            SGB_M4C_REG_COLA.SSP_NUM_DIAS_JP = NullValue()
            SGB_M4C_REG_COLA.SSP_PORC_GLEGAL = NullValue()
            SGB_M4C_REG_COLA.SSP_ID_MOTIV_REDUC = NullValue()
            SGB_M4C_REG_COLA.SSP_ID_CAUSA_SUST = NullValue()
            SGB_M4C_REG_COLA.SSP_NSS_SUST_PROV = NullValue()
            SGB_M4C_REG_COLA.SSP_NUSS_SUST = NullValue()
            SGB_M4C_REG_COLA.SSP_NSS_SUST_DC = NullValue()
            SGB_M4C_REG_COLA.SSP_PORC_MINUSVAL = NullValue()
            SGB_M4C_REG_COLA.SSP_FEC_INI_A_CONT = NullValue()
            SGB_M4C_REG_COLA.SSP_MUJER_24 = NullValue()
            SGB_M4C_REG_COLA.SSP_MUJER_SUBREPR = NullValue()
            SGB_M4C_REG_COLA.SSP_DIAS_PRUEBA = NullValue()
            SGB_M4C_REG_COLA.SSP_CLAUSULA_ADIC = NullValue()
            SGB_M4C_REG_COLA.SCO_ID_TYPE_ADJUST = NullValue()
            SGB_M4C_REG_COLA.CMX_ID_CONVENIO = NullValue()
            SGB_M4C_REG_COLA.CMX_ID_CATEGORIA = NullValue()
            SGB_M4C_REG_COLA.SSP_BRUTO_ANUAL = NullValue()
            SGB_M4C_REG_COLA.CMX_ID_TP_SALARIO = NullValue()
            SGB_M4C_REG_COLA.SSP_FEC_ANTIGUEDAD = NullValue()
            SGB_M4C_REG_COLA.SSP_FEC_EXTRAS = NullValue()
            SGB_M4C_REG_COLA.SGB_ID_SINDICATO = NullValue()
            SGB_M4C_REG_COLA.SSP_ID_TP_IRPF = NullValue()
            SGB_M4C_REG_COLA.SSP_ID_EST_IRPF = NullValue()
            SGB_M4C_REG_COLA.SSP_ID_MINUSVALIA = NullValue()
            SGB_M4C_REG_COLA.SSP_ID_CENTRO_FIS = NullValue() 'Se habilita en TRADES
            SGB_M4C_REG_COLA.CMX_FORMA_DE_PAGO = NullValue()
            SGB_M4C_REG_COLA.SCO_ID_COMP_BANK = NullValue()
            SGB_M4C_REG_COLA.COMP_BANC_SUC = NullValue()
            SGB_M4C_REG_COLA.SCO_ACCOUNT_NUMBER = NullValue()
            SGB_M4C_REG_COLA.SSP_DC = NullValue()
            SGB_M4C_REG_COLA.SSP_ID_TP_PRODUCTOR = NullValue()
            SGB_M4C_REG_COLA.SSP_ID_TP_ACTIVIDAD = NullValue()

            'Registrando las Bajas para Infoblock
            SGB_M4C_REG_COLA_INF.AddRegister()
            SGB_M4C_REG_COLA_INF.ID_ARCHIVO = sIDArchivoInf
            SGB_M4C_REG_COLA_INF.USUARIO = "TB"
            SGB_M4C_REG_COLA_INF.ID = sSTD_ID_HR
            SGB_M4C_REG_COLA_INF.ORGANIZATIONID = SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT
            SGB_M4C_REG_COLA_INF.PARENTID = SGB_M4C_CALC_DEPTO(SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC, dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT)
            SGB_M4C_REG_COLA_INF.NAME = SGB_M4C_MOVS_NOM_GEN.STD_N_FIRST_NAME
            SGB_M4C_REG_COLA_INF.PATERNALSURNAME = SGB_M4C_MOVS_NOM_GEN.SSP_PRIMER_APELLIDO
            SGB_M4C_REG_COLA_INF.MATERNALSURNAME = SGB_M4C_MOVS_NOM_GEN.STD_N_MAIDEN_NAME
            SGB_M4C_REG_COLA_INF.BIRTHDATE = FORMAT_YYYY_MM_DD(SGB_M4C_MOVS_NOM_GEN.CMX_DT_BIRTH)
            SGB_M4C_REG_COLA_INF.SEX = ToString((ToInt(SGB_M4C_MOVS_NOM_GEN.STD_ID_GENDER) - 1),0 ) '0 = Masculino, 1 = Femenino
            SGB_M4C_REG_COLA_INF.NIN = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_SS
            SGB_M4C_REG_COLA_INF.EMAIL = SGB_M4C_MOVS_NOM_GEN.CMX_EMAIL
            SGB_M4C_REG_COLA_INF.ORGANIZATION = SGB_M4C_CALC_EMPRESA(SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT, dFechaHoraIni)
            SGB_M4C_REG_COLA_INF.DEPARTMENT = SGB_M4C_CALC_WLOCAT(SGB_M4C_CALC_DEPTO(SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC, dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT),  dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT) 'Obtiene el nombre del WLOC pasado por par¿metro
            SGB_M4C_REG_COLA_INF.CATEGORY = SGB_M4C_CALC_CATEG(SGB_M4C_MOVS_NOM_GEN.SSP_ID_CATEGORIA)
            SGB_M4C_REG_COLA_INF.POSICION = SGB_M4C_CALC_POSICION(SGB_M4C_MOVS_NOM_GEN.STD_ID_HR, dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT)
            SGB_M4C_REG_COLA_INF.COSTCENTER = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CENT_COSTO
            SGB_M4C_REG_COLA_INF.PAYROLL = "3"
            SGB_M4C_REG_COLA_INF.OTHER1 = SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC
            SGB_M4C_REG_COLA_INF.OTHER2 = SGB_M4C_CALC_WLOCAT(SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC,  dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT) 'Obtiene el nombre del WLOC pasado por par¿metro
            SGB_M4C_REG_COLA_INF.OTHER3 = SGB_M4C_CALC_TIPO_EMP("0005", SGB_M4C_MOVS_NOM_GEN.STD_ID_HR_TYPE)
            SGB_M4C_REG_COLA_INF.ACTIVE = "0"
            SGB_M4C_REG_COLA_INF.INTERNAL = "1"
            SGB_M4C_REG_COLA_INF.CRC = sFlagBajaInf
            SGB_M4C_REG_COLA_INF.STARTDATE = FORMAT_YYYY_MM_DD(SGB_M4C_MOVS_NOM_GEN.STD_DT_START)
            SGB_M4C_REG_COLA_INF.DATE1 = FORMAT_YYYY_MM_DD(SGB_M4C_MOVS_NOM_GEN.SSP_FEC_ANTIGUEDAD)
            SGB_M4C_REG_COLA_INF.DATE2 = FORMAT_YYYY_MM_DD(SGB_M4C_MOVS_NOM_GEN.CMX_DATE)
            SGB_M4C_REG_COLA_INF.NIF = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_DOC
            'SGB_M4C_REG_COLA_INF.FLAG = sFlagBajaInf

            If SGB_M4C_REG_COLA.Persist_tree() <> M4_ERROR Then
              'Bajas registradas
              SetLog(M4_DEBUGINFOLOG, 60, 4, 400, "Bajas registradas " + ToString(TodayNow()))

              'Se realiza el borrado del colaborador que curso baja en la tabla de datos enviados
              SRGB_M4C_DATOS_ENVIADOS.DESTROYBLOCK()
              sSql = "FROM &SGB_M4C_DATOS_ENVIADOS A "
              sSql = sSql + "WHERE A.STD_ID_HR = '" + sSTD_ID_HR + "' "
              SRGB_M4C_DATOS_ENVIADOS.FILTRO_SELECT = sSql
              SRGB_M4C_DATOS_ENVIADOS.Load_Blk()

              iRegSRGB_M4C_DATOS_ENVIADOS = SRGB_M4C_DATOS_ENVIADOS.Count()
              If iRegSRGB_M4C_DATOS_ENVIADOS > 0 Then
                SRGB_M4C_DATOS_ENVIADOS.Begin()
                SRGB_M4C_DATOS_ENVIADOS.DeleteRegister()
                SRGB_M4C_DATOS_ENVIADOS.Persist_tree()
                'Se realizó el borrado de los empleados que curso baja en la tabla de Datos Enviados
                SetLog(M4_DEBUGINFOLOG,60,4,400,"Se realizó el borrado del colaborador que curso baja (" + sSTD_ID_HR + ")  en la tabla de Datos Enviados " + ToString(TodayNow(),0))
              EndIf

            EndIf

            SGB_M4C_REG_COLA_INF.Persist_tree()
            'Bajas Infoblock registradas
            SetLog(M4_DEBUGINFOLOG, 60, 4, 400, "Bajas Infoblock registradas " + ToString(TodayNow()))

        ElseIf sTipoMov = "A" Or sTipoMov = "R" Then
            'Se registran directamente todas las Altas ya que son nuevos colaboradores
            SGB_M4C_REG_COLA.AddRegister()
            SGB_M4C_REG_COLA.ID_ARCHIVO = sIDArchivo
            SGB_M4C_REG_COLA.CMX_TP_MOVIMIENTO = sFlagAlta
            SGB_M4C_REG_COLA.CMX_DATE = SGB_M4C_MOVS_NOM_GEN.CMX_DATE
            SGB_M4C_REG_COLA.FECHA_BAJA = NullValue()
            SGB_M4C_REG_COLA.STD_ID_HRP_END_REASON = NullValue()
            SGB_M4C_REG_COLA.SSP_ID_CAUSA_DESEM = NullValue()
            SGB_M4C_REG_COLA.SSP_FEC_FIN_VACAC = SGB_M4C_MOVS_NOM_GEN.SSP_FEC_FIN_VACAC
            SGB_M4C_REG_COLA.STD_ID_HR = sSTD_ID_HR
            SGB_M4C_REG_COLA.SSP_PRIMER_APELLIDO = SGB_M4C_MOVS_NOM_GEN.SSP_PRIMER_APELLIDO
            SGB_M4C_REG_COLA.STD_N_MAIDEN_NAME = SGB_M4C_MOVS_NOM_GEN.STD_N_MAIDEN_NAME
            SGB_M4C_REG_COLA.STD_N_FIRST_NAME = SGB_M4C_MOVS_NOM_GEN.STD_N_FIRST_NAME
            SGB_M4C_REG_COLA.CMX_ID_TP_DOC = SGB_M4C_MOVS_NOM_GEN.CMX_ID_TP_DOC
            SGB_M4C_REG_COLA.SSP_NUM_DOC = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_DOC
            SGB_M4C_REG_COLA.SSP_ID_PAIS_EMISOR = SGB_M4C_MOVS_NOM_GEN.SSP_ID_PAIS_EMISOR
            SGB_M4C_REG_COLA.CMX_DT_BIRTH = SGB_M4C_MOVS_NOM_GEN.CMX_DT_BIRTH
            SGB_M4C_REG_COLA.CMX_ID_NACIONALITY = SGB_M4C_MOVS_NOM_GEN.CMX_ID_NACIONALITY
            SGB_M4C_REG_COLA.CMX_ID_COUNTRY = SGB_M4C_MOVS_NOM_GEN.CMX_ID_COUNTRY
            SGB_M4C_REG_COLA.CMX_ID_SUB_GEO_DIV_ADD = SGB_M4C_MOVS_NOM_GEN.SSP_ID_SUB_GEO_DIV
            SGB_M4C_REG_COLA.CMX_ID_GEO_DIV_ADD = NullValue()
            SGB_M4C_REG_COLA.STD_ID_GENDER = SGB_M4C_MOVS_NOM_GEN.STD_ID_GENDER
            SGB_M4C_REG_COLA.CMX_ID_MAR_STAT = SGB_M4C_MOVS_NOM_GEN.CMX_ID_MAR_STAT
            SGB_M4C_REG_COLA.CMX_PHONE = SGB_M4C_MOVS_NOM_GEN.CMX_PHONE
            SGB_M4C_REG_COLA.TEL_MOV = SGB_M4C_MOVS_NOM_GEN.CMX_PHONE
            SGB_M4C_REG_COLA.CMX_EMAIL = SGB_M4C_MOVS_NOM_GEN.CMX_EMAIL
            SGB_M4C_REG_COLA.STD_ID_LOCATION_TYPE = "1"
            SGB_M4C_REG_COLA.CMX_ID_SIGLA_DOMIC = SGB_M4C_MOVS_NOM_GEN.CMX_ID_SIGLA_DOMIC
            SGB_M4C_REG_COLA.CMX_ADDRESS_LINE_1 = SGB_M4C_MOVS_NOM_GEN.CMX_ADDRESS_LINE_1
            SGB_M4C_REG_COLA.CMX_NUM_VIA = SGB_M4C_MOVS_NOM_GEN.CMX_NUM_VIA
            SGB_M4C_REG_COLA.SSP_BLOQUE = SGB_M4C_MOVS_NOM_GEN.SSP_BLOQUE
            SGB_M4C_REG_COLA.SSP_ESCALERA = SGB_M4C_MOVS_NOM_GEN.SSP_ESCALERA
            SGB_M4C_REG_COLA.SSP_PISO = SGB_M4C_MOVS_NOM_GEN.SSP_PISO
            SGB_M4C_REG_COLA.SSP_PUERTA = SGB_M4C_MOVS_NOM_GEN.SSP_PUERTA
            SGB_M4C_REG_COLA.CMX_ID_GEO_PLACE = SGB_M4C_MOVS_NOM_GEN.CMX_ID_GEO_PLACE
            SGB_M4C_REG_COLA.CMX_ID_SUB_GEO_DIV = SGB_M4C_MOVS_NOM_GEN.CMX_ID_SUB_GEO_DIV
            SGB_M4C_REG_COLA.CMX_ID_GEO_DIV = NullValue()
            SGB_M4C_REG_COLA.CMX_ID_COUNTRY_ADD = SGB_M4C_MOVS_NOM_GEN.CMX_ID_COUNTRY_ADD
            SGB_M4C_REG_COLA.CMX_DISTRIT_POSTAL = SGB_M4C_MOVS_NOM_GEN.CMX_DISTRIT_POSTAL
            SGB_M4C_REG_COLA.SCO_ID_LEG_ENT = SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT
            SGB_M4C_REG_COLA.SCO_ID_JOB_CODE = SGB_M4C_MOVS_NOM_GEN.SCO_ID_JOB_CODE
            SGB_M4C_REG_COLA.CMX_ID_WORK_UNIT = SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_UNIT
            'SGB_M4C_REG_COLA.CMX_ID_WORK_LOC = SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC
            SGB_M4C_REG_COLA.CMX_ID_WORK_LOC = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CENTRO_FISICO
            SGB_M4C_REG_COLA.SSP_ID_CENT_COSTO = SGB_M4C_MOVS_NOM_GEN.CALC_CENT_COST()
            SGB_M4C_REG_COLA.STD_ID_HRP_START_REASON = SGB_M4C_MOVS_NOM_GEN.STD_ID_HRP_START_REASON
            SGB_M4C_REG_COLA.STD_ID_HR_TYPE = SGB_M4C_MOVS_NOM_GEN.STD_ID_HR_TYPE
            SGB_M4C_REG_COLA.SSP_ID_TP_GESTION = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_GESTION
            SGB_M4C_REG_COLA.SSP_FEC_FIN_PR_PRU = NullValue()
            'SGB_M4C_REG_COLA.SSP_FEC_FIN_PV_CON = NullValue()
            SGB_M4C_REG_COLA.SSP_FEC_FIN_PV_CON = SGB_M4C_MOVS_NOM_GEN.SSP_FEC_FIN_PV_CON
            SGB_M4C_REG_COLA.SCO_ID_DURATION = NullValue()

            'Comprobando si cuenta con NSS
            SGB_M4C_REG_COLA.SSP_CON_NUM_SS = SGB_M4C_MOVS_NOM_GEN.SSP_CON_NUM_SS
            If SGB_M4C_MOVS_NOM_GEN.SSP_CON_NUM_SS = "1" Then 'S¿ cuenta con NSS
              SGB_M4C_REG_COLA.SSP_PROV_NUM_SS = SGB_M4C_MOVS_NOM_GEN.CALC_PROV_NUM_SS()
              SGB_M4C_REG_COLA.SSP_NUM_SS = SGB_M4C_MOVS_NOM_GEN.CALC_NUM_SS()
              SGB_M4C_REG_COLA.SSP_DIG_NUM_SS = SGB_M4C_MOVS_NOM_GEN.CALC_DIG_NUM_SS()
            Else 'No tiene NSS
              SGB_M4C_REG_COLA.SSP_CON_NUM_SS = "0"
              SGB_M4C_REG_COLA.SSP_PROV_NUM_SS = NullValue()
              SGB_M4C_REG_COLA.SSP_NUM_SS = NullValue()
              SGB_M4C_REG_COLA.SSP_DIG_NUM_SS = NullValue()
            EndIf

            SGB_M4C_REG_COLA.SSP_ID_CABEC_TC1 = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CABEC_TC1
            SGB_M4C_REG_COLA.SSP_ID_GRUP_TARIFA = SGB_M4C_MOVS_NOM_GEN.SSP_ID_GRUP_TARIFA
            SGB_M4C_REG_COLA.SSP_ID_OCUPACION = SGB_M4C_MOVS_NOM_GEN.SSP_ID_OCUPACION
            SGB_M4C_REG_COLA.SSP_ID_CONV_SS = NullValue()
            SGB_M4C_REG_COLA.SSP_NUM_PLURIEMPL = NullValue()
            SGB_M4C_REG_COLA.SSP_ID_CONT_LEGAL = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CONT_LEGAL
            SGB_M4C_REG_COLA.CMX_ID_CONTRATO_INT = SGB_M4C_MOVS_NOM_GEN.CMX_ID_CONTRATO_INT
            'SGB_M4C_REG_COLA.SSP_FEC_FIN_CONTRA = NullValue()
            SGB_M4C_REG_COLA.SSP_FEC_FIN_CONTRA = SGB_M4C_MOVS_NOM_GEN.SSP_FEC_FIN_CONTRA
            SGB_M4C_REG_COLA.SSP_ID_REL_LAB = NullValue()
            'Modificado por solicitud de Jordi Horta el 22 Enero 2019.
            'SGB_M4C_REG_COLA.SSP_VALOR_COEF_T_P = NullValue()
            'SGB_M4C_REG_COLA.SSP_TIPO_HORAS = NullValue()
            'SGB_M4C_REG_COLA.SSP_NUM_HORAS = NullValue()
            'SGB_M4C_REG_COLA.SSP_JP_REG_IRREG = NullValue()
            'SGB_M4C_REG_COLA.SSP_NUM_DIAS_JP = NullValue()
            SGB_M4C_REG_COLA.SSP_VALOR_COEF_T_P = SGB_M4C_MOVS_NOM_GEN.SSP_VALOR_COEF_T_P
            SGB_M4C_REG_COLA.SSP_TIPO_HORAS = SGB_M4C_MOVS_NOM_GEN.SSP_TIPO_HORAS
            SGB_M4C_REG_COLA.SSP_NUM_HORAS = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_HORAS
            SGB_M4C_REG_COLA.SSP_JP_REG_IRREG = SGB_M4C_MOVS_NOM_GEN.SSP_JP_REG_IRREG
            SGB_M4C_REG_COLA.SSP_NUM_DIAS_JP = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_DIAS_JP
            'Fin 22 Enero 2019.
            SGB_M4C_REG_COLA.SSP_PORC_GLEGAL = NullValue()
            SGB_M4C_REG_COLA.SSP_ID_MOTIV_REDUC = NullValue()
            'Se colaca un valor a solicitud de Jordi Horta el 21 Ene 2019.
            'SGB_M4C_REG_COLA.SSP_ID_CAUSA_SUST = NullValue()
            'SGB_M4C_REG_COLA.SSP_NSS_SUST_PROV = NullValue()
            'SGB_M4C_REG_COLA.SSP_NUSS_SUST = NullValue()
            'SGB_M4C_REG_COLA.SSP_NSS_SUST_DC = NullValue()
            SGB_M4C_REG_COLA.SSP_ID_CAUSA_SUST = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CAUSA_SUST
            SGB_M4C_REG_COLA.SSP_NSS_SUST_PROV = (Mid(SGB_M4C_MOVS_NOM_GEN.SSP_NUSS_SUST, 0, 2))'2
            SGB_M4C_REG_COLA.SSP_NUSS_SUST = (Mid(SGB_M4C_MOVS_NOM_GEN.SSP_NUSS_SUST, 2, 8)) '8
            SGB_M4C_REG_COLA.SSP_NSS_SUST_DC = (Mid(SGB_M4C_MOVS_NOM_GEN.SSP_NUSS_SUST, 10, 2)) '2
            'Fin 21 Jan 2019.
            SGB_M4C_REG_COLA.SSP_PORC_MINUSVAL = NullValue()
            SGB_M4C_REG_COLA.SSP_FEC_INI_A_CONT = NullValue()
            SGB_M4C_REG_COLA.SSP_MUJER_24 = NullValue()
            SGB_M4C_REG_COLA.SSP_MUJER_SUBREPR = NullValue()
            SGB_M4C_REG_COLA.SSP_DIAS_PRUEBA = NullValue()
            'SGB_M4C_REG_COLA.SSP_CLAUSULA_ADIC = SGB_M4C_MOVS_NOM_GEN.SSP_CLAUSULA_ADIC
            SGB_M4C_REG_COLA.SSP_CLAUSULA_ADIC = "SC" 'Se utiliza SC de forma directa de acuerdo a los comentarios de Alvaro Meta4
            SGB_M4C_REG_COLA.SCO_ID_TYPE_ADJUST = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TYPE_ADJUST
            SGB_M4C_REG_COLA.CMX_ID_CONVENIO = SGB_M4C_MOVS_NOM_GEN.CMX_ID_CONVENIO
           '' SGB_M4C_REG_COLA.CMX_ID_CATEGORIA = SGB_M4C_MOVS_NOM_GEN.CMX_ID_CATEGORIA
            SGB_M4C_REG_COLA.CMX_ID_CATEGORIA = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CATEGORIA
            If ToString(SGB_M4C_MOVS_NOM_GEN.SSP_BRUTO_ANUAL,0) = "1" Then
                SGB_M4C_REG_COLA.SSP_BRUTO_ANUAL = 0
            Else
                SGB_M4C_REG_COLA.SSP_BRUTO_ANUAL = SGB_M4C_MOVS_NOM_GEN.SSP_BRUTO_ANUAL
            EndIf
            SGB_M4C_REG_COLA.CMX_ID_TP_SALARIO = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_SALARIO
            SGB_M4C_REG_COLA.SSP_FEC_ANTIGUEDAD = SGB_M4C_MOVS_NOM_GEN.SSP_FEC_ANTIGUEDAD
            SGB_M4C_REG_COLA.SSP_FEC_EXTRAS = NullValue()
            SGB_M4C_REG_COLA.SGB_ID_SINDICATO = SGB_M4C_MOVS_NOM_GEN.SGB_ID_SINDICATO
            SGB_M4C_REG_COLA.SSP_ID_TP_IRPF = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_IRPF
            SGB_M4C_REG_COLA.SSP_ID_EST_IRPF = SGB_M4C_MOVS_NOM_GEN.SSP_ID_EST_IRPF
            SGB_M4C_REG_COLA.SSP_ID_MINUSVALIA = SGB_M4C_MOVS_NOM_GEN.SSP_ID_MINUSVALIA
            SGB_M4C_REG_COLA.SSP_ID_CENTRO_FIS = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CENTRO_FISICO
            SGB_M4C_REG_COLA.CMX_FORMA_DE_PAGO = SGB_M4C_MOVS_NOM_GEN.SSP_ID_PAYM_TYPE 'REVISAR SSP_ID_PAYM_DATA'
            SGB_M4C_REG_COLA.SCO_ID_COMP_BANK = SGB_M4C_MOVS_NOM_GEN.SCO_ID_COMP_BANK
            SGB_M4C_REG_COLA.COMP_BANC_SUC = SGB_M4C_MOVS_NOM_GEN.CALC_COMP_BANC_SUC()
            SGB_M4C_REG_COLA.SCO_ACCOUNT_NUMBER = SGB_M4C_MOVS_NOM_GEN.SCO_ACCOUNT_NUMBER
            SGB_M4C_REG_COLA.SSP_DC = SGB_M4C_MOVS_NOM_GEN.SSP_DC
            SGB_M4C_REG_COLA.SSP_ID_TP_PRODUCTOR = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_PRODUCTOR
            SGB_M4C_REG_COLA.SSP_ID_TP_ACTIVIDAD = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_ACTIVIDAD

            'Registrando las Altas para Infoblock
            SGB_M4C_REG_COLA_INF.AddRegister()
            SGB_M4C_REG_COLA_INF.ID_ARCHIVO = sIDArchivoInf
            SGB_M4C_REG_COLA_INF.USUARIO = "TB"
            SGB_M4C_REG_COLA_INF.ID = SGB_M4C_MOVS_NOM_GEN.STD_ID_HR
            SGB_M4C_REG_COLA_INF.ORGANIZATIONID = SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT
            SGB_M4C_REG_COLA_INF.PARENTID = SGB_M4C_CALC_DEPTO(SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC, dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT)
            SGB_M4C_REG_COLA_INF.NAME = SGB_M4C_MOVS_NOM_GEN.STD_N_FIRST_NAME
            SGB_M4C_REG_COLA_INF.PATERNALSURNAME = SGB_M4C_MOVS_NOM_GEN.SSP_PRIMER_APELLIDO
            SGB_M4C_REG_COLA_INF.MATERNALSURNAME = SGB_M4C_MOVS_NOM_GEN.STD_N_MAIDEN_NAME
            SGB_M4C_REG_COLA_INF.BIRTHDATE = FORMAT_YYYY_MM_DD(SGB_M4C_MOVS_NOM_GEN.CMX_DT_BIRTH)
            SGB_M4C_REG_COLA_INF.SEX = ToString((ToInt(SGB_M4C_MOVS_NOM_GEN.STD_ID_GENDER) - 1),0 ) '0 = Masculino, 1 = Femenino
            SGB_M4C_REG_COLA_INF.NIN = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_SS
            SGB_M4C_REG_COLA_INF.EMAIL = SGB_M4C_MOVS_NOM_GEN.CMX_EMAIL
            SGB_M4C_REG_COLA_INF.ORGANIZATION = SGB_M4C_CALC_EMPRESA(SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT, dFechaHoraIni)
            SGB_M4C_REG_COLA_INF.DEPARTMENT = SGB_M4C_CALC_WLOCAT(SGB_M4C_CALC_DEPTO(SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC, dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT),  dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT) 'Obtiene el nombre del WLOC pasado por par¿metro
            SGB_M4C_REG_COLA_INF.CATEGORY = SGB_M4C_CALC_CATEG(SGB_M4C_MOVS_NOM_GEN.SSP_ID_CATEGORIA)
            SGB_M4C_REG_COLA_INF.POSICION = SGB_M4C_CALC_POSICION(SGB_M4C_MOVS_NOM_GEN.STD_ID_HR, dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT)
            SGB_M4C_REG_COLA_INF.COSTCENTER = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CENT_COSTO
            SGB_M4C_REG_COLA_INF.PAYROLL = "3"
            SGB_M4C_REG_COLA_INF.OTHER1 = SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC
            SGB_M4C_REG_COLA_INF.OTHER2 = SGB_M4C_CALC_WLOCAT(SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC,  dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT) 'Obtiene el nombre del WLOC pasado por par¿metro
            SGB_M4C_REG_COLA_INF.OTHER3 = SGB_M4C_CALC_TIPO_EMP("0005", SGB_M4C_MOVS_NOM_GEN.STD_ID_HR_TYPE)
            SGB_M4C_REG_COLA_INF.ACTIVE = "1"
            SGB_M4C_REG_COLA_INF.INTERNAL = "1"
            SGB_M4C_REG_COLA_INF.CRC = sFlagAltaInf
            SGB_M4C_REG_COLA_INF.STARTDATE = FORMAT_YYYY_MM_DD(SGB_M4C_MOVS_NOM_GEN.CMX_DATE)
            SGB_M4C_REG_COLA_INF.DATE1 = FORMAT_YYYY_MM_DD(SGB_M4C_MOVS_NOM_GEN.SSP_FEC_ANTIGUEDAD)
            SGB_M4C_REG_COLA_INF.DATE2 = NullValue()
            SGB_M4C_REG_COLA_INF.NIF = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_DOC
            'SGB_M4C_REG_COLA_INF.FLAG = sFlagAltaInf

            If SGB_M4C_REG_COLA.Persist_tree() <> M4_ERROR Then
              'Altas registradas
              SetLog(M4_DEBUGINFOLOG, 60, 4, 400, "Altas registradas " + ToString(TodayNow()))

              'Registrando las Altas que se enviaron en el Archivo
              sIDArchivo = SGB_M4C_REG_COLA.ID_ARCHIVO
              sCMX_TP_MOVIMIENTO = "A" 'Se escribe una A en el tipo de movimiento para que permita realizar el registro.
              sCMX_DATE = SGB_M4C_REG_COLA.CMX_DATE
              sFECHA_BAJA = SGB_M4C_REG_COLA.FECHA_BAJA
              sSTD_ID_HRP_END_REASON = SGB_M4C_REG_COLA.STD_ID_HRP_END_REASON
              sSSP_ID_CAUSA_DESEM = SGB_M4C_REG_COLA.SSP_ID_CAUSA_DESEM
              sSSP_FEC_FIN_VACAC = SGB_M4C_REG_COLA.SSP_FEC_FIN_VACAC
              sSTD_ID_HR = SGB_M4C_REG_COLA.STD_ID_HR
              sSSP_PRIMER_APELLIDO = SGB_M4C_REG_COLA.SSP_PRIMER_APELLIDO
              sSTD_N_MAIDEN_NAME = SGB_M4C_REG_COLA.STD_N_MAIDEN_NAME
              sSTD_N_FIRST_NAME = SGB_M4C_REG_COLA.STD_N_FIRST_NAME
              sCMX_ID_TP_DOC = SGB_M4C_REG_COLA.CMX_ID_TP_DOC
              sSSP_NUM_DOC = SGB_M4C_REG_COLA.SSP_NUM_DOC
              sSSP_ID_PAIS_EMISOR = SGB_M4C_REG_COLA.SSP_ID_PAIS_EMISOR
              sCMX_DT_BIRTH = SGB_M4C_REG_COLA.CMX_DT_BIRTH
              sCMX_ID_NACIONALITY = SGB_M4C_REG_COLA.CMX_ID_NACIONALITY
              sCMX_ID_COUNTRY = SGB_M4C_REG_COLA.CMX_ID_COUNTRY
              sCMX_ID_SUB_GEO_DIV_ADD = SGB_M4C_REG_COLA.CMX_ID_SUB_GEO_DIV_ADD
              sCMX_ID_GEO_DIV_ADD = SGB_M4C_REG_COLA.CMX_ID_GEO_DIV_ADD
              sSTD_ID_GENDER = SGB_M4C_REG_COLA.STD_ID_GENDER
              sCMX_ID_MAR_STAT = SGB_M4C_REG_COLA.CMX_ID_MAR_STAT
              sCMX_PHONE = SGB_M4C_REG_COLA.CMX_PHONE
              sTEL_MOV = SGB_M4C_REG_COLA.TEL_MOV
              sCMX_EMAIL = SGB_M4C_REG_COLA.CMX_EMAIL
              sSTD_ID_LOCATION_TYPE = SGB_M4C_REG_COLA.STD_ID_LOCATION_TYPE
              sCMX_ID_SIGLA_DOMIC = SGB_M4C_REG_COLA.CMX_ID_SIGLA_DOMIC
              sCMX_ADDRESS_LINE_1 = SGB_M4C_REG_COLA.CMX_ADDRESS_LINE_1
              sCMX_NUM_VIA = SGB_M4C_REG_COLA.CMX_NUM_VIA
              sSSP_BLOQUE = SGB_M4C_REG_COLA.SSP_BLOQUE
              sSSP_ESCALERA = SGB_M4C_REG_COLA.SSP_ESCALERA
              sSSP_PISO = SGB_M4C_REG_COLA.SSP_PISO
              sSSP_PUERTA = SGB_M4C_REG_COLA.SSP_PUERTA
              sCMX_ID_GEO_PLACE = SGB_M4C_REG_COLA.CMX_ID_GEO_PLACE
              sCMX_ID_SUB_GEO_DIV = SGB_M4C_REG_COLA.CMX_ID_SUB_GEO_DIV
              sCMX_ID_GEO_DIV = SGB_M4C_REG_COLA.CMX_ID_GEO_DIV
              sCMX_ID_COUNTRY_ADD = SGB_M4C_REG_COLA.CMX_ID_COUNTRY_ADD
              sCMX_DISTRIT_POSTAL = SGB_M4C_REG_COLA.CMX_DISTRIT_POSTAL
              sSCO_ID_LEG_ENT = SGB_M4C_REG_COLA.SCO_ID_LEG_ENT
              sSCO_ID_JOB_CODE = SGB_M4C_REG_COLA.SCO_ID_JOB_CODE
              sCMX_ID_WORK_UNIT = SGB_M4C_REG_COLA.CMX_ID_WORK_UNIT
              sCMX_ID_WORK_LOC = SGB_M4C_REG_COLA.CMX_ID_WORK_LOC
              sSSP_ID_CENT_COSTO = SGB_M4C_REG_COLA.SSP_ID_CENT_COSTO
              sSTD_ID_HRP_START_REASON = SGB_M4C_REG_COLA.STD_ID_HRP_START_REASON
              sSTD_ID_HR_TYPE = SGB_M4C_REG_COLA.STD_ID_HR_TYPE
              sSSP_ID_TP_GESTION = SGB_M4C_REG_COLA.SSP_ID_TP_GESTION
              sSSP_FEC_FIN_PR_PRU = SGB_M4C_REG_COLA.SSP_FEC_FIN_PR_PRU
              sSSP_FEC_FIN_PV_CON = SGB_M4C_REG_COLA.SSP_FEC_FIN_PV_CON
              sSCO_ID_DURATION = SGB_M4C_REG_COLA.SCO_ID_DURATION
              sSSP_CON_NUM_SS = SGB_M4C_REG_COLA.SSP_CON_NUM_SS
              sSSP_PROV_NUM_SS = SGB_M4C_REG_COLA.SSP_PROV_NUM_SS
              sSSP_NUM_SS = SGB_M4C_REG_COLA.SSP_NUM_SS
              sSSP_DIG_NUM_SS = SGB_M4C_REG_COLA.SSP_DIG_NUM_SS
              sSSP_ID_CABEC_TC1 = SGB_M4C_REG_COLA.SSP_ID_CABEC_TC1
              sSSP_ID_GRUP_TARIFA = SGB_M4C_REG_COLA.SSP_ID_GRUP_TARIFA
              sSSP_ID_OCUPACION = SGB_M4C_REG_COLA.SSP_ID_OCUPACION
              sSSP_ID_CONV_SS = SGB_M4C_REG_COLA.SSP_ID_CONV_SS
              sSSP_NUM_PLURIEMPL = SGB_M4C_REG_COLA.SSP_NUM_PLURIEMPL
              sSSP_ID_CONT_LEGAL = SGB_M4C_REG_COLA.SSP_ID_CONT_LEGAL
              sCMX_ID_CONTRATO_INT = SGB_M4C_REG_COLA.CMX_ID_CONTRATO_INT
              sSSP_FEC_FIN_CONTRA = SGB_M4C_REG_COLA.SSP_FEC_FIN_CONTRA
              sSSP_ID_REL_LAB = SGB_M4C_REG_COLA.SSP_ID_REL_LAB
              sSSP_VALOR_COEF_T_P = SGB_M4C_REG_COLA.SSP_VALOR_COEF_T_P
              sSSP_TIPO_HORAS = SGB_M4C_REG_COLA.SSP_TIPO_HORAS
              sSSP_NUM_HORAS = SGB_M4C_REG_COLA.SSP_NUM_HORAS
              sSSP_JP_REG_IRREG = SGB_M4C_REG_COLA.SSP_JP_REG_IRREG
              sSSP_NUM_DIAS_JP = SGB_M4C_REG_COLA.SSP_NUM_DIAS_JP
              sSSP_PORC_GLEGAL = SGB_M4C_REG_COLA.SSP_PORC_GLEGAL
              sSSP_ID_MOTIV_REDUC = SGB_M4C_REG_COLA.SSP_ID_MOTIV_REDUC
              sSSP_ID_CAUSA_SUST = SGB_M4C_REG_COLA.SSP_ID_CAUSA_SUST
              sSSP_NSS_SUST_PROV = SGB_M4C_REG_COLA.SSP_NSS_SUST_PROV
              sSSP_NUSS_SUST = SGB_M4C_REG_COLA.SSP_NUSS_SUST
              sSSP_NSS_SUST_DC = SGB_M4C_REG_COLA.SSP_NSS_SUST_DC
              sSSP_PORC_MINUSVAL = SGB_M4C_REG_COLA.SSP_PORC_MINUSVAL
              sSSP_FEC_INI_A_CONT = SGB_M4C_REG_COLA.SSP_FEC_INI_A_CONT
              sSSP_MUJER_24 = SGB_M4C_REG_COLA.SSP_MUJER_24
              sSSP_MUJER_SUBREPR = SGB_M4C_REG_COLA.SSP_MUJER_SUBREPR
              sSSP_DIAS_PRUEBA = SGB_M4C_REG_COLA.SSP_DIAS_PRUEBA
              sSSP_CLAUSULA_ADIC = SGB_M4C_REG_COLA.SSP_CLAUSULA_ADIC
              sSCO_ID_TYPE_ADJUST = SGB_M4C_REG_COLA.SCO_ID_TYPE_ADJUST
              sCMX_ID_CONVENIO = SGB_M4C_REG_COLA.CMX_ID_CONVENIO
              sCMX_ID_CATEGORIA = SGB_M4C_REG_COLA.CMX_ID_CATEGORIA
              sSSP_BRUTO_ANUAL = SGB_M4C_REG_COLA.SSP_BRUTO_ANUAL
              sCMX_ID_TP_SALARIO = SGB_M4C_REG_COLA.CMX_ID_TP_SALARIO
              sSSP_FEC_ANTIGUEDAD = SGB_M4C_REG_COLA.SSP_FEC_ANTIGUEDAD
              sSSP_FEC_EXTRAS = SGB_M4C_REG_COLA.SSP_FEC_EXTRAS
              sSGB_ID_SINDICATO = SGB_M4C_REG_COLA.SGB_ID_SINDICATO
              sSSP_ID_TP_IRPF = SGB_M4C_REG_COLA.SSP_ID_TP_IRPF
              sSSP_ID_EST_IRPF = SGB_M4C_REG_COLA.SSP_ID_EST_IRPF
              sSSP_ID_MINUSVALIA = SGB_M4C_REG_COLA.SSP_ID_MINUSVALIA
              sSSP_ID_CENTRO_FIS = SGB_M4C_REG_COLA.SSP_ID_CENTRO_FIS
              sCMX_FORMA_DE_PAGO = SGB_M4C_REG_COLA.CMX_FORMA_DE_PAGO
              sSCO_ID_COMP_BANK = SGB_M4C_REG_COLA.SCO_ID_COMP_BANK
              sCOMP_BANC_SUC = SGB_M4C_REG_COLA.COMP_BANC_SUC
              sSCO_ACCOUNT_NUMBER = SGB_M4C_REG_COLA.SCO_ACCOUNT_NUMBER
              sSSP_DC = SGB_M4C_REG_COLA.SSP_DC
              sSSP_ID_TP_PRODUCTOR = SGB_M4C_REG_COLA.SSP_ID_TP_PRODUCTOR
              sSSP_ID_TP_ACTIVIDAD = SGB_M4C_REG_COLA.SSP_ID_TP_ACTIVIDAD

              SRGB_M4C_DATOS_ENVIADOS.AddRegister()
              SRGB_M4C_DATOS_ENVIADOS.ID_ORGANIZATION = "0005"
              SRGB_M4C_DATOS_ENVIADOS.CMX_TP_MOVIMIENTO = sCMX_TP_MOVIMIENTO
              SRGB_M4C_DATOS_ENVIADOS.CMX_DATE = sCMX_DATE
              'FECHA_BAJA = sFECHA_BAJA
              SRGB_M4C_DATOS_ENVIADOS.STD_ID_HRP_END_REASON = sSTD_ID_HRP_END_REASON
              SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CAUSA_DESEM = sSSP_ID_CAUSA_DESEM
              SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_VACAC = sSSP_FEC_FIN_VACAC
              SRGB_M4C_DATOS_ENVIADOS.STD_ID_HR = sSTD_ID_HR 'Llave primaria
              SRGB_M4C_DATOS_ENVIADOS.SSP_PRIMER_APELLIDO = sSSP_PRIMER_APELLIDO
              SRGB_M4C_DATOS_ENVIADOS.STD_N_MAIDEN_NAME = sSTD_N_MAIDEN_NAME
              SRGB_M4C_DATOS_ENVIADOS.STD_N_FIRST_NAME = sSTD_N_FIRST_NAME
              SRGB_M4C_DATOS_ENVIADOS.CMX_ID_TP_DOC = sCMX_ID_TP_DOC
              SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_DOC = sSSP_NUM_DOC
              SRGB_M4C_DATOS_ENVIADOS.SSP_ID_PAIS_EMISOR = sSSP_ID_PAIS_EMISOR
              SRGB_M4C_DATOS_ENVIADOS.CMX_DT_BIRTH = sCMX_DT_BIRTH
              SRGB_M4C_DATOS_ENVIADOS.CMX_ID_NACIONALITY = sCMX_ID_NACIONALITY
              SRGB_M4C_DATOS_ENVIADOS.CMX_ID_COUNTRY = sCMX_ID_COUNTRY
              SRGB_M4C_DATOS_ENVIADOS.CMX_ID_SUB_GEO_DIV_ADD = sCMX_ID_SUB_GEO_DIV_ADD
              SRGB_M4C_DATOS_ENVIADOS.CMX_ID_GEO_DIV_ADD = sCMX_ID_GEO_DIV_ADD
              SRGB_M4C_DATOS_ENVIADOS.STD_ID_GENDER = sSTD_ID_GENDER
              SRGB_M4C_DATOS_ENVIADOS.CMX_ID_MAR_STAT = sCMX_ID_MAR_STAT
              SRGB_M4C_DATOS_ENVIADOS.CMX_PHONE = sCMX_PHONE
              'TEL_MOV = sTEL_MOV
              SRGB_M4C_DATOS_ENVIADOS.CMX_EMAIL = sCMX_EMAIL
              SRGB_M4C_DATOS_ENVIADOS.STD_ID_LOCATION_TYPE = sSTD_ID_LOCATION_TYPE
              SRGB_M4C_DATOS_ENVIADOS.CMX_ID_SIGLA_DOMIC = sCMX_ID_SIGLA_DOMIC
              SRGB_M4C_DATOS_ENVIADOS.CMX_ADDRESS_LINE_1 = sCMX_ADDRESS_LINE_1
              SRGB_M4C_DATOS_ENVIADOS.CMX_NUM_VIA = sCMX_NUM_VIA
              SRGB_M4C_DATOS_ENVIADOS.SSP_BLOQUE = sSSP_BLOQUE
              SRGB_M4C_DATOS_ENVIADOS.SSP_ESCALERA = sSSP_ESCALERA
              SRGB_M4C_DATOS_ENVIADOS.SSP_PISO = sSSP_PISO
              SRGB_M4C_DATOS_ENVIADOS.SSP_PUERTA = sSSP_PUERTA
              SRGB_M4C_DATOS_ENVIADOS.CMX_ID_GEO_PLACE = sCMX_ID_GEO_PLACE
              SRGB_M4C_DATOS_ENVIADOS.CMX_ID_SUB_GEO_DIV = sCMX_ID_SUB_GEO_DIV
              SRGB_M4C_DATOS_ENVIADOS.CMX_ID_GEO_DIV = sCMX_ID_GEO_DIV
              SRGB_M4C_DATOS_ENVIADOS.CMX_ID_COUNTRY_ADD = sCMX_ID_COUNTRY_ADD
              SRGB_M4C_DATOS_ENVIADOS.CMX_DISTRIT_POSTAL = sCMX_DISTRIT_POSTAL
              SRGB_M4C_DATOS_ENVIADOS.SCO_ID_LEG_ENT = sSCO_ID_LEG_ENT
              SRGB_M4C_DATOS_ENVIADOS.SCO_ID_JOB_CODE = sSCO_ID_JOB_CODE
              SRGB_M4C_DATOS_ENVIADOS.CMX_ID_WORK_UNIT = sCMX_ID_WORK_UNIT
              SRGB_M4C_DATOS_ENVIADOS.CMX_ID_WORK_LOC = sCMX_ID_WORK_LOC
              SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CENT_COSTO = sSSP_ID_CENT_COSTO
              SRGB_M4C_DATOS_ENVIADOS.STD_ID_HRP_START_REASON = sSTD_ID_HRP_START_REASON
              SRGB_M4C_DATOS_ENVIADOS.STD_ID_HR_TYPE = sSTD_ID_HR_TYPE
              SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_GESTION = sSSP_ID_TP_GESTION
              SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_PR_PRU = sSSP_FEC_FIN_PR_PRU
              SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_PV_CON = sSSP_FEC_FIN_PV_CON
              SRGB_M4C_DATOS_ENVIADOS.SCO_ID_DURATION = sSCO_ID_DURATION
              SRGB_M4C_DATOS_ENVIADOS.SSP_CON_NUM_SS = sSSP_CON_NUM_SS
              SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_SS = sSSP_PROV_NUM_SS + "-" + sSSP_NUM_SS + "-" + sSSP_DIG_NUM_SS
              SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CABEC_TC1 = sSSP_ID_CABEC_TC1
              SRGB_M4C_DATOS_ENVIADOS.SSP_ID_GRUP_TARIFA = sSSP_ID_GRUP_TARIFA
              SRGB_M4C_DATOS_ENVIADOS.SSP_ID_OCUPACION = sSSP_ID_OCUPACION
              SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CONV_SS = sSSP_ID_CONV_SS
              SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_PLURIEMPL = sSSP_NUM_PLURIEMPL
              SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CONT_LEGAL = sSSP_ID_CONT_LEGAL
              SRGB_M4C_DATOS_ENVIADOS.CMX_ID_CONTRATO_INT = sCMX_ID_CONTRATO_INT
              SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_CONTRA = sSSP_FEC_FIN_CONTRA
              SRGB_M4C_DATOS_ENVIADOS.SSP_ID_REL_LAB = sSSP_ID_REL_LAB
              SRGB_M4C_DATOS_ENVIADOS.SSP_VALOR_COEF_T_P = sSSP_VALOR_COEF_T_P
              SRGB_M4C_DATOS_ENVIADOS.SSP_TIPO_HORAS = sSSP_TIPO_HORAS
              SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_HORAS = sSSP_NUM_HORAS
              SRGB_M4C_DATOS_ENVIADOS.SSP_JP_REG_IRREG = sSSP_JP_REG_IRREG
              SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_DIAS_JP = sSSP_NUM_DIAS_JP
              SRGB_M4C_DATOS_ENVIADOS.SSP_PORC_GLEGAL = sSSP_PORC_GLEGAL
              SRGB_M4C_DATOS_ENVIADOS.SSP_ID_MOTIV_REDUC = sSSP_ID_MOTIV_REDUC
              SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CAUSA_SUST = sSSP_ID_CAUSA_SUST
              SRGB_M4C_DATOS_ENVIADOS.SSP_NUSS_SUST = sSSP_NSS_SUST_PROV + sSSP_NUSS_SUST + sSSP_NSS_SUST_DC
              SRGB_M4C_DATOS_ENVIADOS.SSP_PORC_MINUSVAL = sSSP_PORC_MINUSVAL
              SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_INI_A_CONT = sSSP_FEC_INI_A_CONT
              SRGB_M4C_DATOS_ENVIADOS.SSP_MUJER_24 = sSSP_MUJER_24
              SRGB_M4C_DATOS_ENVIADOS.SSP_MUJER_SUBREPR = sSSP_MUJER_SUBREPR
              SRGB_M4C_DATOS_ENVIADOS.SSP_DIAS_PRUEBA = sSSP_DIAS_PRUEBA
              SRGB_M4C_DATOS_ENVIADOS.SSP_CLAUSULA_ADIC = sSSP_CLAUSULA_ADIC
              SRGB_M4C_DATOS_ENVIADOS.SCO_ID_TYPE_ADJUST = sSCO_ID_TYPE_ADJUST
              SRGB_M4C_DATOS_ENVIADOS.CMX_ID_CONVENIO = sCMX_ID_CONVENIO
              SRGB_M4C_DATOS_ENVIADOS.CMX_ID_CATEGORIA = sCMX_ID_CATEGORIA
              SRGB_M4C_DATOS_ENVIADOS.SSP_BRUTO_ANUAL = sSSP_BRUTO_ANUAL
              SRGB_M4C_DATOS_ENVIADOS.CMX_ID_TP_SALARIO = sCMX_ID_TP_SALARIO
              SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_ANTIGUEDAD = sSSP_FEC_ANTIGUEDAD
              SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_EXTRAS = sSSP_FEC_EXTRAS
              SRGB_M4C_DATOS_ENVIADOS.SGB_ID_SINDICATO = sSGB_ID_SINDICATO
              SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_IRPF = sSSP_ID_TP_IRPF
              SRGB_M4C_DATOS_ENVIADOS.SSP_ID_EST_IRPF = sSSP_ID_EST_IRPF
              SRGB_M4C_DATOS_ENVIADOS.SSP_ID_MINUSVALIA = sSSP_ID_MINUSVALIA
              SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CENTRO_FISICO = sSSP_ID_CENTRO_FIS
              SRGB_M4C_DATOS_ENVIADOS.CMX_FORMA_DE_PAGO = sCMX_FORMA_DE_PAGO
              SRGB_M4C_DATOS_ENVIADOS.SCO_ID_COMP_BANK = sSCO_ID_COMP_BANK
              'COMP_BANC_SUC = sCOMP_BANC_SUC
              SRGB_M4C_DATOS_ENVIADOS.SCO_ID_BANK_CODE = Mid(sCOMP_BANC_SUC, 0, 4)
              SRGB_M4C_DATOS_ENVIADOS.CMX_ID_BANK_BRANCH = Mid(sCOMP_BANC_SUC, 4, 8)
              SRGB_M4C_DATOS_ENVIADOS.SCO_ACCOUNT_NUMBER = sSCO_ACCOUNT_NUMBER
              SRGB_M4C_DATOS_ENVIADOS.SSP_DC = sSSP_DC
              SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_PRODUCTOR = sSSP_ID_TP_PRODUCTOR
              SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_ACTIVIDAD = sSSP_ID_TP_ACTIVIDAD

              SRGB_M4C_DATOS_ENVIADOS.Persist_tree()
              'Se realizó el registro de las Altas de los empleados en la tabla de Datos Enviados
              SetLog(M4_DEBUGINFOLOG,60,4,400,"Se realizó el registro del alta del colaborador (" + sSTD_ID_HR + ") en la tabla de Datos Enviados " + ToString(TodayNow(),0))
            EndIf

            SGB_M4C_REG_COLA_INF.Persist_tree()
            'Altas Infoblock registradas
            SetLog(M4_DEBUGINFOLOG, 60, 4, 400, "Altas Infoblock registradas " + ToString(TodayNow()))

        ElseIf sTipoMov = "C" Then 'Registrando Deltas
'            iDelta = 0

'            'Por cada cambio se valida qu¿ campo se encuentra distinto a lo enviado a M4Cloud
'            SRGB_M4C_DATOS_ENVIADOS.DESTROYBLOCK()
'            sSql = "FROM &SGB_M4C_DATOS_ENVIADOS A "
'            sSql = sSql + "WHERE A.STD_ID_HR = '" + sSTD_ID_HR + "' "
'            SRGB_M4C_DATOS_ENVIADOS.FILTRO_SELECT = sSql
'            SRGB_M4C_DATOS_ENVIADOS.Load_Blk()
'
'            iRegSRGB_M4C_DATOS_ENVIADOS = SRGB_M4C_DATOS_ENVIADOS.Count()
'            If iRegSRGB_M4C_DATOS_ENVIADOS > 0 Then
'              SRGB_M4C_DATOS_ENVIADOS.Begin()

'              'El registro se realiza por grupo funcional. Si se detecta un cambio en cualquier campo
'              'del grupo funcional, se env¿a el grupo funcional completo
'              sCMX_TP_MOVIMIENTO = sFlagCambio
'              sCMX_DATE = SGB_M4C_MOVS_NOM_GEN.CMX_DATE
'              sFECHA_BAJA = NullValue() 'En blanco
'              sSTD_ID_HRP_END_REASON = NullValue() 'En blanco
'              sSSP_ID_CAUSA_DESEM = NullValue() 'En blanco

              'El campo de Fecha Fin Vacaciones no tiene un grupo funcional definido
'              sSSP_FEC_FIN_VACAC = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.SSP_FEC_FIN_VACAC <> SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_VACAC Then
'                iDelta = 1
'                sSSP_FEC_FIN_VACAC = SGB_M4C_MOVS_NOM_GEN.SSP_FEC_FIN_VACAC

'                SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_VACAC = sSSP_FEC_FIN_VACAC
'              EndIf

'              'SRGB_M4C_DATOS_ENVIADOS.ID_ORGANIZATION = "0005" 'Llave primaria
'              SRGB_M4C_DATOS_ENVIADOS.CMX_TP_MOVIMIENTO = "C" 'Se registra directamente la C para que permita el registro como un Cambio
'              SRGB_M4C_DATOS_ENVIADOS.CMX_DATE = sCMX_DATE
'              'FECHA_BAJA = sFECHA_BAJA
'              'SRGB_M4C_DATOS_ENVIADOS.STD_ID_HRP_END_REASON = sSTD_ID_HRP_END_REASON 'No se actualiza
'              'SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CAUSA_DESEM = sSSP_ID_CAUSA_DESEM 'No se actualiza
'              'SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_VACAC = sSSP_FEC_FIN_VACAC
'              'SRGB_M4C_DATOS_ENVIADOS.STD_ID_HR = sSTD_ID_HR 'Llave primaria

'              'Grupo funcional Nombre
'              sSSP_PRIMER_APELLIDO = NullValue()
'              sSTD_N_MAIDEN_NAME = NullValue()
'              sSTD_N_FIRST_NAME = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.SSP_PRIMER_APELLIDO <> SRGB_M4C_DATOS_ENVIADOS.SSP_PRIMER_APELLIDO Or  SGB_M4C_MOVS_NOM_GEN.STD_N_MAIDEN_NAME <> SRGB_M4C_DATOS_ENVIADOS.STD_N_MAIDEN_NAME Or SGB_M4C_MOVS_NOM_GEN.STD_N_FIRST_NAME <> SRGB_M4C_DATOS_ENVIADOS.STD_N_FIRST_NAME Then
'                iDelta = 1
'                sSSP_PRIMER_APELLIDO = SGB_M4C_MOVS_NOM_GEN.SSP_PRIMER_APELLIDO
'                sSTD_N_MAIDEN_NAME = SGB_M4C_MOVS_NOM_GEN.STD_N_MAIDEN_NAME
'                sSTD_N_FIRST_NAME = SGB_M4C_MOVS_NOM_GEN.STD_N_FIRST_NAME

'                SRGB_M4C_DATOS_ENVIADOS.SSP_PRIMER_APELLIDO = sSSP_PRIMER_APELLIDO
'                SRGB_M4C_DATOS_ENVIADOS.STD_N_MAIDEN_NAME = sSTD_N_MAIDEN_NAME
'                SRGB_M4C_DATOS_ENVIADOS.STD_N_FIRST_NAME = sSTD_N_FIRST_NAME
'              EndIf
'
'              'Grupo funcional N¿mero Documento
'              sCMX_ID_TP_DOC = NullValue()
'              sSSP_NUM_DOC = NullValue()
'              sSSP_ID_PAIS_EMISOR = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.CMX_ID_TP_DOC <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_TP_DOC Or  SGB_M4C_MOVS_NOM_GEN.SSP_NUM_DOC <> SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_DOC Or SGB_M4C_MOVS_NOM_GEN.SSP_ID_PAIS_EMISOR <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_PAIS_EMISOR Then
'                iDelta = 1
'                sCMX_ID_TP_DOC = SGB_M4C_MOVS_NOM_GEN.CMX_ID_TP_DOC
'                sSSP_NUM_DOC = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_DOC
'                sSSP_ID_PAIS_EMISOR = SGB_M4C_MOVS_NOM_GEN.SSP_ID_PAIS_EMISOR

'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_TP_DOC = sCMX_ID_TP_DOC
'                SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_DOC = sSSP_NUM_DOC
'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_PAIS_EMISOR = sSSP_ID_PAIS_EMISOR
'              EndIf

'              'Grupo funcional Fecha Nacimiento
'              sCMX_DT_BIRTH = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.CMX_DT_BIRTH <> SRGB_M4C_DATOS_ENVIADOS.CMX_DT_BIRTH Then
'                iDelta = 1
'                sCMX_DT_BIRTH = SGB_M4C_MOVS_NOM_GEN.CMX_DT_BIRTH

'                SRGB_M4C_DATOS_ENVIADOS.CMX_DT_BIRTH = sCMX_DT_BIRTH
'              EndIf

'              'Grupo funcional Nacionalidad
'              sCMX_ID_NACIONALITY = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.CMX_ID_NACIONALITY <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_NACIONALITY Then
'                iDelta = 1
'                sCMX_ID_NACIONALITY = SGB_M4C_MOVS_NOM_GEN.CMX_ID_NACIONALITY

'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_NACIONALITY = sCMX_ID_NACIONALITY
'              EndIf

'              'Grupo funcional Lugar Nacimiento
'              sCMX_ID_COUNTRY = NullValue()
'              sCMX_ID_SUB_GEO_DIV_ADD = NullValue()
'              sCMX_ID_GEO_DIV_ADD = NullValue() 'En blanco
'              If SGB_M4C_MOVS_NOM_GEN.CMX_ID_COUNTRY <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_COUNTRY Or SGB_M4C_MOVS_NOM_GEN.SSP_ID_SUB_GEO_DIV <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_SUB_GEO_DIV_ADD Then
'                iDelta = 1
'                sCMX_ID_COUNTRY = SGB_M4C_MOVS_NOM_GEN.CMX_ID_COUNTRY
'                sCMX_ID_SUB_GEO_DIV_ADD = SGB_M4C_MOVS_NOM_GEN.SSP_ID_SUB_GEO_DIV

'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_COUNTRY = sCMX_ID_COUNTRY
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_SUB_GEO_DIV_ADD = sCMX_ID_SUB_GEO_DIV_ADD
'                'SRGB_M4C_DATOS_ENVIADOS.CMX_ID_GEO_DIV_ADD = sCMX_ID_GEO_DIV_ADD 'No se actualiza
'              EndIf

'              'Grupo funcional Sexo
'              sSTD_ID_GENDER = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.STD_ID_GENDER <> SRGB_M4C_DATOS_ENVIADOS.STD_ID_GENDER Then
'                iDelta = 1
'                sSTD_ID_GENDER = SGB_M4C_MOVS_NOM_GEN.STD_ID_GENDER

'                SRGB_M4C_DATOS_ENVIADOS.STD_ID_GENDER = sSTD_ID_GENDER
'              EndIf

'              'Grupo funcional Estado Civil
'              sCMX_ID_MAR_STAT = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.CMX_ID_MAR_STAT <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_MAR_STAT Then
'                iDelta = 1
'                sCMX_ID_MAR_STAT = SGB_M4C_MOVS_NOM_GEN.CMX_ID_MAR_STAT

'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_MAR_STAT = sCMX_ID_MAR_STAT
'              EndIf

'              sCMX_PHONE = NullValue()
'              sTEL_MOV = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.CMX_PHONE <> SRGB_M4C_DATOS_ENVIADOS.CMX_PHONE Then
'                iDelta = 1
'                sCMX_PHONE = SGB_M4C_MOVS_NOM_GEN.CMX_PHONE
'                sTEL_MOV = SGB_M4C_MOVS_NOM_GEN.CMX_PHONE

'                SRGB_M4C_DATOS_ENVIADOS.CMX_PHONE = sCMX_PHONE
'              EndIf

'              'El tel¿fono m¿vil est¿ marcado como CMX_PHONE en el layout*
'              'sTEL_MOV = NullValue()
'              'If SGB_M4C_MOVS_NOM_GEN.TEL_MOV <> SRGB_M4C_DATOS_ENVIADOS.CMX_PHONE Then
'              '  iDelta = 1
'              '  sTEL_MOV = SGB_M4C_MOVS_NOM_GEN.CMX_PHONE
'              'EndIf

'              'Grupo funcional Correo Electr¿nico
'              sCMX_EMAIL = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.CMX_EMAIL <> SRGB_M4C_DATOS_ENVIADOS.CMX_EMAIL Then
'                iDelta = 1
'                sCMX_EMAIL = SGB_M4C_MOVS_NOM_GEN.CMX_EMAIL

'                SRGB_M4C_DATOS_ENVIADOS.CMX_EMAIL = sCMX_EMAIL
'              EndIf
'
'              'Grupo funcional Direcci¿n
'              sSTD_ID_LOCATION_TYPE = "1" 'Hardcoded
'              sCMX_ID_SIGLA_DOMIC = NullValue()
'              sCMX_ADDRESS_LINE_1 = NullValue()
'              sCMX_NUM_VIA = NullValue()
'              sSSP_BLOQUE = NullValue()
'              sSSP_ESCALERA = NullValue()
'              sSSP_PISO = NullValue()
'              sSSP_PUERTA = NullValue()
'              sCMX_ID_GEO_PLACE = NullValue()
'              sCMX_ID_SUB_GEO_DIV = NullValue()
'              sCMX_ID_GEO_DIV = NullValue() 'En blanco
'              sCMX_ID_COUNTRY_ADD = NullValue()
'              sCMX_DISTRIT_POSTAL = NullValue()

'              If SGB_M4C_MOVS_NOM_GEN.CMX_ID_SIGLA_DOMIC <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_SIGLA_DOMIC Or SGB_M4C_MOVS_NOM_GEN.CMX_ADDRESS_LINE_1 <> SRGB_M4C_DATOS_ENVIADOS.CMX_ADDRESS_LINE_1 Or SGB_M4C_MOVS_NOM_GEN.CMX_NUM_VIA <> SRGB_M4C_DATOS_ENVIADOS.CMX_NUM_VIA Or SGB_M4C_MOVS_NOM_GEN.SSP_BLOQUE <> SRGB_M4C_DATOS_ENVIADOS.SSP_BLOQUE Or SGB_M4C_MOVS_NOM_GEN.SSP_ESCALERA <> SRGB_M4C_DATOS_ENVIADOS.SSP_ESCALERA Or SGB_M4C_MOVS_NOM_GEN.SSP_PISO <> SRGB_M4C_DATOS_ENVIADOS.SSP_PISO Or SGB_M4C_MOVS_NOM_GEN.SSP_PUERTA <> SRGB_M4C_DATOS_ENVIADOS.SSP_PUERTA Or SGB_M4C_MOVS_NOM_GEN.CMX_ID_GEO_PLACE <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_GEO_PLACE Or SGB_M4C_MOVS_NOM_GEN.CMX_ID_SUB_GEO_DIV <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_SUB_GEO_DIV Or SGB_M4C_MOVS_NOM_GEN.CMX_ID_COUNTRY_ADD <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_COUNTRY_ADD Or SGB_M4C_MOVS_NOM_GEN.CMX_DISTRIT_POSTAL <> SRGB_M4C_DATOS_ENVIADOS.CMX_DISTRIT_POSTAL Then
'                iDelta = 1
'                sCMX_ID_SIGLA_DOMIC = SGB_M4C_MOVS_NOM_GEN.CMX_ID_SIGLA_DOMIC
'                sCMX_ADDRESS_LINE_1 = SGB_M4C_MOVS_NOM_GEN.CMX_ADDRESS_LINE_1
'                sCMX_NUM_VIA = SGB_M4C_MOVS_NOM_GEN.CMX_NUM_VIA
'                sSSP_BLOQUE = SGB_M4C_MOVS_NOM_GEN.SSP_BLOQUE
'                sSSP_ESCALERA = SGB_M4C_MOVS_NOM_GEN.SSP_ESCALERA
'                sSSP_PISO = SGB_M4C_MOVS_NOM_GEN.SSP_PISO
'                sSSP_PUERTA = SGB_M4C_MOVS_NOM_GEN.SSP_PUERTA
'                sCMX_ID_GEO_PLACE = SGB_M4C_MOVS_NOM_GEN.CMX_ID_GEO_PLACE
'                sCMX_ID_SUB_GEO_DIV = SGB_M4C_MOVS_NOM_GEN.CMX_ID_SUB_GEO_DIV
'                sCMX_ID_COUNTRY_ADD = SGB_M4C_MOVS_NOM_GEN.CMX_ID_COUNTRY_ADD
'                sCMX_DISTRIT_POSTAL = SGB_M4C_MOVS_NOM_GEN.CMX_DISTRIT_POSTAL

'                SRGB_M4C_DATOS_ENVIADOS.STD_ID_LOCATION_TYPE = sSTD_ID_LOCATION_TYPE
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_SIGLA_DOMIC = sCMX_ID_SIGLA_DOMIC
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ADDRESS_LINE_1 = sCMX_ADDRESS_LINE_1
'                SRGB_M4C_DATOS_ENVIADOS.CMX_NUM_VIA = sCMX_NUM_VIA
'                SRGB_M4C_DATOS_ENVIADOS.SSP_BLOQUE = sSSP_BLOQUE
'                SRGB_M4C_DATOS_ENVIADOS.SSP_ESCALERA = sSSP_ESCALERA
'                SRGB_M4C_DATOS_ENVIADOS.SSP_PISO = sSSP_PISO
'                SRGB_M4C_DATOS_ENVIADOS.SSP_PUERTA = sSSP_PUERTA
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_GEO_PLACE = sCMX_ID_GEO_PLACE
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_SUB_GEO_DIV = sCMX_ID_SUB_GEO_DIV
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_GEO_DIV = sCMX_ID_GEO_DIV
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_COUNTRY_ADD = sCMX_ID_COUNTRY_ADD
'                SRGB_M4C_DATOS_ENVIADOS.CMX_DISTRIT_POSTAL = sCMX_DISTRIT_POSTAL
'              EndIf

'              'Grupo funcional Empresa
'              sSCO_ID_LEG_ENT = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT <> SRGB_M4C_DATOS_ENVIADOS.SCO_ID_LEG_ENT Then
'                iDelta = 1
'                sSCO_ID_LEG_ENT = SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT

'                SRGB_M4C_DATOS_ENVIADOS.SCO_ID_LEG_ENT = sSCO_ID_LEG_ENT
'              EndIf

'              'Grupo funcional Puesto
'              sSCO_ID_JOB_CODE = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.SCO_ID_JOB_CODE <> SRGB_M4C_DATOS_ENVIADOS.SCO_ID_JOB_CODE Then
'                iDelta = 1
'                sSCO_ID_JOB_CODE = SGB_M4C_MOVS_NOM_GEN.SCO_ID_JOB_CODE

'                SRGB_M4C_DATOS_ENVIADOS.SCO_ID_JOB_CODE = sSCO_ID_JOB_CODE
'              EndIf

'              'Grupo funcional Unidad Organizativa
'              sCMX_ID_WORK_UNIT = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_UNIT <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_WORK_UNIT Then
'                iDelta = 1
'                sCMX_ID_WORK_UNIT = SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_UNIT

'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_WORK_UNIT = sCMX_ID_WORK_UNIT
'              EndIf

'              'Grupo funcional Lugar de Trabajo
'              sCMX_ID_WORK_LOC = NullValue()
'              'If SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_WORK_LOC Then
'              If SGB_M4C_MOVS_NOM_GEN.SSP_ID_CENTRO_FISICO <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_WORK_LOC Then
'                iDelta = 1
'                sCMX_ID_WORK_LOC = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CENTRO_FISICO

'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_WORK_LOC = sCMX_ID_WORK_LOC
'              EndIf

'              'Grupo funcional Centro de Costo
'              sSSP_ID_CENT_COSTO = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.CALC_CENT_COST() <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CENT_COSTO Then
'                iDelta = 1
'                sSSP_ID_CENT_COSTO = SGB_M4C_MOVS_NOM_GEN.CALC_CENT_COST()

'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CENT_COSTO = sSSP_ID_CENT_COSTO
'              EndIf

'              sSTD_ID_HRP_START_REASON = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.STD_ID_HRP_START_REASON <> SRGB_M4C_DATOS_ENVIADOS.STD_ID_HRP_START_REASON Then
'                iDelta = 1
'                sSTD_ID_HRP_START_REASON = SGB_M4C_MOVS_NOM_GEN.STD_ID_HRP_START_REASON

'                SRGB_M4C_DATOS_ENVIADOS.STD_ID_HRP_START_REASON = sSTD_ID_HRP_START_REASON
'              EndIf
'
'              'Grupo funcional Tipo Empleado
'              sSTD_ID_HR_TYPE = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.STD_ID_HR_TYPE <> SRGB_M4C_DATOS_ENVIADOS.STD_ID_HR_TYPE Then
'                iDelta = 1
'                sSTD_ID_HR_TYPE = SGB_M4C_MOVS_NOM_GEN.STD_ID_HR_TYPE

'                SRGB_M4C_DATOS_ENVIADOS.STD_ID_HR_TYPE = sSTD_ID_HR_TYPE
'              EndIf

'              'Grupo funcional Agrupaci¿n de Gesti¿n
'              sSSP_ID_TP_GESTION = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_GESTION <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_GESTION Then
'                iDelta = 1
'                sSSP_ID_TP_GESTION = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_GESTION

'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_GESTION = sSSP_ID_TP_GESTION
'              EndIf

'              'Grupo funcional Contrato
'              sSSP_FEC_FIN_PR_PRU = NullValue() 'En blanco
'              sSSP_FEC_FIN_PV_CON = NullValue()
'              sSCO_ID_DURATION = NullValue() 'En blanco
'              sSSP_ID_CONT_LEGAL = NullValue()
'              sCMX_ID_CONTRATO_INT = NullValue()
'              sSSP_FEC_FIN_CONTRA = NullValue()
'              sSSP_ID_REL_LAB = NullValue() 'En blanco
'              sSSP_VALOR_COEF_T_P = NullValue()
'              sSSP_TIPO_HORAS = NullValue()
'              sSSP_NUM_HORAS = NullValue()
'              sSSP_JP_REG_IRREG = NullValue()
'              sSSP_NUM_DIAS_JP = NullValue()
'              sSSP_ID_CAUSA_SUST = NullValue()
'              sSSP_NSS_SUST_PROV = NullValue()
'              sSSP_NUSS_SUST = NullValue()
'              sSSP_NSS_SUST_DC = NullValue()
'              sSSP_PORC_MINUSVAL = NullValue() 'En blanco
'              sSSP_FEC_INI_A_CONT = NullValue() 'En blanco
'              sSSP_MUJER_24 = NullValue() 'En blanco
'              sSSP_MUJER_SUBREPR = NullValue() 'En blanco
'              sSSP_DIAS_PRUEBA = NullValue() 'En blanco
'              sSSP_CLAUSULA_ADIC = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.SSP_FEC_FIN_PV_CON <> SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_PV_CON Or SGB_M4C_MOVS_NOM_GEN.SSP_ID_CONT_LEGAL <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CONT_LEGAL Or SGB_M4C_MOVS_NOM_GEN.CMX_ID_CONTRATO_INT <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_CONTRATO_INT Or SGB_M4C_MOVS_NOM_GEN.SSP_FEC_FIN_CONTRA <> SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_CONTRA Or SGB_M4C_MOVS_NOM_GEN.SSP_VALOR_COEF_T_P <> SRGB_M4C_DATOS_ENVIADOS.SSP_VALOR_COEF_T_P Or SGB_M4C_MOVS_NOM_GEN.SSP_TIPO_HORAS <> SRGB_M4C_DATOS_ENVIADOS.SSP_TIPO_HORAS Or SGB_M4C_MOVS_NOM_GEN.SSP_NUM_HORAS <> SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_HORAS Or SGB_M4C_MOVS_NOM_GEN.SSP_JP_REG_IRREG <> SRGB_M4C_DATOS_ENVIADOS.SSP_JP_REG_IRREG Or SGB_M4C_MOVS_NOM_GEN.SSP_NUM_DIAS_JP <> SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_DIAS_JP Or SGB_M4C_MOVS_NOM_GEN.SSP_ID_CAUSA_SUST <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CAUSA_SUST Or (SGB_M4C_MOVS_NOM_GEN.SSP_NSS_SUST_PROV + SGB_M4C_MOVS_NOM_GEN.SSP_NUSS_SUST + SGB_M4C_MOVS_NOM_GEN.SSP_NSS_SUST_DC) <> SRGB_M4C_DATOS_ENVIADOS.SSP_NUSS_SUST Or SGB_M4C_MOVS_NOM_GEN.SSP_CLAUSULA_ADIC <> SRGB_M4C_DATOS_ENVIADOS.SSP_CLAUSULA_ADIC Then
'                iDelta = 1
'                sSSP_FEC_FIN_PV_CON = SGB_M4C_MOVS_NOM_GEN.SSP_FEC_FIN_PV_CON
'                sSSP_ID_CONT_LEGAL = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CONT_LEGAL
'                sCMX_ID_CONTRATO_INT = SGB_M4C_MOVS_NOM_GEN.CMX_ID_CONTRATO_INT
'                sSSP_FEC_FIN_CONTRA = SGB_M4C_MOVS_NOM_GEN.SSP_FEC_FIN_CONTRA
'                sSSP_VALOR_COEF_T_P = SGB_M4C_MOVS_NOM_GEN.SSP_VALOR_COEF_T_P
'                sSSP_TIPO_HORAS = SGB_M4C_MOVS_NOM_GEN.SSP_TIPO_HORAS
'                sSSP_NUM_HORAS = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_HORAS
'                sSSP_JP_REG_IRREG = SGB_M4C_MOVS_NOM_GEN.SSP_JP_REG_IRREG
'                sSSP_NUM_DIAS_JP = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_DIAS_JP
'                sSSP_ID_CAUSA_SUST = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CAUSA_SUST
'                sSSP_NSS_SUST_PROV = (Mid(SGB_M4C_MOVS_NOM_GEN.SSP_NUSS_SUST, 0, 2))'2
'                sSSP_NUSS_SUST = (Mid(SGB_M4C_MOVS_NOM_GEN.SSP_NUSS_SUST, 2, 8)) '8
'                sSSP_NSS_SUST_DC = (Mid(SGB_M4C_MOVS_NOM_GEN.SSP_NUSS_SUST, 10, 2)) '2
'                sSSP_CLAUSULA_ADIC = SGB_M4C_MOVS_NOM_GEN.SSP_CLAUSULA_ADIC

'                SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_PV_CON = sSSP_FEC_FIN_PV_CON
'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CONT_LEGAL = sSSP_ID_CONT_LEGAL
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_CONTRATO_INT = sCMX_ID_CONTRATO_INT
'                SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_CONTRA = sSSP_FEC_FIN_CONTRA
'                SRGB_M4C_DATOS_ENVIADOS.SSP_VALOR_COEF_T_P = sSSP_VALOR_COEF_T_P
'                SRGB_M4C_DATOS_ENVIADOS.SSP_TIPO_HORAS = sSSP_TIPO_HORAS
'                SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_HORAS = sSSP_NUM_HORAS
'                SRGB_M4C_DATOS_ENVIADOS.SSP_JP_REG_IRREG = sSSP_JP_REG_IRREG
'                SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_DIAS_JP = sSSP_NUM_DIAS_JP
'                SRG_M4C_DATOS_ENVIADOS.SSP_ID_CAUSA_SUST = sSSP_ID_CAUSA_SUST
'                SRG_M4C_DATOS_ENVIADOS.SSP_NUSS_SUST = sSSP_NSS_SUST_PROV + sSSP_NUSS_SUST + sSSP_NSS_SUST_DC
'                SRGB_M4C_DATOS_ENVIADOS.SSP_CLAUSULA_ADIC = sSSP_CLAUSULA_ADIC
'              EndIf

'              'Grupo funcional Num. Seguridad Social
'              sSSP_CON_NUM_SS = NullValue()
'              sSSP_PROV_NUM_SS = NullValue()
'              sSSP_NUM_SS = NullValue()
'              sSSP_DIG_NUM_SS = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.SSP_CON_NUM_SS <> SRGB_M4C_DATOS_ENVIADOS.SSP_CON_NUM_SS Or SGB_M4C_MOVS_NOM_GEN.CALC_PROV_NUM_SS() <> SRGB_M4C_DATOS_ENVIADOS.CALC_PROV_NUM_SS() Or SGB_M4C_MOVS_NOM_GEN.CALC_NUM_SS() <> SRGB_M4C_DATOS_ENVIADOS.CALC_NUM_SS() Or SGB_M4C_MOVS_NOM_GEN.CALC_DIG_NUM_SS() <> SRGB_M4C_DATOS_ENVIADOS.CALC_DIG_NUM_SS() Then
'                iDelta = 1
'                sSSP_CON_NUM_SS = SGB_M4C_MOVS_NOM_GEN.SSP_CON_NUM_SS
'                sSSP_PROV_NUM_SS = SGB_M4C_MOVS_NOM_GEN.CALC_PROV_NUM_SS()
'                sSSP_NUM_SS = SGB_M4C_MOVS_NOM_GEN.CALC_NUM_SS()
'                sSSP_DIG_NUM_SS = SGB_M4C_MOVS_NOM_GEN.CALC_DIG_NUM_SS()

'                SRGB_M4C_DATOS_ENVIADOS.SSP_CON_NUM_SS = sSSP_CON_NUM_SS
'                SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_SS = sSSP_PROV_NUM_SS + "-" + sSSP_NUM_SS + "-" + sSSP_DIG_NUM_SS
'              EndIf

'              'Grupo funcional Cabecera TC1
'              sSSP_ID_CABEC_TC1 = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.SSP_ID_CABEC_TC1 <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CABEC_TC1 Then
'                iDelta = 1
'                sSSP_ID_CABEC_TC1 = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CABEC_TC1

'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CABEC_TC1 = sSSP_ID_CABEC_TC1
'              EndIf

'              'Grupo funcional Grupo Tarifa
'              sSSP_ID_GRUP_TARIFA = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.SSP_ID_GRUP_TARIFA <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_GRUP_TARIFA Then
'                iDelta = 1
'                sSSP_ID_GRUP_TARIFA = SGB_M4C_MOVS_NOM_GEN.SSP_ID_GRUP_TARIFA

'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_GRUP_TARIFA = sSSP_ID_GRUP_TARIFA
'              EndIf

'              'Grupo funcional Ocupaci¿n
'              sSSP_ID_OCUPACION = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.SSP_ID_OCUPACION <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_OCUPACION Then
'                iDelta = 1
'                sSSP_ID_OCUPACION = SGB_M4C_MOVS_NOM_GEN.SSP_ID_OCUPACION

'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_OCUPACION = sSSP_ID_OCUPACION
'              EndIf

'              sSSP_ID_CONV_SS = NullValue() 'En blanco
'              sSSP_NUM_PLURIEMPL = NullValue() 'En blanco
'
'              'Grupo funcional Reducci¿n Jornada
'              sSSP_PORC_GLEGAL = NullValue() 'En blanco
'              sSSP_ID_MOTIV_REDUC = NullValue() 'En blanco

'              'Grupo funcional Tipo ajuste/salario
'              sSCO_ID_TYPE_ADJUST = NullValue()
'              sSSP_BRUTO_ANUAL = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.SSP_ID_TYPE_ADJUST <> SRGB_M4C_DATOS_ENVIADOS.SCO_ID_TYPE_ADJUST Or SGB_M4C_MOVS_NOM_GEN.SSP_BRUTO_ANUAL <> SRGB_M4C_DATOS_ENVIADOS.SSP_BRUTO_ANUAL Then
'                iDelta = 1
'                sSCO_ID_TYPE_ADJUST = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TYPE_ADJUST
'                sSSP_BRUTO_ANUAL = SGB_M4C_MOVS_NOM_GEN.SSP_BRUTO_ANUAL

'                SRGB_M4C_DATOS_ENVIADOS.SCO_ID_TYPE_ADJUST = sSCO_ID_TYPE_ADJUST
'                SRGB_M4C_DATOS_ENVIADOS.SSP_BRUTO_ANUAL = sSSP_BRUTO_ANUAL
'              EndIf

'              'Grupo funcional Convenio
'              sCMX_ID_CONVENIO = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.CMX_ID_CONVENIO <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_CONVENIO Then
'                iDelta = 1
'                sCMX_ID_CONVENIO = SGB_M4C_MOVS_NOM_GEN.CMX_ID_CONVENIO

'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_CONVENIO = sCMX_ID_CONVENIO
'              EndIf

'              'Grupo funcional Categor¿a
'              sCMX_ID_CATEGORIA = NullValue()
'              'If SGB_M4C_MOVS_NOM_GEN.CMX_ID_CATEGORIA <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_CATEGORIA Then
''             If SGB_M4C_MOVS_NOM_GEN.SSP_ID_CATEGORIA <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_CATEGORIA Then
'                iDelta = 1
'                sCMX_ID_CATEGORIA = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CATEGORIA

'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_CATEGORIA = sCMX_ID_CATEGORIA
'              EndIf

'              'Grupo funcional Tipo salario
'              sCMX_ID_TP_SALARIO = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_SALARIO <> SRGB_M4C_DATOS_ENVIADOS.CMX_ID_TP_SALARIO Then
'                iDelta = 1
'                sCMX_ID_TP_SALARIO = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_SALARIO

'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_TP_SALARIO = sCMX_ID_TP_SALARIO
'              EndIf

'              'Grupo funcional Fecha antig¿edad
'              sSSP_FEC_ANTIGUEDAD = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.SSP_FEC_ANTIGUEDAD <> SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_ANTIGUEDAD Then
'                iDelta = 1
'                sSSP_FEC_ANTIGUEDAD = SGB_M4C_MOVS_NOM_GEN.SSP_FEC_ANTIGUEDAD

'                SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_ANTIGUEDAD = sSSP_FEC_ANTIGUEDAD
'              EndIf

'              sSSP_FEC_EXTRAS = NullValue() 'En blanco
'              If SGB_M4C_MOVS_NOM_GEN.SSP_FEC_EXTRAS <> SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_EXTRAS Then
'                iDelta = 1
'                sSSP_FEC_EXTRAS = SGB_M4C_MOVS_NOM_GEN.SSP_FEC_EXTRAS

'                SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_EXTRAS = sSSP_FEC_EXTRAS
'              EndIf
'
'              'Grupo funcional Sindicato
'              sSGB_ID_SINDICATO = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.SGB_ID_SINDICATO <> SRGB_M4C_DATOS_ENVIADOS.SGB_ID_SINDICATO Then
'                iDelta = 1
'                sSGB_ID_SINDICATO = SGB_M4C_MOVS_NOM_GEN.SGB_ID_SINDICATO

'                SRGB_M4C_DATOS_ENVIADOS.SGB_ID_SINDICATO = sSGB_ID_SINDICATO
'              EndIf

'              'Grupo funcional Tipo IRPF
'              sSSP_ID_TP_IRPF = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_IRPF <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_IRPF Then
'                iDelta = 1
'                sSSP_ID_TP_IRPF = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_IRPF

'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_IRPF = sSSP_ID_TP_IRPF
'              EndIf

'              'Grupo funcional Situaci¿n IRPF
'              sSSP_ID_EST_IRPF = NullValue()
'              sSSP_ID_MINUSVALIA = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.SSP_ID_EST_IRPF <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_EST_IRPF Or SGB_M4C_MOVS_NOM_GEN.SSP_ID_MINUSVALIA <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_MINUSVALIA Then
'                iDelta = 1
'                sSSP_ID_EST_IRPF = SGB_M4C_MOVS_NOM_GEN.SSP_ID_EST_IRPF
'                sSSP_ID_MINUSVALIA = SGB_M4C_MOVS_NOM_GEN.SSP_ID_MINUSVALIA

'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_EST_IRPF = sSSP_ID_EST_IRPF
'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_MINUSVALIA = sSSP_ID_MINUSVALIA
'              EndIf
'
'              'Grupo funcional Centro f¿sico
'              sSSP_ID_CENTRO_FIS = NullValue()
'              'Se habilita en TRADES
'              If SGB_M4C_MOVS_NOM_GEN.SSP_ID_CENTRO_FISICO <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CENTRO_FISICO Then
'                iDelta = 1
'                sSSP_ID_CENTRO_FIS = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CENTRO_FISICO

'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CENTRO_FISICO = sSSP_ID_CENTRO_FIS
'              EndIf

'              'Grupo funcional Datos pago
'              sCMX_FORMA_DE_PAGO = NullValue()
'              sSCO_ID_COMP_BANK = NullValue()
'              sCOMP_BANC_SUC = NullValue()
'              sSCO_ACCOUNT_NUMBER = NullValue()
'              sSSP_DC = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.SSP_ID_PAYM_TYPE <> SRGB_M4C_DATOS_ENVIADOS.CMX_FORMA_DE_PAGO Or SGB_M4C_MOVS_NOM_GEN.SCO_ID_COMP_BANK <> SRGB_M4C_DATOS_ENVIADOS.SCO_ID_COMP_BANK Or SGB_M4C_MOVS_NOM_GEN.CALC_COMP_BANC_SUC() <> SRGB_M4C_DATOS_ENVIADOS.CALC_COMP_BANC_SUC() Or SGB_M4C_MOVS_NOM_GEN.SCO_ACCOUNT_NUMBER <> SRGB_M4C_DATOS_ENVIADOS.SCO_ACCOUNT_NUMBER Or SGB_M4C_MOVS_NOM_GEN.SSP_DC <> SRGB_M4C_DATOS_ENVIADOS.SSP_DC Then
'                iDelta = 1
'                'sCMX_FORMA_DE_PAGO = SGB_M4C_MOVS_NOM_GEN.CMX_FORMA_DE_PAGO
'                sCMX_FORMA_DE_PAGO = SGB_M4C_MOVS_NOM_GEN.SSP_ID_PAYM_TYPE 'REVISAR SSP_ID_PAYM_DATA
'                sSCO_ID_COMP_BANK = SGB_M4C_MOVS_NOM_GEN.SCO_ID_COMP_BANK
'                sCOMP_BANC_SUC = SGB_M4C_MOVS_NOM_GEN.CALC_COMP_BANC_SUC()
'                sSCO_ACCOUNT_NUMBER = SGB_M4C_MOVS_NOM_GEN.SCO_ACCOUNT_NUMBER
'                sSSP_DC = SGB_M4C_MOVS_NOM_GEN.SSP_DC

'                SRGB_M4C_DATOS_ENVIADOS.CMX_FORMA_DE_PAGO = sCMX_FORMA_DE_PAGO
'                SRGB_M4C_DATOS_ENVIADOS.SCO_ID_COMP_BANK = sSCO_ID_COMP_BANK
'                SRGB_M4C_DATOS_ENVIADOS.SCO_ID_BANK_CODE = Mid(sCOMP_BANC_SUC, 0, 4)
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_BANK_BRANCH = Mid(sCOMP_BANC_SUC, 4, 8)
'                SRGB_M4C_DATOS_ENVIADOS.SCO_ACCOUNT_NUMBER = sSCO_ACCOUNT_NUMBER
'                SRGB_M4C_DATOS_ENVIADOS.SSP_DC = sSSP_DC
'              EndIf

'              'Grupo funcional Tipo productor
'              sSSP_ID_TP_PRODUCTOR = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_PRODUCTOR <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_PRODUCTOR Then
'                iDelta = 1
'                sSSP_ID_TP_PRODUCTOR = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_PRODUCTOR

'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_PRODUCTOR = sSSP_ID_TP_PRODUCTOR
'              EndIf

'              'Grupo funcional Tipo actividad
'              sSSP_ID_TP_ACTIVIDAD = NullValue()
'              If SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_ACTIVIDAD <> SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_ACTIVIDAD Then
'                iDelta = 1
'                sSSP_ID_TP_ACTIVIDAD = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_ACTIVIDAD

'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_ACTIVIDAD = sSSP_ID_TP_ACTIVIDAD
'              EndIf

'              If iDelta = 1 Then
'                SGB_M4C_REG_COLA.AddRegister()
'                SGB_M4C_REG_COLA.ID_ARCHIVO = sIDArchivo
'                SGB_M4C_REG_COLA.CMX_TP_MOVIMIENTO = sFlagCambio
'                SGB_M4C_REG_COLA.CMX_DATE = sCMX_DATE
'                SGB_M4C_REG_COLA.FECHA_BAJA = sFECHA_BAJA
'                SGB_M4C_REG_COLA.STD_ID_HRP_END_REASON = sSTD_ID_HRP_END_REASON
'                SGB_M4C_REG_COLA.SSP_ID_CAUSA_DESEM = sSSP_ID_CAUSA_DESEM
'                SGB_M4C_REG_COLA.SSP_FEC_FIN_VACAC = sSSP_FEC_FIN_VACAC
'                SGB_M4C_REG_COLA.STD_ID_HR = sSTD_ID_HR
'                SGB_M4C_REG_COLA.SSP_PRIMER_APELLIDO = sSSP_PRIMER_APELLIDO
'                SGB_M4C_REG_COLA.STD_N_MAIDEN_NAME = sSTD_N_MAIDEN_NAME
'                SGB_M4C_REG_COLA.STD_N_FIRST_NAME = sSTD_N_FIRST_NAME
'                SGB_M4C_REG_COLA.CMX_ID_TP_DOC = sCMX_ID_TP_DOC
'                SGB_M4C_REG_COLA.SSP_NUM_DOC = sSSP_NUM_DOC
'                SGB_M4C_REG_COLA.SSP_ID_PAIS_EMISOR = sSSP_ID_PAIS_EMISOR
'                SGB_M4C_REG_COLA.CMX_DT_BIRTH = sCMX_DT_BIRTH
'                SGB_M4C_REG_COLA.CMX_ID_NACIONALITY = sCMX_ID_NACIONALITY
'                SGB_M4C_REG_COLA.CMX_ID_COUNTRY = sCMX_ID_COUNTRY
'                SGB_M4C_REG_COLA.CMX_ID_SUB_GEO_DIV_ADD = sCMX_ID_SUB_GEO_DIV_ADD
'                SGB_M4C_REG_COLA.CMX_ID_GEO_DIV_ADD = sCMX_ID_GEO_DIV_ADD
'                SGB_M4C_REG_COLA.STD_ID_GENDER = sSTD_ID_GENDER
'                SGB_M4C_REG_COLA.CMX_ID_MAR_STAT = sCMX_ID_MAR_STAT
'                SGB_M4C_REG_COLA.CMX_PHONE = sCMX_PHONE
'                SGB_M4C_REG_COLA.TEL_MOV = sTEL_MOV
'                SGB_M4C_REG_COLA.CMX_EMAIL = sCMX_EMAIL
'                SGB_M4C_REG_COLA.STD_ID_LOCATION_TYPE = sSTD_ID_LOCATION_TYPE
'                SGB_M4C_REG_COLA.CMX_ID_SIGLA_DOMIC = sCMX_ID_SIGLA_DOMIC
'                SGB_M4C_REG_COLA.CMX_ADDRESS_LINE_1 = sCMX_ADDRESS_LINE_1
'                SGB_M4C_REG_COLA.CMX_NUM_VIA = sCMX_NUM_VIA
'                SGB_M4C_REG_COLA.SSP_BLOQUE = sSSP_BLOQUE
'                SGB_M4C_REG_COLA.SSP_ESCALERA = sSSP_ESCALERA
'                SGB_M4C_REG_COLA.SSP_PISO = sSSP_PISO
'                SGB_M4C_REG_COLA.SSP_PUERTA = sSSP_PUERTA
'                SGB_M4C_REG_COLA.CMX_ID_GEO_PLACE = sCMX_ID_GEO_PLACE
'                SGB_M4C_REG_COLA.CMX_ID_SUB_GEO_DIV = sCMX_ID_SUB_GEO_DIV
'                SGB_M4C_REG_COLA.CMX_ID_GEO_DIV = sCMX_ID_GEO_DIV
'                SGB_M4C_REG_COLA.CMX_ID_COUNTRY_ADD = sCMX_ID_COUNTRY_ADD
'                SGB_M4C_REG_COLA.CMX_DISTRIT_POSTAL = sCMX_DISTRIT_POSTAL
'                SGB_M4C_REG_COLA.SCO_ID_LEG_ENT = sSCO_ID_LEG_ENT
'                SGB_M4C_REG_COLA.SCO_ID_JOB_CODE = sSCO_ID_JOB_CODE
'                SGB_M4C_REG_COLA.CMX_ID_WORK_UNIT = sCMX_ID_WORK_UNIT
'                SGB_M4C_REG_COLA.CMX_ID_WORK_LOC = sCMX_ID_WORK_LOC
'                SGB_M4C_REG_COLA.SSP_ID_CENT_COSTO = sSSP_ID_CENT_COSTO
'                SGB_M4C_REG_COLA.STD_ID_HRP_START_REASON = sSTD_ID_HRP_START_REASON
'                SGB_M4C_REG_COLA.STD_ID_HR_TYPE = sSTD_ID_HR_TYPE
'                SGB_M4C_REG_COLA.SSP_ID_TP_GESTION = sSSP_ID_TP_GESTION
'                SGB_M4C_REG_COLA.SSP_FEC_FIN_PR_PRU = sSSP_FEC_FIN_PR_PRU
'                SGB_M4C_REG_COLA.SSP_FEC_FIN_PV_CON = sSSP_FEC_FIN_PV_CON
'                SGB_M4C_REG_COLA.SCO_ID_DURATION = sSCO_ID_DURATION
'                SGB_M4C_REG_COLA.SSP_CON_NUM_SS = sSSP_CON_NUM_SS
'                SGB_M4C_REG_COLA.SSP_PROV_NUM_SS = sSSP_PROV_NUM_SS
'                SGB_M4C_REG_COLA.SSP_NUM_SS = sSSP_NUM_SS
'                SGB_M4C_REG_COLA.SSP_DIG_NUM_SS = sSSP_DIG_NUM_SS
'                SGB_M4C_REG_COLA.SSP_ID_CABEC_TC1 = sSSP_ID_CABEC_TC1
'                SGB_M4C_REG_COLA.SSP_ID_GRUP_TARIFA = sSSP_ID_GRUP_TARIFA
'                SGB_M4C_REG_COLA.SSP_ID_OCUPACION = sSSP_ID_OCUPACION
'                SGB_M4C_REG_COLA.SSP_ID_CONV_SS = sSSP_ID_CONV_SS
'                SGB_M4C_REG_COLA.SSP_NUM_PLURIEMPL = sSSP_NUM_PLURIEMPL
'                SGB_M4C_REG_COLA.SSP_ID_CONT_LEGAL = sSSP_ID_CONT_LEGAL
'                SGB_M4C_REG_COLA.CMX_ID_CONTRATO_INT = sCMX_ID_CONTRATO_INT
'                SGB_M4C_REG_COLA.SSP_FEC_FIN_CONTRA = sSSP_FEC_FIN_CONTRA
'                SGB_M4C_REG_COLA.SSP_ID_REL_LAB = sSSP_ID_REL_LAB
'                SGB_M4C_REG_COLA.SSP_VALOR_COEF_T_P = sSSP_VALOR_COEF_T_P
'                SGB_M4C_REG_COLA.SSP_TIPO_HORAS = sSSP_TIPO_HORAS
'                SGB_M4C_REG_COLA.SSP_NUM_HORAS = sSSP_NUM_HORAS
'                SGB_M4C_REG_COLA.SSP_JP_REG_IRREG = sSSP_JP_REG_IRREG
'                SGB_M4C_REG_COLA.SSP_NUM_DIAS_JP = sSSP_NUM_DIAS_JP
'                SGB_M4C_REG_COLA.SSP_PORC_GLEGAL = sSSP_PORC_GLEGAL
'                SGB_M4C_REG_COLA.SSP_ID_MOTIV_REDUC = sSSP_ID_MOTIV_REDUC
'                SGB_M4C_REG_COLA.SSP_ID_CAUSA_SUST = sSSP_ID_CAUSA_SUST
'                SGB_M4C_REG_COLA.SSP_NSS_SUST_PROV = sSSP_NSS_SUST_PROV
'                SGB_M4C_REG_COLA.SSP_NUSS_SUST = sSSP_NUSS_SUST
'                SGB_M4C_REG_COLA.SSP_NSS_SUST_DC = sSSP_NSS_SUST_DC
'                SGB_M4C_REG_COLA.SSP_PORC_MINUSVAL = sSSP_PORC_MINUSVAL
'                SGB_M4C_REG_COLA.SSP_FEC_INI_A_CONT = sSSP_FEC_INI_A_CONT
'                SGB_M4C_REG_COLA.SSP_MUJER_24 = sSSP_MUJER_24
'                SGB_M4C_REG_COLA.SSP_MUJER_SUBREPR = sSSP_MUJER_SUBREPR
'                SGB_M4C_REG_COLA.SSP_DIAS_PRUEBA = sSSP_DIAS_PRUEBA
'                SGB_M4C_REG_COLA.SSP_CLAUSULA_ADIC = sSSP_CLAUSULA_ADIC
'                SGB_M4C_REG_COLA.SCO_ID_TYPE_ADJUST = sSCO_ID_TYPE_ADJUST
'                SGB_M4C_REG_COLA.CMX_ID_CONVENIO = sCMX_ID_CONVENIO
'                SGB_M4C_REG_COLA.CMX_ID_CATEGORIA = sCMX_ID_CATEGORIA
'                SGB_M4C_REG_COLA.SSP_BRUTO_ANUAL = sSSP_BRUTO_ANUAL
'                SGB_M4C_REG_COLA.CMX_ID_TP_SALARIO = sCMX_ID_TP_SALARIO
'                SGB_M4C_REG_COLA.SSP_FEC_ANTIGUEDAD = sSSP_FEC_ANTIGUEDAD
'                SGB_M4C_REG_COLA.SSP_FEC_EXTRAS = sSSP_FEC_EXTRAS
'                SGB_M4C_REG_COLA.SGB_ID_SINDICATO = sSGB_ID_SINDICATO
'                SGB_M4C_REG_COLA.SSP_ID_TP_IRPF = sSSP_ID_TP_IRPF
'                SGB_M4C_REG_COLA.SSP_ID_EST_IRPF = sSSP_ID_EST_IRPF
'                SGB_M4C_REG_COLA.SSP_ID_MINUSVALIA = sSSP_ID_MINUSVALIA
'                SGB_M4C_REG_COLA.SSP_ID_CENTRO_FIS = sSSP_ID_CENTRO_FIS
'                SGB_M4C_REG_COLA.CMX_FORMA_DE_PAGO = sCMX_FORMA_DE_PAGO
'                SGB_M4C_REG_COLA.SCO_ID_COMP_BANK = sSCO_ID_COMP_BANK
'                SGB_M4C_REG_COLA.COMP_BANC_SUC = sCOMP_BANC_SUC
'                SGB_M4C_REG_COLA.SCO_ACCOUNT_NUMBER = sSCO_ACCOUNT_NUMBER
'                SGB_M4C_REG_COLA.SSP_DC = sSSP_DC
'                SGB_M4C_REG_COLA.SSP_ID_TP_PRODUCTOR = sSSP_ID_TP_PRODUCTOR
'                SGB_M4C_REG_COLA.SSP_ID_TP_ACTIVIDAD = sSSP_ID_TP_ACTIVIDAD'

'                If SGB_M4C_REG_COLA.Persist_tree() <> M4_ERROR Then
'                  'Deltas registrados
'                  SetLog(M4_DEBUGINFOLOG, 60, 4, 400, "Deltas registrados " + ToString(TodayNow()))

'                  SRGB_M4C_DATOS_ENVIADOS.Persist_tree()
'                  'Se realizó la actualización de los Deltas de los empleados en la tabla de Datos Enviados
'                  SetLog(M4_DEBUGINFOLOG,60,4,400,"Se realizó la actualización de los Deltas de los empleados en la tabla de Datos Enviados " + ToString(TodayNow(),0))
'                EndIf

'              EndIf

'            Else
'              'Se intent¿ realizar un cambio al Empleado: , pero no existe su registro en la tabla de Datos Eviados
'              SetLog(M4_DEBUGINFOLOG, 60, 4, 400, "'Se intento realizar un cambio al Empleado: " + sSTD_ID_HR + ", pero no existe su registro en la tabla de Datos Eviados, se enviar¿ como un cambio " + ToString(TodayNow()))
'
'              'Existen casos en donde no hay registro en Nomina Gen de un colaborador, por lo que hay que enviar los registros encontrados como un cambio.

'              sCMX_DATE = SGB_M4C_MOVS_NOM_GEN.CMX_DATE
'              sSSP_PRIMER_APELLIDO = SGB_M4C_MOVS_NOM_GEN.SSP_PRIMER_APELLIDO
'              sSTD_N_MAIDEN_NAME = SGB_M4C_MOVS_NOM_GEN.STD_N_MAIDEN_NAME
'              sSTD_N_FIRST_NAME = SGB_M4C_MOVS_NOM_GEN.STD_N_FIRST_NAME
'              sCMX_ID_TP_DOC = SGB_M4C_MOVS_NOM_GEN.CMX_ID_TP_DOC
'              sSSP_NUM_DOC = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_DOC
'              sSSP_ID_PAIS_EMISOR = SGB_M4C_MOVS_NOM_GEN.SSP_ID_PAIS_EMISOR
'              sCMX_DT_BIRTH = SGB_M4C_MOVS_NOM_GEN.CMX_DT_BIRTH
'              sCMX_ID_NACIONALITY = SGB_M4C_MOVS_NOM_GEN.CMX_ID_NACIONALITY
'              sCMX_ID_COUNTRY = SGB_M4C_MOVS_NOM_GEN.CMX_ID_COUNTRY
'              sCMX_ID_SUB_GEO_DIV_ADD = SGB_M4C_MOVS_NOM_GEN.CMX_ID_SUB_GEO_DIV_ADD
'              sSTD_ID_GENDER = SGB_M4C_MOVS_NOM_GEN.STD_ID_GENDER
'              sCMX_ID_MAR_STAT = SGB_M4C_MOVS_NOM_GEN.CMX_ID_MAR_STAT
'              sCMX_PHONE = SGB_M4C_MOVS_NOM_GEN.CMX_PHONE
'              sTEL_MOV = SGB_M4C_MOVS_NOM_GEN.CMX_PHONE
'              '  sTEL_MOV = SGB_M4C_MOVS_NOM_GEN.CMX_PHONE
'              sCMX_EMAIL = SGB_M4C_MOVS_NOM_GEN.CMX_EMAIL
'              sCMX_ID_SIGLA_DOMIC = SGB_M4C_MOVS_NOM_GEN.CMX_ID_SIGLA_DOMIC
'              sCMX_ADDRESS_LINE_1 = SGB_M4C_MOVS_NOM_GEN.CMX_ADDRESS_LINE_1
'              sCMX_NUM_VIA = SGB_M4C_MOVS_NOM_GEN.CMX_NUM_VIA
'              sSSP_BLOQUE = SGB_M4C_MOVS_NOM_GEN.SSP_BLOQUE
'              sSSP_ESCALERA = SGB_M4C_MOVS_NOM_GEN.SSP_ESCALERA
'              sSSP_PISO = SGB_M4C_MOVS_NOM_GEN.SSP_PISO
'              sSSP_PUERTA = SGB_M4C_MOVS_NOM_GEN.SSP_PUERTA
'              sCMX_ID_GEO_PLACE = SGB_M4C_MOVS_NOM_GEN.CMX_ID_GEO_PLACE
'              sCMX_ID_SUB_GEO_DIV = SGB_M4C_MOVS_NOM_GEN.CMX_ID_SUB_GEO_DIV
'              sCMX_ID_COUNTRY_ADD = SGB_M4C_MOVS_NOM_GEN.CMX_ID_COUNTRY_ADD
'              sCMX_DISTRIT_POSTAL = SGB_M4C_MOVS_NOM_GEN.CMX_DISTRIT_POSTAL
'              sSCO_ID_LEG_ENT = SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT
'              sSCO_ID_JOB_CODE = SGB_M4C_MOVS_NOM_GEN.SCO_ID_JOB_CODE
'              sCMX_ID_WORK_UNIT = SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_UNIT
'              sCMX_ID_WORK_LOC = SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC
'              sSSP_ID_CENT_COSTO = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CENT_COSTO
'              sSTD_ID_HRP_START_REASON = SGB_M4C_MOVS_NOM_GEN.STD_ID_HRP_START_REASON
'              sSTD_ID_HR_TYPE = SGB_M4C_MOVS_NOM_GEN.STD_ID_HR_TYPE
'              sSSP_ID_TP_GESTION = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_GESTION
'              sSSP_FEC_FIN_PV_CON = SGB_M4C_MOVS_NOM_GEN.SSP_FEC_FIN_PV_CON
'              sSSP_ID_CONT_LEGAL = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CONT_LEGAL
'              sCMX_ID_CONTRATO_INT = SGB_M4C_MOVS_NOM_GEN.CMX_ID_CONTRATO_INT
'              sSSP_FEC_FIN_CONTRA = SGB_M4C_MOVS_NOM_GEN.SSP_FEC_FIN_CONTRA
'              sSSP_ID_CAUSA_SUST = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CAUSA_SUST
'              sSSP_NSS_SUST_PROV = (Mid(SGB_M4C_MOVS_NOM_GEN.SSP_NUSS_SUST, 0, 2)) '2
'              sSSP_NUSS_SUST = (Mid(SGB_M4C_MOVS_NOM_GEN.SSP_NUSS_SUST, 2, 8)) '8
'              sSSP_NSS_SUST_DC = (Mid(SGB_M4C_MOVS_NOM_GEN.SSP_NUSS_SUST, 10, 2)) '2
'              sSSP_CLAUSULA_ADIC = SGB_M4C_MOVS_NOM_GEN.SSP_CLAUSULA_ADIC
'              sSSP_CON_NUM_SS = SGB_M4C_MOVS_NOM_GEN.SSP_CON_NUM_SS
'              sSSP_PROV_NUM_SS = SGB_M4C_MOVS_NOM_GEN.CALC_PROV_NUM_SS()
'              sSSP_NUM_SS = SGB_M4C_MOVS_NOM_GEN.CALC_NUM_SS()
'              sSSP_DIG_NUM_SS = SGB_M4C_MOVS_NOM_GEN.CALC_DIG_NUM_SS()
'              sSSP_ID_CABEC_TC1 = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CABEC_TC1
'              sSSP_ID_GRUP_TARIFA = SGB_M4C_MOVS_NOM_GEN.SSP_ID_GRUP_TARIFA
'              sSSP_ID_OCUPACION = SGB_M4C_MOVS_NOM_GEN.SSP_ID_OCUPACION
'              sSCO_ID_TYPE_ADJUST = SGB_M4C_MOVS_NOM_GEN.SCO_ID_TYPE_ADJUST
'              sSSP_BRUTO_ANUAL = SGB_M4C_MOVS_NOM_GEN.SSP_BRUTO_ANUAL
'              sCMX_ID_CONVENIO = SGB_M4C_MOVS_NOM_GEN.CMX_ID_CONVENIO
'              'sCMX_ID_CATEGORIA = SGB_M4C_MOVS_NOM_GEN.CMX_ID_CATEGORIA
'              sCMX_ID_CATEGORIA = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CATEGORIA
'              sCMX_ID_TP_SALARIO = SGB_M4C_MOVS_NOM_GEN.CMX_ID_TP_SALARIO
'              sSSP_FEC_ANTIGUEDAD = SGB_M4C_MOVS_NOM_GEN.SSP_FEC_ANTIGUEDAD
'              sSSP_FEC_EXTRAS = SGB_M4C_MOVS_NOM_GEN.SSP_FEC_EXTRAS
'              sSGB_ID_SINDICATO = SGB_M4C_MOVS_NOM_GEN.SGB_ID_SINDICATO
'              sSSP_ID_TP_IRPF = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_IRPF
'              sSSP_ID_EST_IRPF = SGB_M4C_MOVS_NOM_GEN.SSP_ID_EST_IRPF
'              sSSP_ID_MINUSVALIA = SGB_M4C_MOVS_NOM_GEN.SSP_ID_MINUSVALIA
'              sSSP_ID_CENTRO_FIS = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CENTRO_FISICO
'              sCMX_FORMA_DE_PAGO = SGB_M4C_MOVS_NOM_GEN.CMX_FORMA_DE_PAGO
'              sSCO_ID_COMP_BANK = SGB_M4C_MOVS_NOM_GEN.SCO_ID_COMP_BANK
'              sCOMP_BANC_SUC = SGB_M4C_MOVS_NOM_GEN.CALC_COMP_BANC_SUC()
'              sSCO_ACCOUNT_NUMBER = SGB_M4C_MOVS_NOM_GEN.SCO_ACCOUNT_NUMBER
'              sSSP_DC = SGB_M4C_MOVS_NOM_GEN.SSP_DC
'              sSSP_ID_TP_PRODUCTOR = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_PRODUCTOR
'              sSSP_ID_TP_ACTIVIDAD = SGB_M4C_MOVS_NOM_GEN.SSP_ID_TP_ACTIVIDAD

'              SGB_M4C_REG_COLA.AddRegister()
'              SGB_M4C_REG_COLA.ID_ARCHIVO = sIDArchivo
'              SGB_M4C_REG_COLA.CMX_TP_MOVIMIENTO = sFlagCambio
'              SGB_M4C_REG_COLA.CMX_DATE = sCMX_DATE
'              SGB_M4C_REG_COLA.FECHA_BAJA = sFECHA_BAJA
'              SGB_M4C_REG_COLA.STD_ID_HRP_END_REASON = sSTD_ID_HRP_END_REASON
'              SGB_M4C_REG_COLA.SSP_ID_CAUSA_DESEM = sSSP_ID_CAUSA_DESEM
'              SGB_M4C_REG_COLA.SSP_FEC_FIN_VACAC = sSSP_FEC_FIN_VACAC
'              SGB_M4C_REG_COLA.STD_ID_HR = sSTD_ID_HR
'              SGB_M4C_REG_COLA.SSP_PRIMER_APELLIDO = sSSP_PRIMER_APELLIDO
'              SGB_M4C_REG_COLA.STD_N_MAIDEN_NAME = sSTD_N_MAIDEN_NAME
'              SGB_M4C_REG_COLA.STD_N_FIRST_NAME = sSTD_N_FIRST_NAME
'              SGB_M4C_REG_COLA.CMX_ID_TP_DOC = sCMX_ID_TP_DOC
'              SGB_M4C_REG_COLA.SSP_NUM_DOC = sSSP_NUM_DOC
'              SGB_M4C_REG_COLA.SSP_ID_PAIS_EMISOR = sSSP_ID_PAIS_EMISOR
'              SGB_M4C_REG_COLA.CMX_DT_BIRTH = sCMX_DT_BIRTH
'              SGB_M4C_REG_COLA.CMX_ID_NACIONALITY = sCMX_ID_NACIONALITY
'              SGB_M4C_REG_COLA.CMX_ID_COUNTRY = sCMX_ID_COUNTRY
'              SGB_M4C_REG_COLA.CMX_ID_SUB_GEO_DIV_ADD = sCMX_ID_SUB_GEO_DIV_ADD
'              SGB_M4C_REG_COLA.CMX_ID_GEO_DIV_ADD = sCMX_ID_GEO_DIV_ADD
'              SGB_M4C_REG_COLA.STD_ID_GENDER = sSTD_ID_GENDER
'              SGB_M4C_REG_COLA.CMX_ID_MAR_STAT = sCMX_ID_MAR_STAT
'              SGB_M4C_REG_COLA.CMX_PHONE = sCMX_PHONE
'              SGB_M4C_REG_COLA.TEL_MOV = sTEL_MOV
'              SGB_M4C_REG_COLA.CMX_EMAIL = sCMX_EMAIL
'              SGB_M4C_REG_COLA.STD_ID_LOCATION_TYPE = sSTD_ID_LOCATION_TYPE
'              SGB_M4C_REG_COLA.CMX_ID_SIGLA_DOMIC = sCMX_ID_SIGLA_DOMIC
'              SGB_M4C_REG_COLA.CMX_ADDRESS_LINE_1 = sCMX_ADDRESS_LINE_1
'              SGB_M4C_REG_COLA.CMX_NUM_VIA = sCMX_NUM_VIA
'              SGB_M4C_REG_COLA.SSP_BLOQUE = sSSP_BLOQUE
'              SGB_M4C_REG_COLA.SSP_ESCALERA = sSSP_ESCALERA
'              SGB_M4C_REG_COLA.SSP_PISO = sSSP_PISO
'              SGB_M4C_REG_COLA.SSP_PUERTA = sSSP_PUERTA
'              SGB_M4C_REG_COLA.CMX_ID_GEO_PLACE = sCMX_ID_GEO_PLACE
'              SGB_M4C_REG_COLA.CMX_ID_SUB_GEO_DIV = sCMX_ID_SUB_GEO_DIV
'              SGB_M4C_REG_COLA.CMX_ID_GEO_DIV = sCMX_ID_GEO_DIV
'              SGB_M4C_REG_COLA.CMX_ID_COUNTRY_ADD = sCMX_ID_COUNTRY_ADD
'              SGB_M4C_REG_COLA.CMX_DISTRIT_POSTAL = sCMX_DISTRIT_POSTAL
'              SGB_M4C_REG_COLA.SCO_ID_LEG_ENT = sSCO_ID_LEG_ENT
'              SGB_M4C_REG_COLA.SCO_ID_JOB_CODE = sSCO_ID_JOB_CODE
'              SGB_M4C_REG_COLA.CMX_ID_WORK_UNIT = sCMX_ID_WORK_UNIT
'              SGB_M4C_REG_COLA.CMX_ID_WORK_LOC = sCMX_ID_WORK_LOC
'              SGB_M4C_REG_COLA.SSP_ID_CENT_COSTO = sSSP_ID_CENT_COSTO
'              SGB_M4C_REG_COLA.STD_ID_HRP_START_REASON = sSTD_ID_HRP_START_REASON
'              SGB_M4C_REG_COLA.STD_ID_HR_TYPE = sSTD_ID_HR_TYPE
'              SGB_M4C_REG_COLA.SSP_ID_TP_GESTION = sSSP_ID_TP_GESTION
'              SGB_M4C_REG_COLA.SSP_FEC_FIN_PR_PRU = sSSP_FEC_FIN_PR_PRU
'              SGB_M4C_REG_COLA.SSP_FEC_FIN_PV_CON = sSSP_FEC_FIN_PV_CON
'              SGB_M4C_REG_COLA.SCO_ID_DURATION = sSCO_ID_DURATION
'              SGB_M4C_REG_COLA.SSP_CON_NUM_SS = sSSP_CON_NUM_SS
'              SGB_M4C_REG_COLA.SSP_PROV_NUM_SS = sSSP_PROV_NUM_SS
'              SGB_M4C_REG_COLA.SSP_NUM_SS = sSSP_NUM_SS
'              SGB_M4C_REG_COLA.SSP_DIG_NUM_SS = sSSP_DIG_NUM_SS
'              SGB_M4C_REG_COLA.SSP_ID_CABEC_TC1 = sSSP_ID_CABEC_TC1
'              SGB_M4C_REG_COLA.SSP_ID_GRUP_TARIFA = sSSP_ID_GRUP_TARIFA
'              SGB_M4C_REG_COLA.SSP_ID_OCUPACION = sSSP_ID_OCUPACION
'              SGB_M4C_REG_COLA.SSP_ID_CONV_SS = sSSP_ID_CONV_SS
'              SGB_M4C_REG_COLA.SSP_NUM_PLURIEMPL = sSSP_NUM_PLURIEMPL
'              SGB_M4C_REG_COLA.SSP_ID_CONT_LEGAL = sSSP_ID_CONT_LEGAL
'              SGB_M4C_REG_COLA.CMX_ID_CONTRATO_INT = sCMX_ID_CONTRATO_INT
'              SGB_M4C_REG_COLA.SSP_FEC_FIN_CONTRA = sSSP_FEC_FIN_CONTRA
'              SGB_M4C_REG_COLA.SSP_ID_REL_LAB = sSSP_ID_REL_LAB
'              SGB_M4C_REG_COLA.SSP_VALOR_COEF_T_P = sSSP_VALOR_COEF_T_P
'              SGB_M4C_REG_COLA.SSP_TIPO_HORAS = sSSP_TIPO_HORAS
'              SGB_M4C_REG_COLA.SSP_NUM_HORAS = sSSP_NUM_HORAS
'              SGB_M4C_REG_COLA.SSP_JP_REG_IRREG = sSSP_JP_REG_IRREG
'              SGB_M4C_REG_COLA.SSP_NUM_DIAS_JP = sSSP_NUM_DIAS_JP
'              SGB_M4C_REG_COLA.SSP_PORC_GLEGAL = sSSP_PORC_GLEGAL
'              SGB_M4C_REG_COLA.SSP_ID_MOTIV_REDUC = sSSP_ID_MOTIV_REDUC
'              SGB_M4C_REG_COLA.SSP_ID_CAUSA_SUST = sSSP_ID_CAUSA_SUST
'              SGB_M4C_REG_COLA.SSP_NSS_SUST_PROV = sSSP_NSS_SUST_PROV
'              SGB_M4C_REG_COLA.SSP_NUSS_SUST = sSSP_NUSS_SUST
'              SGB_M4C_REG_COLA.SSP_NSS_SUST_DC = sSSP_NSS_SUST_DC
'              SGB_M4C_REG_COLA.SSP_PORC_MINUSVAL = sSSP_PORC_MINUSVAL
'              SGB_M4C_REG_COLA.SSP_FEC_INI_A_CONT = sSSP_FEC_INI_A_CONT
'              SGB_M4C_REG_COLA.SSP_MUJER_24 = sSSP_MUJER_24
'              SGB_M4C_REG_COLA.SSP_MUJER_SUBREPR = sSSP_MUJER_SUBREPR
'              SGB_M4C_REG_COLA.SSP_DIAS_PRUEBA = sSSP_DIAS_PRUEBA
'              SGB_M4C_REG_COLA.SSP_CLAUSULA_ADIC = sSSP_CLAUSULA_ADIC
'              SGB_M4C_REG_COLA.SCO_ID_TYPE_ADJUST = sSCO_ID_TYPE_ADJUST
'              SGB_M4C_REG_COLA.CMX_ID_CONVENIO = sCMX_ID_CONVENIO
'              SGB_M4C_REG_COLA.CMX_ID_CATEGORIA = sCMX_ID_CATEGORIA
'              SGB_M4C_REG_COLA.SSP_BRUTO_ANUAL = sSSP_BRUTO_ANUAL
'              SGB_M4C_REG_COLA.CMX_ID_TP_SALARIO = sCMX_ID_TP_SALARIO
'              SGB_M4C_REG_COLA.SSP_FEC_ANTIGUEDAD = sSSP_FEC_ANTIGUEDAD
'              SGB_M4C_REG_COLA.SSP_FEC_EXTRAS = sSSP_FEC_EXTRAS
'              SGB_M4C_REG_COLA.SGB_ID_SINDICATO = sSGB_ID_SINDICATO
'              SGB_M4C_REG_COLA.SSP_ID_TP_IRPF = sSSP_ID_TP_IRPF
'              SGB_M4C_REG_COLA.SSP_ID_EST_IRPF = sSSP_ID_EST_IRPF
'              SGB_M4C_REG_COLA.SSP_ID_MINUSVALIA = sSSP_ID_MINUSVALIA
'              SGB_M4C_REG_COLA.SSP_ID_CENTRO_FIS = sSSP_ID_CENTRO_FIS
'              SGB_M4C_REG_COLA.CMX_FORMA_DE_PAGO = sCMX_FORMA_DE_PAGO
'              SGB_M4C_REG_COLA.SCO_ID_COMP_BANK = sSCO_ID_COMP_BANK
'              SGB_M4C_REG_COLA.COMP_BANC_SUC = sCOMP_BANC_SUC
'              SGB_M4C_REG_COLA.SCO_ACCOUNT_NUMBER = sSCO_ACCOUNT_NUMBER
'              SGB_M4C_REG_COLA.SSP_DC = sSSP_DC
'              SGB_M4C_REG_COLA.SSP_ID_TP_PRODUCTOR = sSSP_ID_TP_PRODUCTOR
'              SGB_M4C_REG_COLA.SSP_ID_TP_ACTIVIDAD = sSSP_ID_TP_ACTIVIDAD'

'              If SGB_M4C_REG_COLA.Persist_tree() <> M4_ERROR Then
'                'Deltas registrados
'                SetLog(M4_DEBUGINFOLOG, 60, 4, 400, "Deltas registrados " + ToString(TodayNow()))
''
'                SRGB_M4C_DATOS_ENVIADOS.AddRegister()
'                SRGB_M4C_DATOS_ENVIADOS.ID_ORGANIZATION = "0005"
'                SRGB_M4C_DATOS_ENVIADOS.CMX_TP_MOVIMIENTO = sCMX_TP_MOVIMIENTO
'                SRGB_M4C_DATOS_ENVIADOS.CMX_DATE = sCMX_DATE
'                'FECHA_BAJA = sFECHA_BAJA
'                SRGB_M4C_DATOS_ENVIADOS.STD_ID_HRP_END_REASON = sSTD_ID_HRP_END_REASON
'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CAUSA_DESEM = sSSP_ID_CAUSA_DESEM
'                SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_VACAC = sSSP_FEC_FIN_VACAC
'                SRGB_M4C_DATOS_ENVIADOS.STD_ID_HR = sSTD_ID_HR 'Llave primaria
'                SRGB_M4C_DATOS_ENVIADOS.SSP_PRIMER_APELLIDO = sSSP_PRIMER_APELLIDO
'                SRGB_M4C_DATOS_ENVIADOS.STD_N_MAIDEN_NAME = sSTD_N_MAIDEN_NAME
'                SRGB_M4C_DATOS_ENVIADOS.STD_N_FIRST_NAME = sSTD_N_FIRST_NAME
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_TP_DOC = sCMX_ID_TP_DOC
'                SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_DOC = sSSP_NUM_DOC
'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_PAIS_EMISOR = sSSP_ID_PAIS_EMISOR
'                SRGB_M4C_DATOS_ENVIADOS.CMX_DT_BIRTH = sCMX_DT_BIRTH
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_NACIONALITY = sCMX_ID_NACIONALITY
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_COUNTRY = sCMX_ID_COUNTRY
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_SUB_GEO_DIV_ADD = sCMX_ID_SUB_GEO_DIV_ADD
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_GEO_DIV_ADD = sCMX_ID_GEO_DIV_ADD
'                SRGB_M4C_DATOS_ENVIADOS.STD_ID_GENDER = sSTD_ID_GENDER
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_MAR_STAT = sCMX_ID_MAR_STAT
'                SRGB_M4C_DATOS_ENVIADOS.CMX_PHONE = sCMX_PHONE
'                'TEL_MOV = sTEL_MOV
'                SRGB_M4C_DATOS_ENVIADOS.CMX_EMAIL = sCMX_EMAIL
'                SRGB_M4C_DATOS_ENVIADOS.STD_ID_LOCATION_TYPE = sSTD_ID_LOCATION_TYPE
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_SIGLA_DOMIC = sCMX_ID_SIGLA_DOMIC
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ADDRESS_LINE_1 = sCMX_ADDRESS_LINE_1
'                SRGB_M4C_DATOS_ENVIADOS.CMX_NUM_VIA = sCMX_NUM_VIA
'                SRGB_M4C_DATOS_ENVIADOS.SSP_BLOQUE = sSSP_BLOQUE
'                SRGB_M4C_DATOS_ENVIADOS.SSP_ESCALERA = sSSP_ESCALERA
'                SRGB_M4C_DATOS_ENVIADOS.SSP_PISO = sSSP_PISO
'                SRGB_M4C_DATOS_ENVIADOS.SSP_PUERTA = sSSP_PUERTA
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_GEO_PLACE = sCMX_ID_GEO_PLACE
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_SUB_GEO_DIV = sCMX_ID_SUB_GEO_DIV
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_GEO_DIV = sCMX_ID_GEO_DIV
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_COUNTRY_ADD = sCMX_ID_COUNTRY_ADD
'                SRGB_M4C_DATOS_ENVIADOS.CMX_DISTRIT_POSTAL = sCMX_DISTRIT_POSTAL
'                SRGB_M4C_DATOS_ENVIADOS.SCO_ID_LEG_ENT = sSCO_ID_LEG_ENT
'                SRGB_M4C_DATOS_ENVIADOS.SCO_ID_JOB_CODE = sSCO_ID_JOB_CODE
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_WORK_UNIT = sCMX_ID_WORK_UNIT
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_WORK_LOC = sCMX_ID_WORK_LOC
'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CENT_COSTO = sSSP_ID_CENT_COSTO
'                SRGB_M4C_DATOS_ENVIADOS.STD_ID_HRP_START_REASON = sSTD_ID_HRP_START_REASON
'                SRGB_M4C_DATOS_ENVIADOS.STD_ID_HR_TYPE = sSTD_ID_HR_TYPE
'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_GESTION = sSSP_ID_TP_GESTION
'                SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_PR_PRU = sSSP_FEC_FIN_PR_PRU
'                SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_PV_CON = sSSP_FEC_FIN_PV_CON
'                SRGB_M4C_DATOS_ENVIADOS.SCO_ID_DURATION = sSCO_ID_DURATION
'                SRGB_M4C_DATOS_ENVIADOS.SSP_CON_NUM_SS = sSSP_CON_NUM_SS
'                SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_SS = sSSP_PROV_NUM_SS + "-" + sSSP_NUM_SS + "-" + sSSP_DIG_NUM_SS
'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CABEC_TC1 = sSSP_ID_CABEC_TC1
'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_GRUP_TARIFA = sSSP_ID_GRUP_TARIFA
'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_OCUPACION = sSSP_ID_OCUPACION
'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CONV_SS = sSSP_ID_CONV_SS
'                SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_PLURIEMPL = sSSP_NUM_PLURIEMPL
'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CONT_LEGAL = sSSP_ID_CONT_LEGAL
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_CONTRATO_INT = sCMX_ID_CONTRATO_INT
'                SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_FIN_CONTRA = sSSP_FEC_FIN_CONTRA
'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_REL_LAB = sSSP_ID_REL_LAB
'                SRGB_M4C_DATOS_ENVIADOS.SSP_VALOR_COEF_T_P = sSSP_VALOR_COEF_T_P
'                SRGB_M4C_DATOS_ENVIADOS.SSP_TIPO_HORAS = sSSP_TIPO_HORAS
'                SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_HORAS = sSSP_NUM_HORAS
'                SRGB_M4C_DATOS_ENVIADOS.SSP_JP_REG_IRREG = sSSP_JP_REG_IRREG
'                SRGB_M4C_DATOS_ENVIADOS.SSP_NUM_DIAS_JP = sSSP_NUM_DIAS_JP
'                SRGB_M4C_DATOS_ENVIADOS.SSP_PORC_GLEGAL = sSSP_PORC_GLEGAL
'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_MOTIV_REDUC = sSSP_ID_MOTIV_REDUC
'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CAUSA_SUST = sSSP_ID_CAUSA_SUST
'                SRGB_M4C_DATOS_ENVIADOS.SSP_NUSS_SUST = sSSP_NSS_SUST_PROV + sSSP_NUSS_SUST + sSSP_NSS_SUST_DC
'                SRGB_M4C_DATOS_ENVIADOS.SSP_PORC_MINUSVAL = sSSP_PORC_MINUSVAL
'                SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_INI_A_CONT = sSSP_FEC_INI_A_CONT
'                SRGB_M4C_DATOS_ENVIADOS.SSP_MUJER_24 = sSSP_MUJER_24
'                SRGB_M4C_DATOS_ENVIADOS.SSP_MUJER_SUBREPR = sSSP_MUJER_SUBREPR
'                SRGB_M4C_DATOS_ENVIADOS.SSP_DIAS_PRUEBA = sSSP_DIAS_PRUEBA
'                SRGB_M4C_DATOS_ENVIADOS.SSP_CLAUSULA_ADIC = sSSP_CLAUSULA_ADIC
'                SRGB_M4C_DATOS_ENVIADOS.SCO_ID_TYPE_ADJUST = sSCO_ID_TYPE_ADJUST
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_CONVENIO = sCMX_ID_CONVENIO
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_CATEGORIA = sCMX_ID_CATEGORIA
'                SRGB_M4C_DATOS_ENVIADOS.SSP_BRUTO_ANUAL = sSSP_BRUTO_ANUAL
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_TP_SALARIO = sCMX_ID_TP_SALARIO
'                SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_ANTIGUEDAD = sSSP_FEC_ANTIGUEDAD
'                SRGB_M4C_DATOS_ENVIADOS.SSP_FEC_EXTRAS = sSSP_FEC_EXTRAS
'                SRGB_M4C_DATOS_ENVIADOS.SGB_ID_SINDICATO = sSGB_ID_SINDICATO
'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_IRPF = sSSP_ID_TP_IRPF
'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_EST_IRPF = sSSP_ID_EST_IRPF
'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_MINUSVALIA = sSSP_ID_MINUSVALIA
'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_CENTRO_FISICO = sSSP_ID_CENTRO_FIS
'                SRGB_M4C_DATOS_ENVIADOS.CMX_FORMA_DE_PAGO = sCMX_FORMA_DE_PAGO
'                SRGB_M4C_DATOS_ENVIADOS.SCO_ID_COMP_BANK = sSCO_ID_COMP_BANK
'                'COMP_BANC_SUC = sCOMP_BANC_SUC
'                SRGB_M4C_DATOS_ENVIADOS.SCO_ID_BANK_CODE = Mid(sCOMP_BANC_SUC, 0, 4)
'                SRGB_M4C_DATOS_ENVIADOS.CMX_ID_BANK_BRANCH = Mid(sCOMP_BANC_SUC, 4, 8)
'                SRGB_M4C_DATOS_ENVIADOS.SCO_ACCOUNT_NUMBER = sSCO_ACCOUNT_NUMBER
'                SRGB_M4C_DATOS_ENVIADOS.SSP_DC = sSSP_DC
'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_PRODUCTOR = sSSP_ID_TP_PRODUCTOR
'                SRGB_M4C_DATOS_ENVIADOS.SSP_ID_TP_ACTIVIDAD = sSSP_ID_TP_ACTIVIDAD

'                SRGB_M4C_DATOS_ENVIADOS.Persist_tree()

'                'Se realizó la actualización de los Deltas de los empleados en la tabla de Datos Enviados
'                SetLog(M4_DEBUGINFOLOG,60,4,400,"Se realizó la actualización de los Deltas de los empleados en la tabla de Datos Enviados " + ToString(TodayNow(),0))
'              EndIf

'            EndIf

            'Registrando deltas Infoblock.
            SetLog(M4_DEBUGINFOLOG, 60, 4, 400, "Registrando deltas Infoblock " + ToString(TodayNow()))
            SGB_M4C_REG_COLA_INF.AddRegister()
            SGB_M4C_REG_COLA_INF.ID_ARCHIVO = sIDArchivoInf
            SGB_M4C_REG_COLA_INF.USUARIO = "TB"
            SGB_M4C_REG_COLA_INF.ID = SGB_M4C_MOVS_NOM_GEN.STD_ID_HR
            SGB_M4C_REG_COLA_INF.ORGANIZATIONID = SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT
            SGB_M4C_REG_COLA_INF.PARENTID = SGB_M4C_CALC_DEPTO(SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC, dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT)
            SGB_M4C_REG_COLA_INF.NAME = SGB_M4C_MOVS_NOM_GEN.STD_N_FIRST_NAME
            SGB_M4C_REG_COLA_INF.PATERNALSURNAME = SGB_M4C_MOVS_NOM_GEN.SSP_PRIMER_APELLIDO
            SGB_M4C_REG_COLA_INF.MATERNALSURNAME = SGB_M4C_MOVS_NOM_GEN.STD_N_MAIDEN_NAME
            SGB_M4C_REG_COLA_INF.BIRTHDATE = FORMAT_YYYY_MM_DD(SGB_M4C_MOVS_NOM_GEN.CMX_DT_BIRTH)
            SGB_M4C_REG_COLA_INF.SEX = ToString((ToInt(SGB_M4C_MOVS_NOM_GEN.STD_ID_GENDER) - 1),0 ) '0 = Masculino, 1 = Femenino
            SGB_M4C_REG_COLA_INF.NIN = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_SS
            SGB_M4C_REG_COLA_INF.EMAIL = SGB_M4C_MOVS_NOM_GEN.CMX_EMAIL
            SGB_M4C_REG_COLA_INF.ORGANIZATION = SGB_M4C_CALC_EMPRESA(SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT, dFechaHoraIni)
            SGB_M4C_REG_COLA_INF.DEPARTMENT = SGB_M4C_CALC_WLOCAT(SGB_M4C_CALC_DEPTO(SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC, dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT),  dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT) 'Obtiene el nombre del WLOC pasado por par¿metro
            SGB_M4C_REG_COLA_INF.CATEGORY = SGB_M4C_CALC_CATEG(SGB_M4C_MOVS_NOM_GEN.SSP_ID_CATEGORIA)
            SGB_M4C_REG_COLA_INF.POSICION = SGB_M4C_CALC_POSICION(SGB_M4C_MOVS_NOM_GEN.STD_ID_HR, dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT)
            SGB_M4C_REG_COLA_INF.COSTCENTER = SGB_M4C_MOVS_NOM_GEN.SSP_ID_CENT_COSTO
            SGB_M4C_REG_COLA_INF.PAYROLL = "3"
            SGB_M4C_REG_COLA_INF.OTHER1 = SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC
            SGB_M4C_REG_COLA_INF.OTHER2 = SGB_M4C_CALC_WLOCAT(SGB_M4C_MOVS_NOM_GEN.CMX_ID_WORK_LOC,  dFechaHoraIni, SGB_M4C_MOVS_NOM_GEN.SCO_ID_LEG_ENT) 'Obtiene el nombre del WLOC pasado por par¿metro
            SGB_M4C_REG_COLA_INF.OTHER3 = SGB_M4C_CALC_TIPO_EMP("0005", SGB_M4C_MOVS_NOM_GEN.STD_ID_HR_TYPE)
            SGB_M4C_REG_COLA_INF.ACTIVE = "1"
            SGB_M4C_REG_COLA_INF.INTERNAL = "1"
            SGB_M4C_REG_COLA_INF.CRC = sFlagCambioInf
            SGB_M4C_REG_COLA_INF.STARTDATE = FORMAT_YYYY_MM_DD(SGB_M4C_MOVS_NOM_GEN.STD_DT_START)
            SGB_M4C_REG_COLA_INF.DATE1 = FORMAT_YYYY_MM_DD(SGB_M4C_MOVS_NOM_GEN.SSP_FEC_ANTIGUEDAD)
            SGB_M4C_REG_COLA_INF.DATE2 = NullValue()
            SGB_M4C_REG_COLA_INF.NIF = SGB_M4C_MOVS_NOM_GEN.SSP_NUM_DOC
            'SGB_M4C_REG_COLA_INF.FLAG = sFlagCambioInf

            SGB_M4C_REG_COLA_INF.Persist_tree()
            'Deltas Infoblock registrados
            SetLog(M4_DEBUGINFOLOG, 60, 4, 400, "Deltas Infoblock registrados " + ToString(TodayNow()))

        EndIf

        SGB_M4C_MOVS_NOM_GEN.SGB_PROCESADO_SAAS = "1"
      Next

      'Actualiza el estado de los registros a PROCESADO
      SGB_M4C_MOVS_NOM_GEN.Persist_tree()

      'Registrando archivo en la Bitacora
      SGB_M4C_REG_BIT_ARC(sIDArchivo, iGenerado)

      'Registrando archivo en la Bitacora
      SGB_M4C_REG_BIT_ARC(sIDArchivoInf, iGenerado)

    Else
      'No existen movimientos a procesar en el Envio
      SetLog(M4_DEBUGINFOLOG, 60, 4, 400, "No existen movimientos a procesar en el Envio " + sIDEnvio + " " + ToString(TodayNow(), 0))
    EndIf

  Else
    'No fue posible registrar el archivo " + sIDArchivo + " en el Envio " + sIDEnvio
    SetLog(M4_ERRORLOG, 60, 4, 400, "No fue posible registrar el archivo " + sIDArchivo + " en el Envio " + sIDEnvio + " " + ToString(TodayNow(), 0))
  EndIf

Else
  'No fue posible generar el registro en la tabla archivo
  SetLog(M4_ERRORLOG, 60, 4, 400, "No fue posible generar el registro en la tabla archivo " + ToString(TodayNow(), 0))
EndIf


